(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["contact-sop"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var s=a("6b75");function i(t,e){if(t){if("string"===typeof t)return Object(s["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(s["a"])(t,e):void 0}}},"0c82":function(t,e,a){},"166a":function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"f",(function(){return r})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"c",(function(){return d}));var s=a("b775");function i(t){return Object(s["b"])({url:"/contactSop/index",method:"GET",params:t})}function n(t){return Object(s["b"])({url:"/contactSop/store",method:"POST",data:t})}function r(t){return Object(s["b"])({url:"/contactSop/setEmployee",method:"PUT",data:t})}function c(t){return Object(s["b"])({url:"/contactSop/state",method:"PUT",data:t})}function o(t){return Object(s["b"])({url:"/contactSop/info",method:"GET",params:t})}function l(t){return Object(s["b"])({url:"/contactSop/destroy",method:"DELETE",data:t})}function d(t){return Object(s["b"])({url:"/contactSop/update",method:"PUT",data:t})}},2263:function(t,e,a){"use strict";a("9c58")},2589:function(t,e,a){},"2ee5":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"g",(function(){return n})),a.d(e,"e",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"a",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"c",(function(){return m})),a.d(e,"l",(function(){return f})),a.d(e,"k",(function(){return v})),a.d(e,"j",(function(){return h}));var s=a("b775");function i(t){return Object(s["b"])({url:"/channelCodeGroup/index",method:"get",params:t})}function n(t){return Object(s["b"])({url:"/channelCodeGroup/update",method:"put",data:t})}function r(t){return Object(s["b"])({url:"/channelCodeGroup/store",method:"post",data:t})}function c(t){return Object(s["b"])({url:"/channelCodeGroup/move",method:"put",data:t})}function o(t){return Object(s["b"])({url:"/channelCode/store",method:"post",data:t})}function l(t){return Object(s["b"])({url:"/channelCode/update",method:"put",data:t})}function d(t){return Object(s["b"])({url:"/channelCode/index",method:"get",params:t})}function u(t){return Object(s["b"])({url:"/channelCode/contact",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/channelCode/show",method:"get",params:t})}function f(t){return Object(s["b"])({url:"/channelCode/statisticsIndex",method:"get",params:t})}function v(t){return Object(s["b"])({url:"/channelCode/statistics",method:"get",params:t})}function h(t){return Object(s["b"])({url:"/workDepartment/index",method:"get",params:t})}},"4a04":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:636,footer:!1,centered:"",maskClosable:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 选择成员 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"left-content"},[a("div",{staticClass:"tips"},[t._v(" 没有想要添加的成员？ "),a("a",{attrs:{href:"#"}},[t._v("添加成员教程")])]),a("div",{staticClass:"search"},[a("a-input-search",{attrs:{placeholder:"请输入成员昵称"},on:{search:t.search}})],1),a("div",{staticClass:"member"},t._l(t.members,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-checkbox",{on:{change:function(a){return t.selectChange(e)}},model:{value:e.select,callback:function(a){t.$set(e,"select",a)},expression:"v.select"}})],1)])})),0)]),a("div",{staticClass:"right-content"},[a("div",{staticClass:"tips"},[t._v(" 已选成员：（"+t._s(t.selectedMembers.length)+"） ")]),a("div",{staticClass:"member"},t._l(t.selectedMembers,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])])])})),0)])]),a("div",{staticClass:"confirm"},[a("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.go}},[t._v("确定")])],1)],2)],1)},i=[],n=a("b85c"),r=(a("d3b7"),a("159b"),a("4de4"),a("a434"),a("2ee5")),c={data:function(){return{modalShow:!1,loading:!1,members:[],selectedMembers:[],currentData:{}}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.selectedMembers=[],t.forEach((function(t,a){e.selectedMembers[a]=t})),this.currentData=a,this.getData("",(function(t){e.selectedMembers.forEach((function(t){e.members.forEach((function(e){t.wxUserId===e.wxUserId&&(t.avatar||(t.avatar=e.avatar),e.select=!0)}))}))})),this.reset(),this.modalShow=!0},search:function(t){this.getData(t)},selectChange:function(t){var e=-1,a=this.selectedMembers.filter((function(a,s){if(a.id===t.id)return e=s,a}));if(a.length)return this.selectedMembers.splice(e,1),!1;this.selectedMembers.push(t)},reset:function(){var t,e=Object(n["a"])(this.members);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(s){e.e(s)}finally{e.f()}},go:function(){this.hide(),this.$emit("change",this.selectedMembers)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(r["j"])({searchKeyWords:e}).then((function(e){t.members=e.data.employee,a&&a()}))},show:function(){this.getData(),this.reset(),this.selectedMembers=[],this.modalShow=!0},hide:function(){this.modalShow=!1}}},o=c,l=(a("2263"),a("2877")),d=Object(l["a"])(o,s,i,!1,null,"24741dee",null);e["a"]=d.exports},5782:function(t,e,a){"use strict";a("f18e")},"62bf":function(t,e,a){"use strict";a("ca13")},"6b75":function(t,e,a){"use strict";function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}a.d(e,"a",(function(){return s}))},7554:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-sop-index"},[a("div",{staticClass:"mb20"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/contactSop/create")}}},[t._v("创建规则")])],1),a("a-card",{attrs:{bordered:!1}},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"members",fn:function(e){return a("div",{},t._l(e.employees,(function(e,s){return a("a-tag",{key:s},[t._v(" "+t._s(e.name)+" ")])})),1)}},{key:"switch",fn:function(e){return a("div",{},[a("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",defaultChecked:1===e.state},on:{change:function(a){return t.switchStateClick(e.id,e.state)}}})],1)}},{key:"operating",fn:function(e){return a("div",{staticClass:"btn-group"},[a("a",{on:{click:function(a){return t.showSelectMember(e)}}},[t._v(" 添加客服 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(a){return t.$router.push({path:"/contactSop/detail",query:{id:e.id}})}}},[t._v(" 详情 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popover",{attrs:{trigger:"click",placement:"bottomRight"}},[a("template",{slot:"content"},[a("div",{staticClass:"divider-btn",on:{click:function(a){return t.$router.push({path:"/contactSop/edit",query:{id:e.id}})}}},[t._v(" 修改 ")]),a("div",{staticClass:"divider-btn",on:{click:function(a){return t.delClick(e.id)}}},[t._v(" 删除 ")])]),a("a",[t._v("编辑")]),a("a-icon",{style:{color:"#1890ff"},attrs:{type:"caret-down"}})],2)],1)}}])})],1),a("selectMember",{ref:"selectMember",on:{change:t.selectMemberChange}})],1)},i=[],n=(a("d81d"),a("166a")),r=a("4a04"),c={data:function(){return{table:{col:[{dataIndex:"name",title:"规则名称"},{dataIndex:"creatorName",title:"创建人"},{scopedSlots:{customRender:"members"},title:"使用成员"},{dataIndex:"createTime",title:"创建时间"},{scopedSlots:{customRender:"switch"},title:"开关"},{title:"操作",scopedSlots:{customRender:"operating"}}],data:[]}}},mounted:function(){this.getData()},methods:{selectMemberChange:function(t,e){var a=this,s=JSON.stringify(t.map((function(t){return t.id})));Object(n["f"])({id:e.id,employees:s}).then((function(t){a.$message.success("操作成功"),a.getData()}))},showSelectMember:function(t){var e=JSON.parse(JSON.stringify(t.employees));this.$refs.selectMember.setSelect(e,{id:t.id})},delClick:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){Object(n["b"])({id:t}).then((function(t){e.$message.success("操作成功"),e.getData()}))}})},switchStateClick:function(t,e){var a=this;Object(n["g"])({id:t,state:0===e?1:0}).then((function(t){a.$message.success("操作成功"),a.getData()}))},getData:function(){var t=this;Object(n["e"])().then((function(e){t.table.data=e.data}))}},components:{selectMember:r["a"]}},o=c,l=(a("a83d"),a("2877")),d=Object(l["a"])(o,s,i,!1,null,"22f6cf9f",null);e["default"]=d.exports},"795e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-sop-create"},[a("a-card",[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("规则基本信息")]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("规则名称：")]),a("div",{staticClass:"input"},[a("a-input",{attrs:{placeholder:"请输入规则名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("客服成员：")]),a("div",{staticClass:"input"},[a("a-alert",{attrs:{type:"info",message:"以下客服成员的新客户触发了规则后，将在侧边栏快捷回复提醒该规则的内容。",banner:""}})],1)]),a("div",{staticClass:"item ml70"},[a("a-button",{staticClass:"mr10",on:{click:function(e){return t.$refs.selectMember.setSelect(t.members)}}},[t._v("选择成员")]),t._l(t.members,(function(e,s){return a("a-tag",{key:s},[t._v(" "+t._s(e.name)+" ")])}))],2)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("设置推送周期及内容")]),a("div",{staticClass:"desc-text mb16"},[t._v(" 设置规则后将会通过「MoChat提醒」提醒员工发送推送内容 ")]),a("div",{staticClass:"mb16"},[a("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.$refs.addRule.show()}}},[t._v("添加规则")])],1),a("div",{staticClass:"rules"},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"rule"},[a("div",{staticClass:"header flex"},[a("div",{staticClass:"icon"},[a("a-icon",{attrs:{type:"bell"}})],1),a("div",{staticClass:"name"},[t._v(" 客户添加企业微信客服后， "),"0"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"小时"+t._s(e.time.data.last)+"分 ")]):t._e(),"1"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"天后，当日"+t._s(e.time.data.last)+" ")]):t._e(),t._v(" 提醒发送 ")])]),a("div",{staticClass:"content flex"},[a("div",{staticClass:"warp"},[t._l(e.content,(function(e,s){return a("div",{key:s,staticClass:"text-content"},["text"===e.type?a("div",[t._v(" "+t._s(e.value)+" ")]):t._e(),"image"===e.type?a("div",[a("img",{staticStyle:{"max-width":"80px"},attrs:{src:e.value}})]):t._e()])})),a("div",{staticClass:"count"},[t._v(" 共"+t._s(e.content.length)+"条 ")])],2),a("div",{staticClass:"btn-box mr10 ml16",on:{click:function(e){return t.delContent(s)}}},[a("a-icon",{attrs:{type:"delete"}})],1),a("div",{staticClass:"btn-box",on:{click:function(a){return t.$refs.addRule.editShow(e,s)}}},[a("a-icon",{attrs:{type:"edit"}})],1)])])})),0)]),a("a-button",{attrs:{type:"primary",size:"large"},on:{click:t.confirm}},[t._v(" 保存规则 ")])],1),a("selectMember",{ref:"selectMember",on:{change:function(e){return t.members=e}}}),a("addRule",{ref:"addRule",on:{change:function(e){return t.list.push(e)},edit:t.editContentChange}})],1)},i=[],n=(a("b0c0"),a("d81d"),a("a434"),a("4a04")),r=a("bd5c"),c=a("166a"),o={data:function(){return{name:"",members:[],list:[]}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;Object(c["d"])({id:this.$route.query.id}).then((function(e){t.name=e.data.name,t.members=e.data.employees,t.list=e.data.setting}))},confirm:function(){var t=this;if(!this.name)return this.$message.error("名称未填写"),!1;if(!this.members.length)return this.$message.error("未选择成员"),!1;if(!this.list.length)return this.$message.error("未添加规则"),!1;var e=JSON.stringify(this.members.map((function(t){return t.employeeId})));Object(c["c"])({id:this.$route.query.id,name:this.name,employees:e,setting:JSON.stringify(this.list)}).then((function(e){t.$message.success("保存成功"),t.$router.push("/contactSop/index")}))},editContentChange:function(t){this.list[t.index]=t},delContent:function(t){this.list.splice(t,1)}},components:{selectMember:n["a"],addRule:r["a"]}},l=o,d=(a("5782"),a("2877")),u=Object(d["a"])(l,s,i,!1,null,"c6881d38",null);e["default"]=u.exports},"7cb5":function(t,e,a){"use strict";a("0c82")},9044:function(t,e,a){"use strict";a("2589")},"9c58":function(t,e,a){},a631:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-sop-detail"},[a("a-card",[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("规则信息")]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("规则名称：")]),a("div",{staticClass:"input"},[t._v(" "+t._s(t.data.name)+" ")])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("创建人：")]),a("div",{staticClass:"input"},[t._v(" "+t._s(t.data.creatorName)+" ")])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("创建时间：")]),a("div",{staticClass:"input"},[t._v(" "+t._s(t.data.createTime)+" ")])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("使用成员：")]),a("div",{staticClass:"input"},t._l(t.data.employees,(function(e,s){return a("a-tag",{key:s},[t._v(" "+t._s(e.name)+" ")])})),1)])]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("推送内容")]),a("div",{staticClass:"tips"},[t._v(" 共 "+t._s(t.data.setting.length)+" 条推送规则 ")]),a("div",{staticClass:"rules"},t._l(t.data.setting,(function(e,s){return a("div",{key:s,staticClass:"rule"},[a("div",{staticClass:"header flex"},[a("div",{staticClass:"icon"},[a("a-icon",{attrs:{type:"bell"}})],1),a("div",{staticClass:"name"},[t._v(" 客户添加企业微信客服后， "),"0"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"小时"+t._s(e.time.data.last)+"分 ")]):t._e(),"1"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"天后，当日"+t._s(e.time.data.last)+" ")]):t._e(),t._v(" 提醒发送 ")])]),a("div",{staticClass:"content flex"},[a("div",{staticClass:"warp"},[t._l(e.content,(function(e,s){return a("div",{key:s,staticClass:"text-content"},["text"===e.type?a("div",[t._v(" "+t._s(e.value)+" ")]):t._e(),"image"===e.type?a("div",[a("img",{staticStyle:{"max-width":"80px"},attrs:{src:e.value}})]):t._e()])})),a("div",{staticClass:"count"},[t._v(" 共"+t._s(e.content.length)+"条 ")])],2)])])})),0)])]),a("selectMember",{ref:"selectMember"}),a("addRule",{ref:"addRule"})],1)},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:636,footer:!1,centered:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 选择成员 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"left-content"},[a("div",{staticClass:"tips"},[t._v(" 没有想要添加的成员？ "),a("a",{attrs:{href:"#"}},[t._v("添加成员教程")])]),a("div",{staticClass:"search"},[a("a-input-search",{attrs:{placeholder:"请输入成员昵称"}})],1),a("div",{staticClass:"member"},t._l(t.members,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-checkbox")],1)])})),0)]),a("div",{staticClass:"right-content"},[a("div",{staticClass:"tips"},[t._v(" 已选成员：（"+t._s(t.selectedMembers.length)+"） ")]),a("div",{staticClass:"member"},t._l(t.selectedMembers,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-icon",{attrs:{type:"close"}})],1)])})),0)])]),a("div",{staticClass:"confirm"},[a("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"}},[t._v("确定")])],1)],2)],1)},r=[],c={data:function(){return{modalShow:!1,loading:!1,members:[{avatar:"https://wework.qpic.cn/bizmail/0SuDe7Ag98Px6NFH3WNbLlNslvV0EuJP5PNJsE2lkBmaOrcnRGzfoQ/60",name:"中锐科技1"},{avatar:"https://wework.qpic.cn/bizmail/0SuDe7Ag98Px6NFH3WNbLlNslvV0EuJP5PNJsE2lkBmaOrcnRGzfoQ/60",name:"中锐科技2"}],selectedMembers:[]}},methods:{show:function(){this.modalShow=!0},hide:function(){this.modalShow=!1}}},o=c,l=(a("62bf"),a("2877")),d=Object(l["a"])(o,n,r,!1,null,"14274702",null),u=d.exports,m=a("bd5c"),f=a("166a"),v={data:function(){return{data:{}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;Object(f["d"])({id:this.$route.query.id}).then((function(e){t.data=e.data}))}},components:{selectMember:u,addRule:m["a"]}},h=v,b=(a("7cb5"),Object(l["a"])(h,s,i,!1,null,"38d61e14",null));e["default"]=b.exports},a7ba:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-sop-create"},[a("a-card",[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("规则基本信息")]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("规则名称：")]),a("div",{staticClass:"input"},[a("a-input",{attrs:{placeholder:"请输入规则名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)]),a("div",{staticClass:"item"},[a("span",{staticClass:"label required"},[t._v("客服成员：")]),a("div",{staticClass:"input"},[a("a-alert",{attrs:{type:"info",message:"以下客服成员的新客户触发了规则后，将在侧边栏快捷回复提醒该规则的内容。",banner:""}})],1)]),a("div",{staticClass:"item ml70"},[a("a-button",{staticClass:"mr10",on:{click:function(e){return t.$refs.selectMember.setSelect(t.members)}}},[t._v("选择成员")]),t._l(t.members,(function(e,s){return a("a-tag",{key:s},[t._v(" "+t._s(e.name)+" ")])}))],2)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("设置推送周期及内容")]),a("div",{staticClass:"desc-text mb16"},[t._v(" 设置规则后将会通过「MoChat提醒」提醒员工发送推送内容 ")]),a("div",{staticClass:"mb16"},[a("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(e){return t.$refs.addRule.show()}}},[t._v("添加规则")])],1),a("div",{staticClass:"rules"},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"rule"},[a("div",{staticClass:"header flex"},[a("div",{staticClass:"icon"},[a("a-icon",{attrs:{type:"bell"}})],1),a("div",{staticClass:"name"},[t._v(" 客户添加企业微信客服后， "),"0"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"小时"+t._s(e.time.data.last)+"分 ")]):t._e(),"1"===e.time.type?a("span",[t._v(" "+t._s(e.time.data.first)+"天后，当日"+t._s(e.time.data.last)+" ")]):t._e(),t._v(" 提醒发送 ")])]),a("div",{staticClass:"content flex"},[a("div",{staticClass:"warp"},[t._l(e.content,(function(e,s){return a("div",{key:s,staticClass:"text-content"},["text"===e.type?a("div",[t._v(" "+t._s(e.value)+" ")]):t._e(),"image"===e.type?a("div",[a("img",{staticStyle:{"max-width":"80px"},attrs:{src:e.value}})]):t._e()])})),a("div",{staticClass:"count"},[t._v(" 共"+t._s(e.content.length)+"条 ")])],2),a("div",{staticClass:"btn-box mr10 ml16",on:{click:function(e){return t.delContent(s)}}},[a("a-icon",{attrs:{type:"delete"}})],1),a("div",{staticClass:"btn-box",on:{click:function(a){return t.$refs.addRule.editShow(e,s)}}},[a("a-icon",{attrs:{type:"edit"}})],1)])])})),0)]),a("a-button",{attrs:{type:"primary",size:"large"},on:{click:t.addClick}},[t._v(" 创建规则 ")])],1),a("selectMember",{ref:"selectMember",on:{change:function(e){return t.members=e}}}),a("addRule",{ref:"addRule",on:{change:function(e){return t.list.push(e)},edit:t.editContentChange}})],1)},i=[],n=(a("b0c0"),a("d81d"),a("a434"),a("4a04")),r=a("bd5c"),c=a("166a"),o={data:function(){return{name:"",members:[],list:[]}},methods:{addClick:function(){var t=this;if(!this.name)return this.$message.error("名称未填写"),!1;if(!this.members.length)return this.$message.error("未选择成员"),!1;if(!this.list.length)return this.$message.error("未添加规则"),!1;var e=JSON.stringify(this.members.map((function(t){return t.id})));Object(c["a"])({name:this.name,employees:e,setting:JSON.stringify(this.list)}).then((function(e){t.$message.success("创建成功"),t.$router.push("/contactSop/index")}))},editContentChange:function(t){this.list[t.index]=t},delContent:function(t){this.list.splice(t,1)}},components:{selectMember:n["a"],addRule:r["a"]}},l=o,d=(a("9044"),a("2877")),u=Object(d["a"])(l,s,i,!1,null,"a7caac18",null);e["default"]=u.exports},a83d:function(t,e,a){"use strict";a("b92e")},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var s=a("06c5");function i(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(s["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return c=t.done,t},e:function(t){o=!0,r=t},f:function(){try{c||null==a["return"]||a["return"]()}finally{if(o)throw r}}}}},b92e:function(t,e,a){},bd5c:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:767,footer:!1,centered:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 设置推送内容 ")]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[a("span",{staticClass:"bar"}),t._v(" 设置内容名称 ")]),a("div",{staticClass:"block-content"},[a("a-input",{attrs:{placeholder:"设置内容名称，仅内部可见"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[a("span",{staticClass:"bar"}),t._v(" 设置发送时间 ")]),a("div",{staticClass:"block-content"},[a("a-alert",{attrs:{type:"info",message:"当客户添加客服成员时，系统将在侧边栏快捷回复中智能提醒该规则内容",banner:""}}),a("div",{staticClass:"radio flex mb16 mt16"},[a("a-radio",{attrs:{value:"0",checked:"0"===t.sendTimeCurrent},on:{change:t.sendTimeChange}}),t._v(" 客户添加企业客服后 "),a("div",{staticClass:"input-number"},[a("a-input-number",{attrs:{size:"small",min:0,max:100},model:{value:t.form.hour.first,callback:function(e){t.$set(t.form.hour,"first",e)},expression:"form.hour.first"}})],1),t._v(" 小时 "),a("div",{staticClass:"input-number"},[a("a-input-number",{attrs:{size:"small",min:0,max:100},model:{value:t.form.hour.last,callback:function(e){t.$set(t.form.hour,"last",e)},expression:"form.hour.last"}})],1),t._v(" 分钟后提醒发送 ")],1),a("div",{staticClass:"radio flex"},[a("a-radio",{attrs:{value:"1",checked:"1"===t.sendTimeCurrent},on:{change:t.sendTimeChange}}),t._v(" 客户添加企业客服后 "),a("div",{staticClass:"input"},[a("a-input-number",{attrs:{size:"small",min:0,max:100},model:{value:t.form.day.first,callback:function(e){t.$set(t.form.day,"first",e)},expression:"form.day.first"}})],1),t._v(" 天后，当日 "),a("div",{staticClass:"input"},[a("a-time-picker",{staticStyle:{width:"115px"},attrs:{format:"HH:mm",valueFormat:"HH:mm"},model:{value:t.form.day.last,callback:function(e){t.$set(t.form.day,"last",e)},expression:"form.day.last"}})],1),t._v(" 提醒发送 ")],1)],1)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[a("span",{staticClass:"bar"}),t._v(" 设置发送内容 ")]),a("div",{staticClass:"block-content"},t._l(t.list,(function(e,s){return a("div",{key:s,staticClass:"content-item"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"select"},[t._v(" 消息"+t._s(s+1)+"： "),a("a-radio-group",{attrs:{options:t.contentRadio.list},on:{change:function(t){e.value=""}},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"v.type"}})],1),a("div",{staticClass:"del"},[a("a",{on:{click:function(e){return t.delContent(s)}}},[t._v("删除")])])]),a("div",{staticClass:"input ml50"},["text"===e.type?a("div",{staticClass:"content mt16"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"v.value"}],attrs:{placeholder:"请输入文字"},domProps:{value:e.value},on:{input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}})]):t._e(),"image"===e.type?a("div",{staticClass:"content-img mt16"},[a("m-upload",{ref:"uploadImg"+s,refInFor:!0,attrs:{def:!1,text:"请上传图片"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"v.value"}})],1):t._e()])])})),0),a("a-button",{staticClass:"ml65 mt16",attrs:{type:"primary",ghost:""},on:{click:t.addContent}},[t._v(" 添加发送内容 ")])],1),a("div",{staticClass:"footer"},[a("a-button",{staticClass:"mr16",on:{click:function(e){return t.hide()}}},[t._v(" 取消 ")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.confirm}},[t._v(" 确定 ")])],1)],2)],1)},i=[],n=a("5530"),r=a("b85c"),c=(a("b0c0"),a("a434"),a("d3b7"),a("159b"),a("c1df"),{data:function(){return{modalShow:!1,loading:!1,sendTimeCurrent:"0",contentRadio:{value:"text",list:[{label:"文字",value:"text"},{label:"图片",value:"image"}]},list:[{type:"text",value:""}],form:{name:"",hour:{first:0,last:0},day:{first:0,last:""}},type:"add",editIndex:""}},methods:{confirm:function(){var t=JSON.parse(JSON.stringify(this.form));if(!t.name)return this.$message.error("名称未填写"),!1;if("0"===this.sendTimeCurrent&&0==t.hour.first&&0==t.hour.last)return this.$message.error("提醒时间不能同时为0"),!1;if("1"===this.sendTimeCurrent&&(t.day.first<0||!t.day.last))return this.$message.error("提醒发送时间未填写"),!1;var e,a=Object(r["a"])(this.list);try{for(a.s();!(e=a.n()).done;){var s=e.value;if(!s.value)return this.$message.error("发送内容为空"),!1}}catch(c){a.e(c)}finally{a.f()}var i={name:t.name,time:{type:this.sendTimeCurrent,data:{}},content:this.list};"0"===this.sendTimeCurrent?i.time.data=t.hour:i.time.data=t.day,"add"===this.type?this.$emit("change",i):this.$emit("edit",Object(n["a"])(Object(n["a"])({},i),{},{index:this.editIndex})),this.hide()},delContent:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){if(1===e.list.length)return e.$message.error("不能删除最后一个"),!1;e.list.splice(t,1)}})},addContent:function(){this.list.push({type:"text",value:""})},sendTimeChange:function(t){this.sendTimeCurrent=t.target.value},editShow:function(t,e){var a=this;this.type="edit",this.editIndex=e,this.modalShow=!0,this.sendTimeCurrent=t.time.type,"0"===t.time.type?this.form.hour=t.time.data:this.form.day=t.time.data,this.form.name=t.name,this.list=t.content,setTimeout((function(){a.list.forEach((function(t,e){"image"==t.type&&a.$refs["uploadImg".concat(e)][0].setUrl(t.value)}))}),200)},show:function(){this.type="add",this.modalShow=!0},hide:function(){this.modalShow=!1,this.form={name:"",hour:{first:"",last:""},day:{first:"",last:""}},this.list=[{type:"text",value:""}],this.sendTimeCurrent="0"}}}),o=c,l=(a("dd7a"),a("2877")),d=Object(l["a"])(o,s,i,!1,null,"72037ff2",null);e["a"]=d.exports},ca13:function(t,e,a){},cc8d:function(t,e,a){},dd7a:function(t,e,a){"use strict";a("cc8d")},f18e:function(t,e,a){}}]);