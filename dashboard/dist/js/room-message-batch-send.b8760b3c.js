(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room-message-batch-send"],{"0015":function(t,e,a){"use strict";a("4695")},"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var n=a("6b75");function i(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},2263:function(t,e,a){"use strict";a("9c58")},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var n=a("6b75");function i(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=a("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return i(t)||r(t)||Object(o["a"])(t)||s()}},"2ee5":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"g",(function(){return r})),a.d(e,"e",(function(){return o})),a.d(e,"f",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"c",(function(){return m})),a.d(e,"l",(function(){return p})),a.d(e,"k",(function(){return f})),a.d(e,"j",(function(){return h}));var n=a("b775");function i(t){return Object(n["b"])({url:"/channelCodeGroup/index",method:"get",params:t})}function r(t){return Object(n["b"])({url:"/channelCodeGroup/update",method:"put",data:t})}function o(t){return Object(n["b"])({url:"/channelCodeGroup/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/channelCodeGroup/move",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/channelCode/store",method:"post",data:t})}function l(t){return Object(n["b"])({url:"/channelCode/update",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/channelCode/index",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/channelCode/contact",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/channelCode/show",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/channelCode/statisticsIndex",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/channelCode/statistics",method:"get",params:t})}function h(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}},3096:function(t,e,a){},"38b7":function(t,e,a){"use strict";a.d(e,"h",(function(){return i})),a.d(e,"g",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"j",(function(){return c})),a.d(e,"e",(function(){return l})),a.d(e,"i",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"f",(function(){return m})),a.d(e,"d",(function(){return p}));var n=a("b775");function i(t){return Object(n["b"])({url:"/medium/index",method:"get",params:t})}function r(t){return Object(n["b"])({url:"/medium/show",method:"get",params:t})}function o(t){return Object(n["b"])({url:"/medium/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/medium/destroy",method:"delete",data:t})}function c(t){return Object(n["b"])({url:"/medium/groupUpdate",method:"put",data:t})}function l(t){return Object(n["b"])({url:"/medium/update",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/mediumGroup/index",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/mediumGroup/store",method:"post",data:t})}function m(t){return Object(n["b"])({url:"/mediumGroup/update",method:"put",data:t})}function p(t){return Object(n["b"])({url:"/mediumGroup/destroy",method:"delete",data:t})}},"3ee7":function(t,e,a){},4695:function(t,e,a){},4873:function(t,e,a){},"4a04":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:636,footer:!1,centered:"",maskClosable:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 选择成员 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"left-content"},[a("div",{staticClass:"tips"},[t._v(" 没有想要添加的成员？ "),a("a",{attrs:{href:"#"}},[t._v("添加成员教程")])]),a("div",{staticClass:"search"},[a("a-input-search",{attrs:{placeholder:"请输入成员昵称"},on:{search:t.search}})],1),a("div",{staticClass:"member"},t._l(t.members,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-checkbox",{on:{change:function(a){return t.selectChange(e)}},model:{value:e.select,callback:function(a){t.$set(e,"select",a)},expression:"v.select"}})],1)])})),0)]),a("div",{staticClass:"right-content"},[a("div",{staticClass:"tips"},[t._v(" 已选成员：（"+t._s(t.selectedMembers.length)+"） ")]),a("div",{staticClass:"member"},t._l(t.selectedMembers,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])])])})),0)])]),a("div",{staticClass:"confirm"},[a("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.go}},[t._v("确定")])],1)],2)],1)},i=[],r=a("b85c"),o=(a("d3b7"),a("159b"),a("4de4"),a("a434"),a("2ee5")),s={data:function(){return{modalShow:!1,loading:!1,members:[],selectedMembers:[],currentData:{}}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.selectedMembers=[],t.forEach((function(t,a){e.selectedMembers[a]=t})),this.currentData=a,this.getData("",(function(t){e.selectedMembers.forEach((function(t){e.members.forEach((function(e){t.wxUserId===e.wxUserId&&(t.avatar||(t.avatar=e.avatar),e.select=!0)}))}))})),this.reset(),this.modalShow=!0},search:function(t){this.getData(t)},selectChange:function(t){var e=-1,a=this.selectedMembers.filter((function(a,n){if(a.id===t.id)return e=n,a}));if(a.length)return this.selectedMembers.splice(e,1),!1;this.selectedMembers.push(t)},reset:function(){var t,e=Object(r["a"])(this.members);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(n){e.e(n)}finally{e.f()}},go:function(){this.hide(),this.$emit("change",this.selectedMembers)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(o["j"])({searchKeyWords:e}).then((function(e){t.members=e.data.employee,a&&a()}))},show:function(){this.getData(),this.reset(),this.selectedMembers=[],this.modalShow=!0},hide:function(){this.modalShow=!1}}},c=s,l=(a("2263"),a("2877")),d=Object(l["a"])(c,n,i,!1,null,"24741dee",null);e["a"]=d.exports},"4b37":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"bg-white-module"},[n("div",{staticStyle:{display:"flex"}},[n("div",{staticStyle:{"min-width":"600px"}},[n("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[n("div",{staticClass:"title"},[e._v("基础信息")]),n("a-form-model-item",{ref:"batchTitle",attrs:{label:"群发名称",prop:"batchTitle"}},[n("a-input",{attrs:{placeholder:"群发名称仅内部可见"},model:{value:e.form.batchTitle,callback:function(t){e.$set(e.form,"batchTitle",t)},expression:"form.batchTitle"}})],1),n("a-form-model-item",{attrs:{label:"选择群主"}},[n("a-button",{on:{click:function(t){return e.$refs.selectMember.setSelect(e.employees)}}},[e._v("+点击选择")]),n("div",{staticClass:"tag"},e._l(e.employees,(function(t,a){return n("a-tag",{key:a},[e._v(" "+e._s(t.name)+" ")])})),1)],1),n("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[n("div",{staticClass:"hint"},[e._v(" 提示，群主收到群发任务后，可在企业微信上选择群聊发送拳法消息， "),n("span")])]),n("div",{staticClass:"title"},[e._v("编辑群发消息")]),n("a-form-model-item",{ref:"textContent",attrs:{label:"群发消息1:",prop:"textContent"}},[n("a-row",{staticClass:"msg_module"},[n("a-input",{staticClass:"form_textarea",attrs:{autoSize:{minRows:6},maxLength:400,type:"textarea",placeholder:"请输入回复内容"},model:{value:e.form.textContent,callback:function(t){e.$set(e.form,"textContent",t)},expression:"form.textContent"}}),n("div",{staticClass:"text_num"},[e._v(e._s(e.form.textContent.length)+"/400")])],1)],1),n("a-form-model-item",{ref:"name6",attrs:{label:"群发消息2:"}},[n("a-row",{staticClass:"msg_module"},[n("a-row",[e._v(" 选择消息类型 "),n("a-radio-group",{staticClass:"msg_type",on:{change:e.switchRadio},model:{value:e.msgType,callback:function(t){e.msgType=t},expression:"msgType"}},[n("a-radio",{attrs:{value:"1"}},[e._v("图片")]),n("a-radio",{attrs:{value:"2"}},[e._v("链接")]),n("a-radio",{attrs:{value:"3"}},[e._v("小程序")])],1)],1),n("a-row",{directives:[{name:"show",rawName:"v-show",value:1==e.msgType,expression:"msgType == 1"}],staticStyle:{"min-width":"650px"}},[n("upload",{ref:"overImg",attrs:{"file-type":1},on:{success:e.uploadImageSuccess},model:{value:e.form.content.image.pic_url,callback:function(t){e.$set(e.form.content.image,"pic_url",t)},expression:"form.content.image.pic_url"}})],1),n("a-row",{directives:[{name:"show",rawName:"v-show",value:2==e.msgType,expression:"msgType == 2"}],staticStyle:{"min-width":"650px"}},[n("a-form-model-item",{attrs:{required:"","label-col":e.childLabelCol,"wrapper-col":e.wrapperCol,label:"链接地址"}},[n("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入链接地址"},model:{value:e.form.content.link.url,callback:function(t){e.$set(e.form.content.link,"url",t)},expression:"form.content.link.url"}})],1),n("a-form-model-item",{attrs:{"label-col":e.childLabelCol,"wrapper-col":e.wrapperCol,label:"链接标题"}},[n("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标题"},model:{value:e.form.content.link.title,callback:function(t){e.$set(e.form.content.link,"title",t)},expression:"form.content.link.title"}})],1),n("a-form-model-item",{attrs:{"label-col":e.childLabelCol,"wrapper-col":e.wrapperCol,label:"链接摘要"}},[n("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入链接摘要"},model:{value:e.form.content.link.desc,callback:function(t){e.$set(e.form.content.link,"desc",t)},expression:"form.content.link.desc"}})],1),n("a-form-model-item",{attrs:{"label-col":e.childLabelCol,"wrapper-col":e.wrapperCol,label:"链接封面"}},[n("upload",{ref:"linkOver",attrs:{"file-type":1},on:{success:e.uploadLinkSuccess},model:{value:e.form.content.link.picture,callback:function(t){e.$set(e.form.content.link,"picture",t)},expression:"form.content.link.picture"}})],1)],1),n("a-row",{directives:[{name:"show",rawName:"v-show",value:3==e.msgType,expression:"msgType == 3"}],staticStyle:{"min-width":"650px"}},[n("a-form-model-item",{attrs:{label:"导入数据"}},[n("a-button",{on:{click:function(t){return e.importMedium("小程序")}}},[e._v("+导入数据")])],1),n("a-form-model-item",{attrs:{required:"",label:"图片封面","label-col":e.childLabelCol,"wrapper-col":e.wrapperCol}},[n("upload",{ref:"appletImg",attrs:{"file-type":1},on:{success:e.uploadMiniprogramSuccess},model:{value:e.form.content.miniprogram.pic_media_id,callback:function(t){e.$set(e.form.content.miniprogram,"pic_media_id",t)},expression:"form.content.miniprogram.pic_media_id"}})],1),n("a-form-model-item",{attrs:{required:"",label:"填写标题","label-col":e.childLabelCol,"wrapper-col":e.wrapperCol}},[n("a-input",{staticStyle:{width:"380px"},attrs:{placeholder:"请填写小程序标题(4-12个字符)",maxLength:12},model:{value:e.form.content.miniprogram.title,callback:function(t){e.$set(e.form.content.miniprogram,"title",t)},expression:"form.content.miniprogram.title"}})],1),n("a-form-model-item",{attrs:{required:"",label:"AppID","label-col":e.childLabelCol,"wrapper-col":e.wrapperCol}},[n("a-input",{staticStyle:{width:"380px"},attrs:{placeholder:"请填写小程序AppID,必须是关联到企业的小程序应用"},model:{value:e.form.content.miniprogram.appid,callback:function(t){e.$set(e.form.content.miniprogram,"appid",t)},expression:"form.content.miniprogram.appid"}})],1),n("a-form-model-item",{attrs:{required:"",label:"page路径","label-col":e.childLabelCol,"wrapper-col":e.wrapperCol}},[n("a-input",{staticStyle:{width:"380px"},attrs:{placeholder:"请填写小程序路径，例如：pages/index"},model:{value:e.form.content.miniprogram.page,callback:function(t){e.$set(e.form.content.miniprogram,"page",t)},expression:"form.content.miniprogram.page"}})],1)],1)],1)],1),n("a-form-model-item",{ref:"sendWay",attrs:{label:"群发时间"}},[n("a-row",[n("a-radio-group",{model:{value:e.form.sendWay,callback:function(t){e.$set(e.form,"sendWay",t)},expression:"form.sendWay"}},[n("a-radio",{attrs:{value:"1"}},[e._v("立即发送")]),n("a-radio",{attrs:{value:"2"}},[e._v("定时发送")])],1)],1),2==e.form.sendWay?n("a-row",[n("a-date-picker",{attrs:{"show-time":"",placeholder:"请选择时间"},on:{change:e.selectTime}})],1):e._e()],1),n("a-form-model-item",{attrs:{"wrapper-col":{span:24,offset:4}}},[n("div",{staticClass:"hint hint1"},[e._v(" 注意，每个群聊每个自然月最多接受来自同一企业管理员的4条群发消息。4条消息可在同一天发送 ")])]),n("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:3}}},[n("a-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.btnLoading},on:{click:e.onSubmit}},[e._v("通知成员立即发送 ")])],1)],1)],1),n("div",{staticStyle:{"margin-left":"30px","margin-top":"180px"}},[n("m-preview",{ref:"preview"})],1)]),n("div",{ref:"pbox",staticClass:"pbox"},[n("a-modal",{attrs:{width:"800px",title:"选择素材",getContainer:function(){return e.$refs.pbox},visible:e.importModal},on:{cancel:function(){t.importModal=!1}}},[n("a-row",[n("a-col",{attrs:{lg:8}},[n("a-select",{staticStyle:{width:"100%"},on:{change:e.changeGroup},model:{value:e.mediumGroupId,callback:function(t){e.mediumGroupId=t},expression:"mediumGroupId"}},e._l(e.mediumGroupList,(function(t){return n("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1),n("a-col",{attrs:{lg:8,offset:1}},[n("a-input-search",{attrs:{placeholder:"输入要搜索的内容","enter-button":"搜索"},on:{search:e.getMaterialLibrary},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),n("a-col",{attrs:{lg:3}},[n("a-button",{on:{click:function(t){e.searchValue=""}}},[e._v("清空")])],1)],1),n("div",{staticClass:"picture-box"},[0===e.materialData.length?n("div",{staticClass:"nothing"},[e._v("暂无数据")]):e._l(e.materialData,(function(t){return n("div",{key:t.id,class:e.mediumId===t.id?"active":null,on:{click:function(a){return e.mediumImport(t.id,t.content)}}},[n("img",{attrs:{src:t.content.imageFullPath,alt:""}}),n("span",[e._v(e._s(t.content.title))])])}))],2),n("template",{slot:"footer"},[n("a-button",{on:{click:e.resetImport}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.importDefined}},[e._v("确定")])],1)],2)],1),n("selectMember",{ref:"selectMember",on:{change:function(t){return e.employees=t}}})],1)},i=[],r=(a("9911"),a("d81d"),a("a15b"),a("d3b7"),a("159b"),a("c297")),o=a("ff04"),s=a("90ce"),c=a("38b7"),l=a("4a04"),d={components:{department:r["a"],upload:o["a"],selectMember:l["a"]},data:function(){return{labelCol:{span:3},childLabelCol:{span:3},wrapperCol:{span:20},choosePeopleShow:!1,employeeIdList:"",employees:[],employeeNum:0,selectList:[],form:{batchTitle:"",employeeIds:"",textContent:"",definiteTime:"",sendWay:"1",content:{textContent:"",link:{url:"",title:"",desc:"",picture:""},image:{media_id:"",pic_url:""},miniprogram:{title:"",pic_media_id:"",appid:"",page:""}}},rules:{batchTitle:[{required:!0,message:"请输入群发名称",trigger:"blur"}],textContent:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},btnLoading:!1,msgType:"1",isImport:0,mediumId:0,mediumTitle:"",importModal:!1,mediumGroupList:[],materialData:[],mediumGroupId:"",searchValue:""}},mounted:function(){},created:function(){},watch:{"form.textContent":function(){this.$refs.preview.setText(this.form.textContent),this.form.textContent.length>400&&(this.$message.warning("最多输入400个字"),this.form.textContent=this.form.textContent.substring(0,1500))},"form.content.link":{deep:!0,handler:function(){var t=this,e=this.form.content.link;this.$nextTick((function(){t.$refs.preview.setLink(e.title,e.desc,e.pictureImg)}))}},"form.content.miniprogram":{deep:!0,handler:function(){var t=this,e=this.form.content.miniprogram;this.$nextTick((function(){t.$refs.preview.setApplets(e.title,e.pic_media_idImg)}))}}},methods:{switchRadio:function(){if(1==this.msgType)this.$refs.preview.setImage(this.form.content.image.pic_urlImg),this.$refs.preview.setLink(),this.$refs.preview.setApplets();else if(2==this.msgType){this.$refs.preview.setImage();var t=this.form.content.link;this.$refs.preview.setLink(t.title,t.desc,t.pictureImg),this.$refs.preview.setApplets()}else if(3==this.msgType){this.$refs.preview.setImage(),this.$refs.preview.setLink();var e=this.form.content.miniprogram;this.$refs.preview.setApplets(e.title,e.pic_media_idImg)}},peopleChange:function(t){var e=[];t.map((function(t){e.push(t.employeeId)})),this.employeeNum=e.length,this.employeeIdList=e.join(",")},searchEmp:function(t){this.employeeNum=t.length,0===t.length?this.employeeIdList="空":this.employeeIdList=t[0].id},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form)),a={},n=[];if(this.employeeIdList=[],""!==this.form.batchTitle)if(this.employees.forEach((function(e,a){t.employeeIdList[a]=e.employeeId})),""!==this.employeeIdList){if(""!==this.form.textContent&&(a={msgType:"text",content:this.form.textContent},n.push(a)),"1"===this.msgType){if(delete e.content.image,delete e.content.miniprogram,""===this.form.textContent&&""===this.form.content.image.pic_url)return void this.$message.warning("请上传图片");""!==this.form.content.image.pic_url&&(a={msgType:"image",media_id:(new Date).getTime(),pic_url:this.form.content.image.pic_url},n.push(a))}else if("2"===this.msgType){if(""===this.form.textContent&&-1===this.form.content.link.url.indexOf("http://")&&-1===this.form.content.link.url.indexOf("https://"))return void this.$message.warning("链接地址输入不正确");""!==this.form.content.link.url&&(a={msgType:"link",title:this.form.content.link.title,pic_url:this.form.content.link.picture,desc:this.form.content.link.desc,url:this.form.content.link.url},n.push(a))}else if("3"===this.msgType){if(""===this.form.textContent){if(""===this.form.content.miniprogram.pic_media_id)return void this.$message.warning("请选择封面");if(""===this.form.content.miniprogram.title)return void this.$message.warning("请填写标题");if(""===this.form.content.miniprogram.appid)return void this.$message.warning("请输入appId");if(""===this.form.content.miniprogram.page)return void this.$message.warning("请输入小程序路径")}""!==this.form.content.miniprogram.page&&(a={msgType:"miniprogram",title:this.form.content.miniprogram.title,pic_media_id:this.form.content.miniprogram.pic_media_id,appid:this.form.content.miniprogram.appid,page:this.form.content.miniprogram.page},n.push(a))}if(2==this.form.sendWay){if(""==this.form.definiteTime)return void this.$message.warning("请选择时间")}else e.definiteTime=this.getDateTime();e.employeeIds=this.employeeIdList,e.content=JSON.stringify(n),Object(s["a"])(e).then((function(e){t.btnLoading=!1,t.$message.success("内容已提交"),t.$router.push("/roomMessageBatchSend/index")})).catch((function(e){t.btnLoading=!1}))}else this.$message.warning("请选择群主");else this.$message.warning("群发名称不能为空")},selectTime:function(t,e){this.form.definiteTime=e},getDateTime:function(){var t=(new Date).getFullYear(),e=(new Date).getMonth()+1<10?"0"+((new Date).getMonth()+1):(new Date).getMonth()+1,a=(new Date).getDate()<10?"0"+(new Date).getDate():(new Date).getDate(),n=(new Date).getHours(),i=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes(),r=(new Date).getSeconds()<10?"0"+(new Date).getSeconds():(new Date).getSeconds(),o=t+"-"+e+"-"+a+" "+n+":"+i+":"+r;return o},uploadImageSuccess:function(t){this.form.content.image.pic_urlImg=t.fullPath,this.$refs.preview.setImage(t.fullPath)},uploadLinkSuccess:function(t){this.form.content.link.pictureImg=t.fullPath},uploadMiniprogramSuccess:function(t){this.form.content.miniprogram.pic_media_idImg=t.fullPath},cancel:function(){this.choosePeopleShow=!1,this.employeeIdList="",this.employees=[]},importMedium:function(){this.importModal=!0,this.mediumType=6,this.getMaterialLibrary()},mediumImport:function(t,e){this.mediumId=t,this.form.content.miniprogram={title:e.title,pic_media_id:e.imageFullPath,appid:e.appid,page:e.page}},changeGroup:function(t){this.mediumGroupId=t,this.getMaterialLibrary()},getMaterialLibrary:function(){var t=this;Object(c["h"])({mediumGroupId:this.mediumGroupId,searchValue:this.searchValue,type:this.mediumType}).then((function(e){t.materialData=e.data.list})),this.getMediumGroup()},getMediumGroup:function(){var t=this;Object(c["i"])().then((function(e){t.mediumGroupList=e.data,t.mediumGroupId=0})).catch((function(e){t.mediumGroupId=""}))},importDefined:function(){""!=this.mediumId?this.importModal=!1:this.$message.error("请选择素材")},resetImport:function(){this.importModal=!1,this.mediumDetail={},this.mediumTitle="",this.mediumId=""}}},u=d,m=(a("eff2"),a("2877")),p=Object(m["a"])(u,n,i,!1,null,"731d93f2",null);e["default"]=p.exports},"4f1c":function(t,e,a){"use strict";a("4873")},"59e4":function(t,e,a){"use strict";a.d(e,"C",(function(){return i})),a.d(e,"k",(function(){return r})),a.d(e,"i",(function(){return o})),a.d(e,"x",(function(){return s})),a.d(e,"D",(function(){return c})),a.d(e,"u",(function(){return l})),a.d(e,"f",(function(){return d})),a.d(e,"y",(function(){return u})),a.d(e,"A",(function(){return m})),a.d(e,"l",(function(){return p})),a.d(e,"t",(function(){return f})),a.d(e,"s",(function(){return h})),a.d(e,"B",(function(){return g})),a.d(e,"e",(function(){return b})),a.d(e,"c",(function(){return v})),a.d(e,"d",(function(){return y})),a.d(e,"z",(function(){return _})),a.d(e,"b",(function(){return x})),a.d(e,"w",(function(){return k})),a.d(e,"q",(function(){return w})),a.d(e,"o",(function(){return C})),a.d(e,"v",(function(){return I})),a.d(e,"a",(function(){return S})),a.d(e,"n",(function(){return T})),a.d(e,"j",(function(){return O})),a.d(e,"p",(function(){return j})),a.d(e,"g",(function(){return D})),a.d(e,"h",(function(){return $})),a.d(e,"m",(function(){return A})),a.d(e,"r",(function(){return L}));var n=a("b775");function i(t){return Object(n["b"])({url:"/workRoomGroup/index",method:"get",params:t})}function r(t){return Object(n["b"])({url:"/workRoomGroup/destroy",method:"delete",data:t})}function o(t){return Object(n["b"])({url:"/workRoomGroup/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/workRoomGroup/update",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/workRoom/index",method:"get",params:t})}function l(t){return Object(n["b"])({url:"/workRoom/syn",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/workRoom/batchUpdate",method:"put",data:t})}function u(t){return Object(n["b"])({url:"/workContactRoom/index",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/workEmployeeDepartment/memberIndex",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/workRoom/statisticsIndex",method:"get",params:t})}function h(t){return Object(n["b"])({url:"/workRoom/statistics",method:"get",params:t})}function g(t){return Object(n["b"])({url:"/workRoomAutoPull/index",method:"get",params:t})}function b(t){return Object(n["b"])({url:"/workRoomAutoPull/update",method:"put",data:t})}function v(t){return Object(n["b"])({url:"/workRoomAutoPull/store",method:"post",data:t})}function y(t){return Object(n["b"])({url:"/workRoomAutoPull/show",method:"get",params:t})}function _(t){return Object(n["b"])({url:"/workContactTagGroup/index",method:"get",params:t})}function x(t){return Object(n["b"])({url:"/workContactTag/store",method:"post",data:t})}function k(t){return Object(n["b"])({url:"/workContactTag/allTag",method:"get",params:t})}function w(t){return Object(n["b"])({url:"/workRoom/roomIndex",method:"get",params:t})}function C(t){return Object(n["b"])({url:"/roomTagPull/roomList",method:"get",params:t})}function I(t){return Object(n["b"])({url:"/roomTagPull/index",method:"get",params:t})}function S(t){return Object(n["b"])({url:"/roomTagPull/store",method:"POST",data:t})}function T(t){return Object(n["b"])({url:"/roomTagPull/show",method:"GET",params:t})}function O(t){return Object(n["b"])({url:"/roomTagPull/destroy",method:"DELETE",data:t})}function j(t){return Object(n["b"])({url:"/roomTagPull/remindSend",method:"GET",params:t})}function D(t){return Object(n["b"])({url:"/roomTagPull/chooseContact",method:"GET",params:t})}function $(t){return Object(n["b"])({url:"/roomTagPull/filterContact",method:"POST",data:t})}function A(t){return Object(n["b"])({url:"/roomTagPull/showContact",method:"GET",params:t})}function L(t){return Object(n["b"])({url:"/contactMessageBatchSend/showRoom",method:"GET",params:t})}},"6b75":function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},8522:function(t,e,a){t.exports=a.p+"assets/avatar-room-default.67bead38.svg"},"90ce":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return o})),a.d(e,"h",(function(){return s})),a.d(e,"c",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"g",(function(){return d})),a.d(e,"b",(function(){return u}));var n=a("b775");function i(t){return Object(n["b"])({url:"/roomMessageBatchSend/store",method:"post",params:t})}function r(t){return Object(n["b"])({url:"/roomMessageBatchSend/index",method:"get",params:t})}function o(t){return Object(n["b"])({url:"roomMessageBatchSend/remind",method:"get",params:t})}function s(t){return Object(n["b"])({url:"roomMessageBatchSend/show",method:"get",params:t})}function c(t){return Object(n["b"])({url:"/roomMessageBatchSend/destroy",method:"delete",data:t})}function l(t){return Object(n["b"])({url:"roomMessageBatchSend/roomOwnerSendIndex",method:"get",params:t})}function d(t){return Object(n["b"])({url:"roomMessageBatchSend/roomReceiveIndex",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}},"9c58":function(t,e,a){},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var n=a("06c5");function i(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(n["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(c)throw o}}}}},c297:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"people-wrapper"},[a("div",{staticClass:"people-left"},[a("a-input-search",{staticClass:"add-input",attrs:{maxLength:15},on:{search:t.getDepartmentList},model:{value:t.searchKeyWords,callback:function(e){t.searchKeyWords="string"===typeof e?e.trim():e},expression:"searchKeyWords"}}),a("a-tree",{attrs:{"show-icon":"",checkable:"",replaceFields:t.replaceFields,checkStrictly:!1,"expanded-keys":t.expandedKeys,"selected-keys":t.selectedKeys,"tree-data":t.treeData},on:{check:t.onCheck,expand:t.onExpand},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}},[a("a-icon",{attrs:{slot:"folder",type:"folder-open"},slot:"folder"})],1)],1),a("div",{staticClass:"people-right"},[a("div",{staticClass:"total"},[t._v("已选择成员")]),a("ul",t._l(t.choosePeopleKey,(function(e,n){return a("li",{key:n,staticClass:"number"},[a("span",{staticClass:"title"},[t._v(t._s(e.employeeName))]),a("a-icon",{staticClass:"close",attrs:{type:"close"},on:{click:function(a){return t.deletePeople(e,n)}}})],1)})),0)])])},i=[],r=a("2909"),o=a("1da1"),s=a("5530"),c=(a("4de4"),a("d3b7"),a("a15b"),a("caad"),a("2532"),a("a434"),a("d81d"),a("0481"),a("4069"),a("159b"),a("99af"),a("96cf"),a("59e4")),l=a("5880"),d={name:"Department",props:{memberKey:{type:Array,default:function(){return[]}},isChecked:{type:Array,default:function(){return[]}}},data:function(){return{searchKeyWords:"",checkedKeys:[],replaceFields:{title:"name",key:"id",children:"son"},expandedKeys:[],selectedKeys:[],treeData:[],lastCheckdKeys:[],choosePeopleKey:[],departmentIds:[],flatAry:[],unchecked:[]}},watch:{memberKey:function(t){this.choosePeopleKey=t},choosePeopleKey:function(t){this.$emit("change",t)},isChecked:function(t){this.checkedKeys=t}},computed:Object(s["a"])({},Object(l["mapGetters"])(["corpName"])),created:function(){var t=this;this.choosePeopleKey=this.memberKey,this.checkedKeys=this.isChecked;var e=this.corpName?0:2e3;setTimeout((function(){t.getDepartmentList()}),e)},methods:{getDepartmentList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,n,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={searchKeyWords:t.searchKeyWords},e.prev=1,e.next=4,Object(c["l"])(a);case 4:n=e.sent,i=n.data,r=i.department,o=i.employee,""!==t.searchKeyWords&&t.$emit("search",o),t.department=r||[],t.employee=o||[],t.treeData=[{name:t.corpName,nameEn:"company",id:"company",slots:{icon:"folder"},son:r}],e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](1);case 16:case"end":return e.stop()}}),e,null,[[1,14]])})))()},onCheck:function(t){var e=this,a=t.length,n=this.lastCheckdKeys.length,i=[],r=[];a>n?(i=t.filter((function(t){return-1==e.lastCheckdKeys.indexOf(t)&&"company"!==t})),this.getWorkDepartmentList(i.join(","))):(r=this.lastCheckdKeys.filter((function(e){return-1==t.indexOf(e)&&"company"!==e})),this.choosePeopleKey=this.choosePeopleKey.filter((function(t){return!r.includes(t.departmentId)}))),this.lastCheckdKeys=t},onExpand:function(t){this.expandedKeys=t},deletePeople:function(t,e){var a=this;this.choosePeopleKey.splice(e,1);var n=this.departmentIds[t.employeeId];n.map((function(t){var e=a.choosePeopleKey.filter((function(e){return e.departmentId==t}));if(0==e.length){var n=a.checkedKeys.indexOf("company");n>-1&&a.checkedKeys.splice(n,1),a.dealDeleteData(t),a.unchecked.map((function(t){var e=a.checkedKeys.indexOf(t);e>-1&&a.checkedKeys.splice(e,1)}))}})),0==this.choosePeopleKey.length&&(this.checkedKeys=[])},dealDeleteData:function(t){var e=this.treeData[0];this.flatAry=[],this.unchecked=[],this.flat(e.son,t);var a=this.unchecked.length;a>1&&this.filterId(this.unchecked[a-1])},filterId:function(t){var e=this;this.flatAry.filter((function(a){if(a.id==t)return e.unchecked.push(t),0!=a.parentId&&e.filterId(a.parentId),!0}))},flat:function(t,e){var a=this;t.forEach((function(t){a.flatAry.push(t),t.id==e&&(0!=t.parentId?a.unchecked=[t.id,t.parentId]:a.unchecked=[t.id]),t.son&&a.flat(t.son,e)}))},getWorkDepartmentList:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n,i,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.departmentIds={},a.prev=1,a.next=4,Object(c["A"])({departmentIds:t});case 4:n=a.sent,i=n.data,i=i||[],e.choosePeopleKey=[].concat(Object(r["a"])(e.choosePeopleKey),Object(r["a"])(i)),o=[],s=[],e.choosePeopleKey.forEach((function(t){var a=s.indexOf(t.employeeId);a>-1?e.departmentIds[t.employeeId].push(t.departmentId):(e.departmentIds[t.employeeId]=[t.departmentId],s.push(t.employeeId),o.push(t))})),e.choosePeopleKey=o,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](1);case 16:case"end":return a.stop()}}),a,null,[[1,14]])})))()}}},u=d,m=(a("4f1c"),a("2877")),p=Object(m["a"])(u,n,i,!1,null,"393e889a",null);e["a"]=p.exports},d12f:function(t,e,a){"use strict";a("3096")},d13e:function(t,e,a){},dd26:function(t,e,a){"use strict";a("3ee7")},ed6b:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-row",{staticClass:"top",attrs:{gutter:0,type:"flex",justify:"space-between"}},[n("a-col",{attrs:{span:12}},[n("div",{staticClass:"child_module left",staticStyle:{"padding-bottom":"20px"}},[n("div",{staticClass:"child_title"},[t._v("基本详情")]),n("div",{staticClass:"user_info"},[n("div",{staticClass:"item"},[n("span",[t._v("创建者：")]),n("div",{staticClass:"user"},[n("a-icon",{staticClass:"icon",attrs:{type:"user"}}),t._v(t._s(t.info.creator))],1)]),n("div",{staticClass:"item"},[n("span",[t._v("创建时间：")]),t._v(t._s(t.info.createdAt))]),n("div",{staticClass:"item",staticStyle:{"flex-wrap":"wrap"}},[n("span",[t._v("群发对象：")]),t._l(t.info.seedRooms,(function(e,a){return n("div",{key:a,staticClass:"obj"},[t._v(t._s(e.name))])})),t._v(" ;等"+t._s("undefined"!==t.info.seedRooms.length?t.info.seedRooms.length:0)+"个群聊 ")],2),t._l(t.info.content,(function(e,a){return n("div",{key:a},["text"===e.msgType?n("div",{staticClass:"item"},[n("span",[t._v("群发消息1：")]),t._v(t._s(e.content))]):t._e(),"image"===e.msgType||"link"===e.msgType||"miniprogram"===e.msgType?n("div",{staticClass:"item"},[n("span",[t._v("群发消息2：")])]):t._e(),n("div",{staticStyle:{"margin-left":"75px","margin-top":"10px"}},["image"==e.msgType?n("div",[n("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})]):t._e(),"link"==e.msgType?n("div",[n("div",[t._v(t._s(e.url))]),n("div",{staticStyle:{display:"flex"}},[n("div",[n("div",[t._v(t._s(e.title))]),n("div",[t._v(t._s(e.desc))])]),n("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})])]):t._e(),"miniprogram"==e.msgType?n("div",[n("div",{staticClass:"applets"},[n("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" ")]),n("div",{staticClass:"image"},[n("img",{attrs:{src:e.pic_url}})]),n("div",{staticClass:"applets-logo"},[t._v(" 小程序 ")])])]):t._e()])])}))],2)])]),n("a-col",{staticClass:"col_right",attrs:{span:12}},[n("div",{staticClass:"child_module right"},[n("div",{staticClass:"child_title"},[t._v("数据详情")]),n("a-row",{staticClass:"total_module",attrs:{type:"flex",justify:"space-between"}},[n("a-col",{staticClass:"item item_hr",attrs:{span:12}},[n("span",[t._v(t._s(t.info.sendTotal))]),n("p",[t._v("已发送群主")])]),n("a-col",{staticClass:"item",attrs:{span:12}},[n("span",[t._v(t._s(t.info.notSendTotal))]),n("p",[t._v("未发送群主")])]),n("a-col",{staticClass:"item item_hr",attrs:{span:12}},[n("span",[t._v(t._s(t.info.receivedTotal))]),n("p",[t._v("已送达群聊")])]),n("a-col",{staticClass:"item",attrs:{span:12}},[n("span",[t._v(t._s(t.info.notReceivedTotal))]),n("p",[t._v("未送达群聊")])])],1)],1)])],1),n("a-card",{staticStyle:{"margin-top":"20px"}},[n("a-tabs",{on:{change:t.tabTable},model:{value:t.tableIndex,callback:function(e){t.tableIndex=e},expression:"tableIndex"}},[n("a-tab-pane",{key:1,attrs:{tab:"客户群接受详情"}}),n("a-tab-pane",{key:2,attrs:{tab:"群主发送详情"}})],1),n("div",[n("div",{staticStyle:{"font-weight":"bold"}},[t._v(" 共"+t._s(t.table.data.length)+"个"),1==t.tableIndex?[t._v("群聊")]:[t._v("群主")]],2)]),n("div",{staticStyle:{display:"flex","margin-top":"20px"}},[1==t.tableIndex?n("div",{staticClass:"screen_box"},[t._v(" 搜索群聊： "),n("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入要搜索的群聊"},model:{value:t.tableAskData.keyWords,callback:function(e){t.$set(t.tableAskData,"keyWords",e)},expression:"tableAskData.keyWords"}})],1):t._e(),n("div",{staticClass:"screen_box"},[t._v(" 群主： "),n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择管理员"},model:{value:t.tableAskData.employeeIds,callback:function(e){t.$set(t.tableAskData,"employeeIds",e)},expression:"tableAskData.employeeIds"}},t._l(t.employeeData,(function(e,a){return n("a-select-option",{key:a,attrs:{value:e.employeeId}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),n("div",{staticClass:"screen_box"},[t._v(" 送达状态： "),n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择发送状态"},model:{value:t.tableAskData.sendStatus,callback:function(e){t.$set(t.tableAskData,"sendStatus",e)},expression:"tableAskData.sendStatus"}},[n("a-select-option",{attrs:{value:0}},[t._v("未发送")]),n("a-select-option",{attrs:{value:1}},[t._v("已发送")]),n("a-select-option",{attrs:{value:2}},[t._v("发送失败")])],1)],1),n("a-button",{staticStyle:{"margin-left":"20px"},on:{click:t.resetBtn}},[t._v("重置")]),n("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:t.searchTableData}},[t._v("搜索")])],1),n("div",{staticStyle:{"margin-top":"30px"}},[n("a-table",{attrs:{columns:1==t.tableIndex?t.table.groupColumns:t.table.sendColumns,"data-source":t.table.data},scopedSlots:t._u([{key:"employeeName",fn:function(e){return n("div",{},[n("a-tag",[n("a-icon",{attrs:{type:"user"}}),t._v(t._s(e))],1)],1)}},{key:"status",fn:function(e){return n("div",{},[0==e?n("a-tag",{attrs:{color:"gray"}},[t._v("未发送")]):t._e(),1==e?n("a-tag",{attrs:{color:"green"}},[t._v("已发送")]):t._e(),2==e?n("a-tag",{attrs:{color:"red"}},[t._v("因客户不是好友导致发送失败")]):t._e(),3==e?n("a-tag",{attrs:{color:"red"}},[t._v("因客户已经收到其他群发消息导致发送失败")]):t._e()],1)}},{key:"operation",fn:function(e,a){return n("div",{},[n("a",{on:{click:function(e){return t.detailsRow(a)}}},[t._v("群详情")])])}},{key:"operate",fn:function(e,a){return n("div",{},[0===a.status?n("a",{on:{click:function(e){return t.remindBtn(a)}}},[t._v("提醒发送")]):t._e(),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(e){return t.groupSendDetails(a)}}},[t._v("群发详情")])],1)}}])})],1)],1),n("a-modal",{attrs:{title:"群发详情",footer:null,maskClosable:!1,width:"750px"},model:{value:t.detailsPopup,callback:function(e){t.detailsPopup=e},expression:"detailsPopup"}},[n("div",{staticStyle:{"padding-bottom":"10px"}},[n("div",{staticClass:"details_top_data"},[n("div",{staticStyle:{"text-align":"center","font-size":"15px"}},[n("div",{staticStyle:{"font-size":"22px","font-weight":"bold"}},[t._v(t._s(t.groupTotal))]),n("div",[t._v("本次推送群群聊")])]),n("div",{staticStyle:{"text-align":"center","font-size":"15px"}},[n("div",{staticStyle:{"font-size":"22px","font-weight":"bold"}},[t._v(t._s(t.groupSendNum))]),n("div",[t._v("已发送群聊")])]),n("div",{staticStyle:{"text-align":"center","font-size":"15px"}},[n("div",{staticStyle:{"font-size":"22px","font-weight":"bold"}},[t._v(t._s(t.groupTotal-t.groupSendNum))]),n("div",[t._v("未发送群聊")])])]),n("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-top":"20px","font-size":"15px"}},[n("div",{staticClass:"row_name"},[t._v("全部("+t._s(t.sendData.length)+")")]),n("div",[t._v(" 送达状态： "),n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择送达状态"},on:{change:t.selectStatus},model:{value:t.sendStatus,callback:function(e){t.sendStatus=e},expression:"sendStatus"}},[n("a-select-option",{attrs:{value:4}},[t._v("全部")]),n("a-select-option",{attrs:{value:0}},[t._v("群主未发送")]),n("a-select-option",{attrs:{value:1}},[t._v("群主已发送")]),n("a-select-option",{attrs:{value:2}},[t._v("发送失败")])],1)],1)]),n("div",{staticClass:"group_details_row"},[0!=t.sendData.length?n("div",t._l(t.sendData,(function(e,i){return n("div",{key:i,staticClass:"group_details"},[n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",[n("img",{attrs:{src:a("8522"),alt:""}}),t._v(" "+t._s(e.roomName)+" "),1==e.status?n("a-tag",{attrs:{color:"green"}},[t._v("群主已发送")]):t._e(),0==e.status?n("a-tag",{attrs:{color:"red"}},[t._v("群主未发送")]):t._e(),2==e.status||3==e.status?n("a-tag",{attrs:{color:"gray"}},[t._v("发送失败")]):t._e()],1),n("a",{staticStyle:{"margin-top":"15px"},on:{click:function(a){return t.$router.push({path:"/workRoom/detail?workRoomId="+e.roomId})}}},[t._v("群详情")])]),n("a-divider")],1)})),0):n("div",{staticStyle:{"margin-top":"75px"}},[n("Empty")],1)])])])],1)},i=[],r=(a("06f4"),a("fc25")),o=a("90ce"),s={components:{Empty:r["a"]},data:function(){return{info:{},contentArray:[],receiveLst:{},sendArray:[],tableIndex:1,table:{groupColumns:[{title:"群聊名称",dataIndex:"roomName"},{title:"群主",dataIndex:"employeeName",scopedSlots:{customRender:"employeeName"}},{title:"群聊成员数量",dataIndex:"roomEmployeeNum"},{title:"消息送达状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"群聊创建时间",dataIndex:"roomCreateTime"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],sendColumns:[{title:"群主",dataIndex:"employeeName",scopedSlots:{customRender:"employeeName"}},{title:"群发发送状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"本次群发群聊总数",dataIndex:"sendRoomTotal"},{title:"已发送群聊数",dataIndex:"sendSuccessTotal"},{title:"确认发送时间",dataIndex:"sendTime"},{title:"操作",dataIndex:"operate",scopedSlots:{customRender:"operate"}}],data:[]},batchId:"",tableAskData:{batchId:"",keyWords:""},employeeData:[],detailsPopup:!1,groupTotal:0,groupSendNum:0,sendData:[],sendStatus:4,employeeIds:""}},mounted:function(){this.batchId=this.$route.query.batchId,this.tableAskData.batchId=this.batchId,this.getDetailsData(this.batchId),this.getStaffData(),this.clientAccept()},methods:{selectStatus:function(){this.groupSendData()},groupSendData:function(){var t=this,e={batchId:this.batchId,employeeIds:this.employeeIds};4==this.sendStatus?e.sendStatus="":e.sendStatus=this.sendStatus,Object(o["g"])(e).then((function(e){t.sendData=e.data.list}))},groupSendDetails:function(t){this.groupTotal=t.sendRoomTotal,this.groupSendNum=t.sendSuccessTotal,this.employeeIds=t.employeeId,this.groupSendData(),this.detailsPopup=!0},detailsRow:function(t){this.$router.push({path:"/workRoom/detail?workRoomId="+t.roomId})},remindBtn:function(t){var e=this;Object(o["e"])({batchId:this.batchId,batchEmployId:t.employeeId}).then((function(t){e.$message.success("提醒成功")}))},resetBtn:function(){this.tableAskData={},1==this.tableIndex?this.clientAccept():this.clientSend()},searchTableData:function(){1==this.tableIndex?this.clientAccept():this.clientSend()},getStaffData:function(){var t=this;Object(o["b"])().then((function(e){t.employeeData=e.data.employee}))},tabTable:function(){this.table.data=[],this.tableAskData={},this.tableAskData.batchId=this.batchId,1==this.tableIndex?this.clientAccept():this.clientSend()},clientSend:function(){var t=this;Object(o["f"])(this.tableAskData).then((function(e){t.table.data=e.data.list}))},clientAccept:function(){var t=this;Object(o["g"])(this.tableAskData).then((function(e){t.table.data=e.data.list}))},getDetailsData:function(t){var e=this;Object(o["h"])({batchId:t}).then((function(t){e.info=t.data}))}}},c=s,l=(a("d12f"),a("2877")),d=Object(l["a"])(c,n,i,!1,null,"7c014709",null);e["default"]=d.exports},eff2:function(t,e,a){"use strict";a("d13e")},f268:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index_module"},[a("a-row",{staticClass:"search",attrs:{type:"flex",justify:"space-between"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新建群发")]),a("a-input-search",{attrs:{placeholder:"请输入群发名称"},on:{search:t.onSearch},model:{value:t.searchTable,callback:function(e){t.searchTable=e},expression:"searchTable"}})],1),a("a-table",{staticClass:"index_table",attrs:{rowKey:"id",pagination:t.pagination,columns:t.columns,"data-source":t.dataList},on:{change:t.tableChange},scopedSlots:t._u([{key:"content",fn:function(e,n){return a("div",{},t._l(n.content,(function(e,n){return a("div",{key:n},["text"===e.msgType?a("div",[t._v("群发消息1："+t._s(e.content))]):t._e(),"image"===e.msgType||"link"===e.msgType||"miniprogram"===e.msgType?a("div",{staticStyle:{"margin-top":"10px"}},[t._v("群发消息2：")]):t._e(),a("div",{staticStyle:{"margin-left":"15px","margin-top":"10px"}},["image"==e.msgType?a("div",[a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})]):t._e(),"link"==e.msgType?a("div",[a("div",[t._v(t._s(e.url))]),a("div",{staticStyle:{display:"flex"}},[a("div",[a("div",[t._v(t._s(e.title))]),a("div",[t._v(t._s(e.desc))])]),a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})])]):t._e(),"miniprogram"==e.msgType?a("div",[a("div",{staticClass:"applets"},[a("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" ")]),a("div",{staticClass:"image"},[a("img",{attrs:{src:e.pic_url}})]),a("div",{staticClass:"applets-logo"},[t._v(" 小程序 ")])])]):t._e()])])})),0)}},{key:"action",fn:function(e,n){return a("span",{},[0!=n.notReceivedTotal?a("a",{on:{click:function(e){return t.handleRemind(n)}}},[t._v("提醒发送")]):t._e(),0!=n.notReceivedTotal?a("a-divider",{attrs:{type:"vertical"}}):t._e(),a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return t.handleJump(n)}}},[t._v("详情 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.delRowTable(n)}}},[t._v("删除")])],1)}}])})],1)},i=[],r=(a("d3b7"),a("159b"),a("90ce")),o=[{dataIndex:"batchTitle",title:"群发名称"},{title:"发送时间",dataIndex:"definiteTime"},{title:"群发内容",dataIndex:"textContent",scopedSlots:{customRender:"content"}},{title:"已发送群主",dataIndex:"sendTotal"},{title:"送达群聊",dataIndex:"receivedTotal"},{title:"未发送群主",dataIndex:"notSendTotal"},{title:"未送达群聊",dataIndex:"notReceivedTotal"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],s={data:function(){return{searchTable:"",dataList:[],columns:o,pagination:{total:0,pageSize:10,current:1}}},mounted:function(){this.selectList({page:this.pagination.current,perPage:this.pagination.pageSize})},methods:{onSearch:function(){this.selectList({page:1,perPage:100})},tableChange:function(t){this.pagination.current=t.current,this.selectList({page:t.current,perPage:t.pageSize})},selectList:function(t){var e=this;Object(r["d"])({page:t.page,perPage:t.perPage,batchTitle:this.searchTable}).then((function(t){t=t.data,t.list.forEach((function(t){"text"!=t.msgType&&"image"!=t.msgType||e.contentArray.push(t)})),e.dataList=t.list,e.pagination={total:t.page.total,pageSize:parseInt(t.page.perPage),current:t.page.totalPage}}))},handleAdd:function(){this.$router.push("/roomMessageBatchSend/store")},handleRemind:function(t){var e=this;this.$confirm({title:"提醒?",content:"确认后将会给所有未发送成员发送提醒通知，是否发送",onOk:function(){Object(r["e"])({batchId:t.id}).then((function(t){e.$message.success("已提醒")}))},onCancel:function(){}})},handleJump:function(t){this.$router.push("/roomMessageBatchSend/show?batchId="+t.id)},delRowTable:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){Object(r["c"])({batchId:t.id}).then((function(t){e.$message.success("删除成功"),e.selectList({page:e.pagination.current,perPage:e.pagination.pageSize})}))}})}}},c=s,l=(a("0015"),a("2877")),d=Object(l["a"])(c,n,i,!1,null,null,null);e["default"]=d.exports},ff04:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-upload",{class:t.btnType?"avatar-uploader":"btn-type",attrs:{name:"file","list-type":"picture-card",headers:t.headers,method:"post","show-upload-list":!1,action:t.uploadApi,"before-upload":t.beforeUpload,accept:"image/*"},on:{change:t.handleChange}},[t.btnType?a("div",[t.imageUrl?a("div",{staticClass:"img-wrapper"},[a("img",{staticClass:"img",attrs:{src:t.imageUrl,alt:"avatar"}})]):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}})],1)]):a("a-button",{attrs:{type:"link"}},[t._v("重新上传")])],1)},i=[],r=(a("a9e3"),a("b0c0"),a("ac1f"),a("1276"),a("d81d"),a("99af"),a("caad"),a("2532"),a("a15b"),a("8ded")),o=a.n(r),s={model:{prop:"modelVal",event:"changeImg"},props:{fileType:{type:Number||Array,default:1},modelVal:{default:"",type:String},btnType:{type:Boolean,default:!0}},data:function(){return{loading:!1,imageUrl:"",FileTypeArr:["",["jpg","png","jpeg"],["mp3","amr"],["mp4"],["doc","docx","xls","xlsx","csv","ppt","pptx","txt","pdf","Xmind"]],uploadApi:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL+"/dashboard/common/upload"}},computed:{headers:function(){var t=o.a.get("ACCESS_TOKEN");return{Accept:"application/json",Authorization:t}}},created:function(){},methods:{showImg:function(t){this.imageUrl=t},handleChange:function(t){if("uploading"!==t.file.status){if("done"===t.file.status){var e=t.file.response.data;this.$emit("success",e),this.$emit("changeImg",e.path),this.imageUrl=e.fullPath,this.loading=!1}if("error"===t.file.status&&t.file.response){var a=t.file.response;this.$message.error(a.msg)}}else this.loading=!0},beforeUpload:function(t){var e=this,a=this._getFileSuffix(t.name).toLowerCase(),n=t.type.split("/")[0],i=t.size/1024/1024<2,r=t.size/1024/1024<10,o=[];this.fileType instanceof Array?this.fileType.map((function(t){o.concat(e.FileTypeArr[t])})):o=this.FileTypeArr[this.fileType];var s=o.includes(a);return s?"video"===n?(r||this.$message.error("上传文件过大"),s&&r):(i||this.$message.error("上传文件过大"),s&&i):(this.$message.error("您只能上传以下类型： ".concat(o.join(","))),!1)},_getFileSuffix:function(t){return t.substring(t.lastIndexOf(".")+1)}}},c=s,l=(a("dd26"),a("2877")),d=Object(l["a"])(c,n,i,!1,null,null,null);e["a"]=d.exports}}]);