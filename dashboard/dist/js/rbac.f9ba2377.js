(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["rbac"],{2185:function(e,t,n){"use strict";n("d37a")},"263b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-card",{staticClass:"card",attrs:{title:"权限设置"}},[n("div",{attrs:{slot:"extra"},slot:"extra"},[n("a-button",{staticClass:"cancel",on:{click:e.cancel}},[e._v("取消")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/permissionShow@save",expression:"'/role/permissionShow@save'"}],attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("保存权限")])],1),e._l(e.info,(function(t,a){return n("div",{key:a,staticClass:"wrapper"},[n("div",{staticClass:"first-wrapper"},[n("div",{staticClass:"first-title"},[n("a-checkbox",{attrs:{checked:"2"==t.checked,indeterminate:"3"==t.checked},on:{change:function(n){return e.checkClick(n,t)}}}),n("a-button",{attrs:{type:"link"}},[e._v(e._s(t.name))])],1)]),n("div",{staticClass:"second-wrapper"},e._l(t.children,(function(a,r){return n("div",{key:"secondTitle"+r,class:["second-item",a.flag?"active":""]},[n("a-checkbox",{attrs:{checked:"2"==a.checked,indeterminate:"3"==a.checked},on:{change:function(n){return e.checkClick(n,a,t)}}}),n("a-button",{class:a.flag?"active":"",attrs:{type:"link"},on:{click:function(n){return e.itemClick(t,r)}}},[e._v(e._s(a.name))])],1)})),0),e._l(t.children,(function(a,r){return n("div",{key:"second"+r},[a.flag?n("div",{staticClass:"permission"},[n("div",{staticClass:"third-wrapper"},e._l(a.children,(function(r,i){return n("div",{key:"thirdIndex"+i,staticClass:"third-content"},[n("div",{staticClass:"third-item"},[n("a-checkbox",{attrs:{checked:"2"==r.checked,indeterminate:"3"==r.checked},on:{change:function(n){return e.checkClick(n,r,a,t)}}}),n("a-button",{class:[r.flag?"active":"",2==r.isPageMenu?"light":""],attrs:{type:"link"},on:{click:function(t){return e.itemClick(a,i)}}},[e._v(e._s(r.name))])],1)])})),0),n("div",{staticClass:"fourth-wrapper"},[n("div",{staticClass:"inner"},e._l(a.children,(function(r,i){return n("div",{key:"thir"+i,staticClass:"fourth-content"},[r.flag?n("div",e._l(r.children,(function(i,o){return n("div",{key:"fourth"+o,staticClass:"fourth-item"},[n("a-checkbox",{attrs:{checked:"2"==i.checked,indeterminate:"3"==i.checked},on:{change:function(n){return e.checkClick(n,i,r,a,t)}}}),n("a-button",{class:[i.flag?"active":"",2==i.isPageMenu?"light":""],attrs:{type:"link"},on:{click:function(t){return e.itemClick(r,o)}}},[e._v(e._s(i.name))])],1)})),0):e._e()])})),0)]),n("div",{staticClass:"fif-wrapper"},[n("div",{staticClass:"inner"},e._l(a.children,(function(r,i){return n("div",{key:"thi"+i,staticClass:"fourth-content"},[r.flag?n("div",e._l(r.children,(function(i,o){return n("div",{key:"fourt"+o,staticClass:"fourth-item"},[i.flag?n("div",e._l(i.children,(function(o,c){return n("div",{key:"fif"+c,staticClass:"fif-item"},[n("a-checkbox",{attrs:{checked:"2"==o.checked,indeterminate:"3"==o.checked},on:{change:function(n){return e.checkClick(n,o,i,r,a,t)}}}),n("a-button",{class:2==o.isPageMenu?"light":"",attrs:{type:"link"}},[e._v(e._s(o.name))])],1)})),0):e._e()])})),0):e._e()])})),0)])]):e._e()])}))],2)}))],2)],1)},r=[],i=n("1da1"),o=(n("96cf"),n("d81d"),n("d3b7"),n("159b"),n("cc5e")),c={data:function(){return{roleId:"",info:[],permissionData:[],loading:!1}},created:function(){var e=this;this.roleId=this.$route.query.roleId,Object(o["d"])({roleId:this.roleId}).then((function(t){e.info=e.dealData(t.data)}))},methods:{dealData:function(e){var t=this;return e.map((function(e){return t.itemClick(e,0),e}))},itemClick:function(e,t){e.children&&e.children.forEach((function(e,n){e.flag=n==t,e.children&&e.children.forEach((function(e,t){e.flag=0==t,e.children&&e.children.forEach((function(e,t){e.flag=0==t}))}))}))},dealCheck:function(e,t){var n="";e.target.checked?(t.checked="2",n="2"):(t.checked="1",n="1"),t.children&&t.children.forEach((function(e,t){e.checked=n,e.children&&e.children.forEach((function(e,t){e.checked=n,e.children&&e.children.forEach((function(e,t){e.checked=n,e.children&&e.children.forEach((function(e,t){e.checked=n}))}))}))}))},checkClick:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.dealCheck(e,n[0]);var r=e.target.checked;n.forEach((function(e,t){if(t>0&&e.children)if(r){var n=e.children.every((function(e){return"2"==e.checked}));e.checked=n?"2":"3"}else{var a=e.children.some((function(e){return"2"==e.checked||"3"==e.checked}));e.checked=a?"3":"1"}}))},cancel:function(){this.$router.push({path:"/role/index"})},dealParams:function(){var e=this;this.permissionData=[],this.info.forEach((function(t){"2"==t.checked&&e.permissionData.push(t.id),t.children&&t.children.forEach((function(t){"2"==t.checked&&e.permissionData.push(t.id),t.children&&t.children.forEach((function(t){"2"==t.checked&&e.permissionData.push(t.id),t.children&&t.children.forEach((function(t){"2"==t.checked&&e.permissionData.push(t.id),t.children&&t.children.forEach((function(t){"2"==t.checked&&e.permissionData.push(t.id)}))}))}))}))}))},submit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.dealParams(),n=e.roleId,a=e.permissionData,a&&0!=a.length){t.next=5;break}return e.$message.warn("请设置权限"),t.abrupt("return");case 5:return t.prev=5,e.loading=!0,t.next=9,Object(o["e"])({roleId:n,menuIds:a});case 9:e.loading=!1,e.cancel(),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),e.loading=!1;case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))()}}},s=c,l=(n("9c581"),n("2877")),u=Object(l["a"])(s,a,r,!1,null,"0babe68c",null);t["default"]=u.exports},5764:function(e,t,n){},"6c35":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-card",{attrs:{title:"数据筛选"}},[n("a-row",[n("a-col",{attrs:{span:6}},[n("a-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("a-col",{attrs:{span:6,offset:1}},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@search",expression:"'/role/index@search'"}],staticStyle:{marginRight:"10px"},attrs:{type:"primary"},on:{click:e.searchData}},[e._v("查询")]),n("a-button",{on:{click:e.reset}},[e._v("重置")])],1)],1),n("div",{staticClass:"table-wrapper"},[n("div",{staticClass:"top-btn"},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@add",expression:"'/role/index@add'"}],staticClass:"batch",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1),n("a-table",{attrs:{bordered:"",rowKey:"roleId",columns:e.columns,"data-source":e.tableData,pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"employeeNum",fn:function(t,a){return n("div",{},[[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@checkMember",expression:"'/role/index@checkMember'"}],attrs:{type:"link"},on:{click:function(t){return e.showMemberData(a.roleId)}}},[e._v(e._s(t))])]],2)}},{key:"status",fn:function(t,a){return n("div",{},[[n("a-checkbox",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@use",expression:"'/role/index@use'"}],attrs:{checked:e.judgeChecked(t)},on:{change:function(t){return e.checkChange(t,a)}}})]],2)}},{key:"action",fn:function(t,a){return n("div",{},[[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/permissionShow",expression:"'/role/permissionShow'"}],attrs:{type:"link"},on:{click:function(t){return e.detail(a.roleId)}}},[e._v("设置权限")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@edit",expression:"'/role/index@edit'"}],attrs:{type:"link"},on:{click:function(t){return e.edit(a.roleId)}}},[e._v("编辑")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@copy",expression:"'/role/index@copy'"}],attrs:{type:"link"},on:{click:function(t){return e.copyRole(a)}}},[e._v("复制权限")]),0==a.employeeNum?n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/role/index@delete",expression:"'/role/index@delete'"}],attrs:{type:"link"},on:{click:function(t){return e.deleteRole(a.roleId)}}},[e._v("删除")]):e._e()]],2)}}])})],1)],1),n("a-modal",{attrs:{title:"角色信息",maskClosable:!1,width:600,visible:e.roleInfoShow,"confirm-loading":e.confirmLoading},on:{ok:e.roleSubmit,cancel:function(t){e.roleInfoShow=!1}}},[n("a-form-model",{ref:"ruleForm",attrs:{"label-col":{span:4},"wrapper-col":{span:20},model:e.formData,rules:e.rules}},[n("div",{staticClass:"name"},[n("span",{staticClass:"star"},[e._v("*")]),n("a-form-model-item",{staticClass:"form-item",attrs:{label:"角色名称",prop:"name"}},[n("a-input",{staticClass:"input",attrs:{maxLength:8,placeholder:"请输入角色名称"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),n("a-form-model-item",{attrs:{label:"角色描述"}},[n("a-textarea",{staticClass:"input",attrs:{placeholder:"请输入角色描述",rows:4},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1),n("a-form-model-item",{attrs:{label:"部门数据全览"}},[n("a-radio-group",{model:{value:e.dataPermission,callback:function(t){e.dataPermission=t},expression:"dataPermission"}},[n("a-radio",{attrs:{value:1}},[e._v(" 是 ")]),n("a-radio",{attrs:{value:2}},[e._v(" 否 ")])],1)],1)],1)],1),n("a-modal",{attrs:{title:"角色人员",maskClosable:!1,width:600,visible:e.memberShow,footer:null},on:{cancel:function(t){e.memberShow=!1}}},[n("a-table",{attrs:{bordered:"",rowKey:"employeeId",columns:e.memberColumns,"data-source":e.memberData,pagination:e.memberPagination},on:{change:e.handleMemberChange}})],1)],1)},r=[],i=n("1da1"),o=(n("96cf"),n("b0c0"),n("ac1f"),n("841c"),n("a9e3"),n("cc5e")),c=[{title:"角色名称",dataIndex:"name"},{title:"角色人员",dataIndex:"employeeNum",scopedSlots:{customRender:"employeeNum"}},{title:"角色描述",dataIndex:"remarks",ellipsis:!0},{title:"更新时间",dataIndex:"updatedAt"},{title:"启用",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],s=[{title:"姓名",dataIndex:"employeeName"},{title:"手机号码",dataIndex:"phone"},{title:"邮箱地址",dataIndex:"email"},{title:"部门",dataIndex:"department"}],l={data:function(){var e=this,t=function(e,t,n){if(!t)return e(new Error(n));e()},n=function(e,t){return{validator:e,trigger:t||"blur"}},a=function(n,a,r){a=e.name,t(r,a,"请输入角色名称")};return{columns:c,memberColumns:s,tableData:[],pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},search:"",roleInfoShow:!1,formData:{},name:"",remarks:"",dataPermission:"",rules:{name:n(a,"change")},roleInfoType:"add",copyRoleId:"",editRoleId:"",memberShow:!1,memberData:[],memberId:"",memberPagination:{total:0,current:1,pageSize:10},confirmLoading:!1}},watch:{roleInfoShow:function(e){e||(this.name="",this.remarks="",this.dataPermission="")}},created:function(){this.getTableData()},methods:{handleTableChange:function(e){var t=e.current,n=e.pageSize;this.pagination.current=t,this.pagination.pageSize=n,this.getTableData()},handleMemberChange:function(e){var t=e.current,n=e.pageSize;this.memberPagination.current=t,this.memberPagination.pageSize=n,this.getMemberData()},searchData:function(){this.pagination.current=1,this.getTableData()},getTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={name:e.search,page:e.pagination.current,perPage:e.pagination.pageSize},t.prev=1,t.next=4,Object(o["c"])(n);case 4:a=t.sent,r=a.data,i=r.page.total,c=r.list,e.pagination.total=Number(i),e.tableData=c,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:case"end":return t.stop()}}),t,null,[[1,12]])})))()},statusChange:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(o["i"])(e);case 3:t.getTableData(),n.next=8;break;case 6:n.prev=6,n.t0=n["catch"](0);case 8:case"end":return n.stop()}}),n,null,[[0,6]])})))()},checkChange:function(e,t){var n=t.roleId,a=t.status,r=t.employeeNum;1==a?r>0?this.$message.warn("此角色不可以禁用"):(this.statusChange({roleId:n,status:2}),this.$message.success("角色已禁用")):(this.statusChange({roleId:n,status:1}),this.$message.success("角色已启用"))},judgeChecked:function(e){return 1==e},detail:function(e){this.$router.push({path:"/role/permissionShow",query:{roleId:e}})},showMemberData:function(e){this.memberShow=!0,this.memberId=e,this.getMemberData()},getMemberData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={roleId:e.memberId,page:e.memberPagination.current,perPage:e.memberPagination.pageSize},t.prev=1,t.next=4,Object(o["f"])(n);case 4:a=t.sent,r=a.data,i=r.page.total,c=r.list,e.memberPagination.total=Number(i),e.memberData=c,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:case"end":return t.stop()}}),t,null,[[1,12]])})))()},reset:function(){this.search=""},add:function(){this.roleInfoType="add",this.roleInfoShow=!0},edit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.roleInfoType="edit",t.roleInfoShow=!0,t.editRoleId=e,n.next=5,Object(o["b"])({roleId:e});case 5:a=n.sent,r=a.data,i=r.name,c=r.remarks,s=r.dataPermission,t.name=i,t.remarks=c,t.dataPermission=s;case 13:case"end":return n.stop()}}),n)})))()},copyRole:function(e){this.copyRoleId=e.roleId,this.roleInfoShow=!0,this.roleInfoType="copy"},deleteRole:function(e){var t=this;this.$confirm({title:"提示",content:"确认删除此角色吗？",onOk:function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(o["a"])({roleId:e});case 3:t.getTableData(),n.next=8;break;case 6:n.prev=6,n.t0=n["catch"](0);case 8:case"end":return n.stop()}}),n,null,[[0,6]])})));function a(){return n.apply(this,arguments)}return a}(),onCancel:function(){}})},roleSubmit:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=33;break}if(t.prev=1,a="",r={name:e.name,remarks:e.remarks,dataPermission:e.dataPermission},e.confirmLoading=!0,"add"!=e.roleInfoType){t.next=11;break}return t.next=8,Object(o["g"])(r);case 8:a="添加成功",t.next=22;break;case 11:if("copy"!=e.roleInfoType){t.next=18;break}return r.roleId=e.copyRoleId,t.next=15,Object(o["g"])(r);case 15:a="复制成功",t.next=22;break;case 18:return r.roleId=e.editRoleId,t.next=21,Object(o["h"])(r);case 21:a="修改成功";case 22:e.$message.success(a),e.roleInfoShow=!1,e.confirmLoading=!1,e.getTableData(),t.next=31;break;case 28:t.prev=28,t.t0=t["catch"](1),e.confirmLoading=!1;case 31:t.next=34;break;case 33:return t.abrupt("return",!1);case 34:case"end":return t.stop()}}),t,null,[[1,28]])})));return function(e){return t.apply(this,arguments)}}())}}},u=l,d=(n("8491"),n("2877")),h=Object(d["a"])(u,a,r,!1,null,"6c57784e",null);t["default"]=h.exports},"768a":function(e,t,n){},8491:function(e,t,n){"use strict";n("5764")},"9c581":function(e,t,n){"use strict";n("768a")},b352:function(e,t,n){},cc5e:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"i",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return h}));var a=n("b775");function r(e){return Object(a["b"])({url:"/role/index",method:"get",params:e})}function i(e){return Object(a["b"])({url:"/role/statusUpdate",method:"put",data:e})}function o(e){return Object(a["b"])({url:"/role/store",method:"post",data:e})}function c(e){return Object(a["b"])({url:"/role/update",method:"put",data:e})}function s(e){return Object(a["b"])({url:"/role/destroy",method:"delete",data:e})}function l(e){return Object(a["b"])({url:"/role/show",method:"get",params:e})}function u(e){return Object(a["b"])({url:"/role/showEmployee",method:"get",params:e})}function d(e){return Object(a["b"])({url:"/role/permissionShow",method:"get",params:e})}function h(e){return Object(a["b"])({url:"/role/permissionStore",method:"post",data:e})}},d37a:function(e,t,n){},e639:function(e,t,n){"use strict";n("b352")},f833:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-card",{attrs:{title:"数据筛选"}},[n("a-row",[n("a-col",{attrs:{span:6}},[n("a-input",{attrs:{placeholder:"请输入"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1),n("a-col",{attrs:{span:6,offset:1}},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/menu/index@search",expression:"'/menu/index@search'"}],staticStyle:{marginRight:"10px"},attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")]),n("a-button",{on:{click:e.reset}},[e._v("重置")])],1)],1),n("div",{staticClass:"table-wrapper"},[n("div",{staticClass:"top-btn"},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/menu/index@add",expression:"'/menu/index@add'"}],staticClass:"batch",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1),n("a-table",{attrs:{bordered:"",rowKey:"menuId",columns:e.columns,"data-source":e.tableData,pagination:e.pagination,indentSize:0,expandIconColumnIndex:7,expandIcon:e.expandIcon},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"icon",fn:function(t){return n("div",{staticClass:"icon"},[[t?n("a-icon",{attrs:{type:t}}):e._e()]],2)}},{key:"levelName",fn:function(t,a){return n("div",{staticClass:"icon"},[[n("div",{class:["text",e.levelNum(a.level)]},[e._v(e._s(t))])]],2)}},{key:"status",fn:function(t){return n("div",{staticClass:"icon"},[[n("div",{staticClass:"text"},[e._v(e._s("1"==t?"启用":"禁用"))])]],2)}},{key:"action",fn:function(t,a){return n("div",{staticClass:"action"},[[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/menu/index@edit",expression:"'/menu/index@edit'"}],attrs:{type:"link"},on:{click:function(t){return e.edit(a.menuId)}}},[e._v("编辑")])]],2)}}])})],1)],1),n("a-modal",{attrs:{title:e.menuShowTitle,maskClosable:!1,width:500,visible:e.menuShow},on:{cancel:function(t){e.menuShow=!1}}},[n("a-form-model",{ref:"ruleForm",staticClass:"form",attrs:{"label-col":{span:7},"wrapper-col":{span:14},model:e.formData,rules:e.rules}},["add"==e.menuShowType?n("div",[n("a-form-model-item",{key:"1",attrs:{label:"菜单级别",prop:"level"}},[n("a-select",{model:{value:e.level,callback:function(t){e.level=t},expression:"level"}},e._l(e.levelList,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),e.level>1?n("a-form-model-item",{key:"2",attrs:{label:"一级菜单",prop:"firstMenuId"}},[n("a-select",{on:{change:e.firstMenuChange},model:{value:e.firstMenuId,callback:function(t){e.firstMenuId=t},expression:"firstMenuId"}},e._l(e.firstMenuList,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.menuId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),e.level>2?n("a-form-model-item",{key:"3",attrs:{label:"二级菜单",prop:"secondMenuId"}},[n("a-select",{attrs:{disabled:!e.firstMenuId},on:{change:e.secondMenuChange},model:{value:e.secondMenuId,callback:function(t){e.secondMenuId=t},expression:"secondMenuId"}},e._l(e.secondMenuList,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.menuId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),e.level>3?n("a-form-model-item",{key:"4",attrs:{label:"三级菜单",prop:"thirdMenuId"}},[n("a-select",{attrs:{disabled:!e.secondMenuId},on:{change:e.thirdMenuChange},model:{value:e.thirdMenuId,callback:function(t){e.thirdMenuId=t},expression:"thirdMenuId"}},e._l(e.thirdMenuList,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.menuId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),e.level>4?n("a-form-model-item",{key:"5",attrs:{label:"四级菜单",prop:"fourthMenuId"}},[n("a-select",{attrs:{disabled:!e.thirdMenuId},on:{change:e.fourthMenuChange},model:{value:e.fourthMenuId,callback:function(t){e.fourthMenuId=t},expression:"fourthMenuId"}},e._l(e.fourthMenuList,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.menuId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e()],1):e._e(),n("a-form-model-item",{key:"6",attrs:{label:"名称",prop:"name"}},[n("a-input",{attrs:{maxLength:10,placeholder:"请输入"},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}})],1),e.level<4?n("a-form-model-item",{key:"7",attrs:{label:"图标"}},[e.icon?n("a-icon",{attrs:{type:e.icon}}):e._e(),n("a-button",{attrs:{type:"link"},on:{click:function(t){e.iconShow=!0}}},[e._v("选择图标")])],1):e._e(),e.level>2?n("a-form-model-item",{key:"8",attrs:{label:"地址",prop:"linkUrl"}},[n("a-input",{attrs:{placeholder:"请输入"},model:{value:e.linkUrl,callback:function(t){e.linkUrl="string"===typeof t?t.trim():t},expression:"linkUrl"}})],1):e._e(),e.level>2?n("a-form-model-item",{key:"9",attrs:{label:"链接类型",prop:"linkType"}},[n("a-radio-group",{model:{value:e.linkType,callback:function(t){e.linkType=t},expression:"linkType"}},[n("a-radio",{attrs:{value:1}},[e._v(" 内部链接 ")]),n("a-radio",{attrs:{value:2}},[e._v(" 外部链接 ")])],1)],1):e._e(),e.level>3?n("a-form-model-item",{key:"11",attrs:{label:"页面权限",prop:"isPageMenu"}},[n("a-radio-group",{model:{value:e.isPageMenu,callback:function(t){e.isPageMenu=t},expression:"isPageMenu"}},[n("a-radio",{attrs:{value:1}},[e._v(" 是 ")]),n("a-radio",{attrs:{value:2}},[e._v(" 否 ")])],1)],1):e._e(),e.level>3&&2==e.isPageMenu?n("a-form-model-item",{key:"10",attrs:{label:"数据权限",prop:"dataPermission"}},[n("a-radio-group",{model:{value:e.dataPermission,callback:function(t){e.dataPermission=t},expression:"dataPermission"}},[n("a-radio",{attrs:{value:1}},[e._v(" 启用 ")]),n("a-radio",{attrs:{value:2}},[e._v(" 不启用 ")])],1)],1):e._e()],1),n("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[[n("a-button",{attrs:{type:"link",loading:e.loading},on:{click:e.submit}},[e._v(" 确认 ")]),"edit"==e.menuShowType&&"2"==e.status?n("a-button",{attrs:{type:"link",loading:e.loading},on:{click:e.remove}},[e._v(" 移除 ")]):e._e(),"edit"==e.menuShowType?n("a-button",{attrs:{type:"link",loading:e.loading},on:{click:e.forbid}},[e._v(" "+e._s("1"==e.status?"禁用":"启用")+" ")]):e._e(),n("a-button",{attrs:{type:"link"},on:{click:function(t){e.menuShow=!1}}},[e._v(" 取消 ")])]],2)],1),n("a-modal",{attrs:{title:"选择图标",maskClosable:!1,width:800,visible:e.iconShow},on:{cancel:function(t){e.iconShow=!1}}},[n("icon-selector",{attrs:{usedIconList:e.usedIconList},on:{change:e.handleIconChange},model:{value:e.currentSelectedIcon,callback:function(t){e.currentSelectedIcon=t},expression:"currentSelectedIcon"}}),n("div",{attrs:{slot:"footer"},slot:"footer"},[[n("a-button",{on:{click:e.chooseIcon}},[e._v("确定")])]],2)],1)],1)},r=[],i=n("1da1"),o=(n("96cf"),n("b0c0"),n("a9e3"),n("7db0"),n("d3b7"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.prefixCls},[n("ul",e._l(e.icons,(function(t,a){return n("li",{key:a,class:{active:e.selectedIcon==t,disabled:e.usedIconList.indexOf(t)>-1},on:{click:function(n){return e.handleSelectedIcon(t)}}},[n("a-icon",{style:{fontSize:"20px"},attrs:{type:t}})],1)})),0)])}),c=[],s=["lock","unlock","bars","book","calendar","cloud","cloud-download","code","copy","credit-card","delete","desktop","download","ellipsis","file","file-text","file-unknown","file-pdf","file-word","file-excel","file-jpg","file-ppt","file-markdown","file-add","folder","folder-open","folder-add","hdd","frown","meh","smile","inbox","laptop","appstore","link","mail","mobile","notification","paper-clip","picture","poweroff","reload","search","setting","share-alt","shopping-cart","tablet","tag","tags","to-top","upload","user","video-camera","home","loading","loading-3-quarters","cloud-upload","star","heart","environment","eye","camera","save","team","solution","phone","filter","exception","export","customer-service","qrcode","scan","like","dislike","message","pay-circle","calculator","pushpin","bulb","select","switcher","rocket","bell","disconnect","database","compass","barcode","hourglass","key","flag","layout","printer","sound","usb","skin","tool","sync","wifi","car","schedule","user-add","user-delete","usergroup-add","usergroup-delete","man","woman","shop","gift","idcard","medicine-box","red-envelope","coffee","copyright","trademark","safety","wallet","bank","trophy","contacts","global","shake","api","fork","dashboard","table","profile","alert","audit","branches","build","border","crown","experiment","fire","money-collect","property-safety","read","reconciliation","rest","security-scan","insurance","interaction","safety-certificate","project","thunderbolt","block","cluster","deployment-unit","dollar","euro","pound","file-done","file-exclamation","file-protect","file-search","file-sync","gateway","gold","robot","shopping","question","question-circle","plus","plus-circle","pause","pause-circle","minus","minus-circle","plus-square","minus-square","info","info-circle","exclamation","exclamation-circle","close","close-circle","close-square","check","check-circle","check-square","clock-circle","warning","issues-close","stop","android","apple","windows","ie","chrome","github","aliwangwang","dingding","weibo-square","weibo-circle","taobao-circle","html5","weibo","twitter","wechat","youtube","alipay-circle","taobao","skype","qq","medium-workmark","gitlab","medium","linkedin","google-plus","dropbox","facebook","codepen","code-sandbox","amazon","google","codepen-circle","alipay","ant-design","aliyun","zhihu","slack","slack-square","behance","behance-square","dribbble","dribbble-square","instagram","yuque","alibaba","yahoo","area-chart","pie-chart","bar-chart","dot-chart","line-chart","radar-chart","heat-map","fall","rise","stock","box-plot","fund","sliders","edit","form","copy","scissor","delete","snippets","diff","highlight","align-center","align-left","align-right","bg-colors","bold","italic","underline","strikethrough","redo","undo","zoom-in","zoom-out","font-colors","font-size","line-height","column-height","dash","small-dash","sort-ascending","sort-descending","drag","ordered-list","radius-setting","step-backward","step-forward","fast-backward","fast-forward","shrink","arrows-alt","down","up","left","right","caret-up","caret-down","caret-left","caret-right","up-circle","down-circle","left-circle","right-circle","double-right","double-left","vertical-left","vertical-right","forward","backward","rollback","enter","retweet","swap","swap-left","swap-right","arrow-up","arrow-down","arrow-left","arrow-right","play-circle","up-square","down-square","left-square","right-square","login","logout","menu-fold","menu-unfold","border-bottom","border-horizontal","border-inner","border-left","border-right","border-top","border-verticle","pic-center","pic-left","pic-right","radius-bottomleft","radius-bottomright","radius-upleft","fullscreen","fullscreen-exit"],l={name:"IconSelect",props:{prefixCls:{type:String,default:"ant-pro-icon-selector"},value:{type:String},usedIconList:{type:Array,default:function(){return[]}}},data:function(){return{selectedIcon:this.value||"",currentTab:"directional",icons:s}},watch:{value:function(e){this.selectedIcon=e}},created:function(){},methods:{handleSelectedIcon:function(e){this.usedIconList.indexOf(e)>-1?this.$message.warn("该图标已占用"):(this.selectedIcon=e,this.$emit("change",e))}}},u=l,d=(n("e639"),n("2877")),h=Object(d["a"])(u,o,c,!1,null,"23f2f4d0",null),m=h.exports,f=n("b775");function p(e){return Object(f["b"])({url:"menu/index",method:"get",params:e})}function b(e){return Object(f["b"])({url:"menu/select",method:"get",params:e})}function g(e){return Object(f["b"])({url:"menu/show",method:"get",params:e})}function v(e){return Object(f["b"])({url:"menu/statusUpdate",method:"put",data:e})}function k(e){return Object(f["b"])({url:"menu/destroy",method:"delete",data:e})}function w(e){return Object(f["b"])({url:"menu/store",method:"post",data:e})}function I(e){return Object(f["b"])({url:"menu/update",method:"put",data:e})}function x(e){return Object(f["b"])({url:"menu/iconIndex",method:"get",params:e})}var y=[{title:"序号",dataIndex:"menuPath"},{title:"菜单名称",align:"center",dataIndex:"name"},{title:"菜单级别",align:"center",dataIndex:"levelName",scopedSlots:{customRender:"levelName"}},{title:"菜单图标",dataIndex:"icon",align:"center",scopedSlots:{customRender:"icon"}},{title:"状态",align:"center",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"最后操作人",align:"center",dataIndex:"operateName"},{title:"最后操作时间",align:"center",dataIndex:"updatedAt"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],M={components:{IconSelector:m},data:function(){var e=this,t=function(e,t,n){if(!t)return e(new Error(n));e()},n=function(e,t){return{validator:e,trigger:t||"blur"}},a=function(n,a,r){a=e.level,t(r,a,"请选择菜单级别")},r=function(n,a,r){a=e.firstMenuId,t(r,a,"请选择一级菜单")},i=function(n,a,r){a=e.secondMenuId,t(r,a,"请选择二级菜单")},o=function(n,a,r){a=e.thirdMenuId,t(r,a,"请选择三级菜单")},c=function(n,a,r){a=e.fourthMenuId,t(r,a,"请选择四级菜单")},s=function(n,a,r){a=e.name;var i="请输入名称";e.name.length>10&&(i="名称最多10个字符",a=!1),t(r,a,i)},l=function(n,a,r){a=e.icon,t(r,a,"请选择图标")},u=function(n,a,r){a=e.linkUrl,t(r,a,"请输入地址")},d=function(n,a,r){a=e.linkType,t(r,a,"请选择链接类型")},h=function(n,a,r){a=e.dataPermission,t(r,a,"请选择数据权限")},m=function(n,a,r){a=e.isPageMenu,t(r,a,"请选择是否页面权限")};return{columns:y,tableData:[],pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},searchName:"",menuShow:!1,menuShowType:"",menuShowTitle:"",firstMenuId:"",firstMenuList:[],secondMenuId:"",secondMenuList:[],thirdMenuId:"",thirdMenuList:[],fourthMenuId:"",fourthMenuList:[],menuId:"",name:"",icon:"",linkUrl:"",linkType:"",dataPermission:"",isPageMenu:"",status:"",loading:!1,formData:{},rules:{level:n(a,"change"),firstMenuId:n(r,"change"),secondMenuId:n(i,"change"),thirdMenuId:n(o,"change"),fourthMenuId:n(c,"change"),name:n(s,"change"),icon:n(l,"change"),linkUrl:n(u,"change"),linkType:n(d,"change"),dataPermission:n(h,"change"),isPageMenu:n(m,"change")},level:"",levelList:[{label:"一级菜单",value:"1"},{label:"二级菜单",value:"2"},{label:"三级菜单",value:"3"},{label:"四级菜单",value:"4"},{label:"四级菜单操作",value:"5"}],currentSelectedIcon:"",iconShow:!1,usedIconList:[]}},watch:{menuShow:function(e){e||(this.level="",this.firstMenuId="",this.secondMenuId="",this.thirdMenuId="",this.fourthMenuId="",this.name="",this.icon="",this.linkUrl="",this.linkType="",this.dataPermission="",this.status="",this.currentSelectedIcon="",this.menuId="",this.isPageMenu="",this.loading=!1,this.$refs.ruleForm.clearValidate())},iconShow:function(e){e&&this.getUsedIcon()}},created:function(){this.getMenuOptions(),this.getTableData()},methods:{handleTableChange:function(e){var t=e.current,n=e.pageSize;this.pagination.current=t,this.pagination.pageSize=n,this.getTableData()},getTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={name:e.searchName,page:e.pagination.current,perPage:e.pagination.pageSize},t.prev=1,t.next=4,p(n);case 4:a=t.sent,r=a.data,i=r.page.total,o=r.list,e.pagination.total=Number(i),e.tableData=o,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:case"end":return t.stop()}}),t,null,[[1,12]])})))()},search:function(){this.pagination.current=1,this.getTableData()},edit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.menuShow=!0,t.menuShowType="edit",t.menuShowTitle="编辑菜单",t.menuId=e,n.prev=4,n.next=7,g({menuId:e});case 7:a=n.sent,r=a.data,Object.assign(t,r),t.firstMenuChange(),t.secondMenuChange(),t.thirdMenuChange(),n.next=17;break;case 15:n.prev=15,n.t0=n["catch"](4);case 17:case"end":return n.stop()}}),n,null,[[4,15]])})))()},reset:function(){this.searchName=""},add:function(){this.menuShow=!0,this.menuShowType="add",this.menuShowTitle="添加菜单",this.getMenuOptions()},levelNum:function(e){var t=["","","second","third","fourth","fif"];return t[e]},expandIcon:function(e){var t=this.$createElement;if(e.record.children)return e.record.children.length>0?e.expanded?t("a",{class:"expand-wrapper",on:{click:function(t){e.onExpand(e.record,t)}}},["收起"]):t("a",{class:"expand-wrapper",on:{click:function(t){e.onExpand(e.record,t)}}},["展开"]):void 0},handleIconChange:function(e){this.currentSelectedIcon=e},getUsedIcon:function(){var e=this;x().then((function(t){e.usedIconList=t.data}))},chooseIcon:function(){this.icon=this.currentSelectedIcon,this.iconShow=!1},getMenuOptions:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b();case 3:n=t.sent,a=n.data,e.firstMenuList=a,t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})))()},firstMenuChange:function(e){var t=this,n=this.firstMenuList.find((function(e){return e.menuId==t.firstMenuId}));this.secondMenuList=n&&n.children||[]},secondMenuChange:function(e){var t=this,n=this.secondMenuList.find((function(e){return e.menuId==t.secondMenuId}));this.thirdMenuList=n&&n.children||[]},thirdMenuChange:function(e){var t=this,n=this.thirdMenuList.find((function(e){return e.menuId==t.thirdMenuId}));this.fourthMenuList=n&&n.children||[]},fourthMenuChange:function(e){},submit:function(){var e=this,t=["0",{firstMenuId:this.firstMenuId},{firstMenuId:this.firstMenuId,secondMenuId:this.secondMenuId},{firstMenuId:this.firstMenuId,secondMenuId:this.secondMenuId,thirdMenuId:this.thirdMenuId},{firstMenuId:this.firstMenuId,secondMenuId:this.secondMenuId,thirdMenuId:this.thirdMenuId,fourthMenuId:this.fourthMenuId}],n={level:this.level,name:this.name,icon:this.icon,linkUrl:this.linkUrl,linkType:this.linkType};this.level>1&&(Object.assign(n,t[this.level-1]),this.level>3&&(Object.assign(n,{isPageMenu:this.isPageMenu}),2==this.isPageMenu&&Object.assign(n,{dataPermission:this.dataPermission}))),this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=22;break}if(e.loading=!0,t.prev=2,"add"!=e.menuShowType){t.next=11;break}return t.next=6,w(n);case 6:e.menuShow=!1,e.$message.success("添加成功"),e.getTableData(),t.next=17;break;case 11:return n.menuId=e.menuId,t.next=14,I(n);case 14:e.menuShow=!1,e.$message.success("修改成功"),e.getTableData();case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](2),e.loading=!1;case 22:case"end":return t.stop()}}),t,null,[[2,19]])})));return function(e){return t.apply(this,arguments)}}())},remove:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k({menuId:e.menuId});case 3:e.menuShow=!1,e.getTableData(),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))()},forbid:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return["",e.firstMenuList,e.secondMenuList,e.thirdMenuList,e.fourthMenuList],n={menuId:e.menuId,status:"1"==e.status?"2":"1"},t.prev=2,t.next=5,v(n);case 5:e.menuShow=!1,e.getTableData(),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})))()}}},_=M,S=(n("2185"),Object(d["a"])(_,a,r,!1,null,"fab3b7d0",null));t["default"]=S.exports}}]);