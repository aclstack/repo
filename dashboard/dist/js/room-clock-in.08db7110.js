(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room-clock-in"],{"1b86":function(t,a,s){},"359c":function(t,a,s){"use strict";s("c95f")},"3a21":function(t,a,s){"use strict";s("b6f7")},"4ca1":function(t,a,s){},"50be":function(t,a,s){"use strict";s("de23")},6521:function(t,a,s){"use strict";s("4ca1")},"734c":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"create"},[s("a-card",[s("div",{staticClass:"block"},[s("div",{staticClass:"title"},[t._v("修改打卡任务")]),s("div",{staticClass:"activity-name interval"},[s("span",{staticClass:"name required"},[t._v("打卡活动名称：")]),s("a-input",{attrs:{placeholder:"请输入打卡名称"},model:{value:t.taskForm.name,callback:function(a){t.$set(t.taskForm,"name",a)},expression:"taskForm.name"}})],1),s("div",{staticClass:"activity-description interval"},[s("span",{staticClass:"description required"},[t._v("打卡活动说明：")]),s("a-textarea",{attrs:{placeholder:"打卡活动说明",rows:5},model:{value:t.taskForm.description,callback:function(a){t.$set(t.taskForm,"description",a)},expression:"taskForm.description"}})],1),s("div",{staticClass:"punch-type interval"},[s("span",{staticClass:"type required"},[t._v("选择打卡类型：")]),s("div",{staticClass:"radio"},[s("a-radio-group",{attrs:{name:"radioGroup",disabled:!0},model:{value:t.taskForm.type,callback:function(a){t.$set(t.taskForm,"type",a)},expression:"taskForm.type"}},[s("a-radio",{attrs:{value:1}},[t._v("连续打卡")]),s("a-radio",{attrs:{value:2}},[t._v("累积打卡")])],1)],1)]),s("div",{staticClass:"task-setting interval"},[s("span",{staticClass:"setting required"},[t._v("打卡任务设置：")]),s("div",{staticClass:"task"},[s("div",{staticClass:"task-padding"},t._l(t.tagList,(function(a,e){return s("div",{key:e,staticClass:"task-content"},[t._v(" 第 "+t._s(e+1)+" 阶段任务：用户"),1==t.taskForm.type?s("span",[t._v("连续")]):s("span",[t._v("累计")]),t._v("打卡 "),s("a-input",{staticClass:"day",attrs:{disabled:!0},model:{value:a.count,callback:function(s){t.$set(a,"count",s)},expression:"item.count"}}),t._v(" 天，即可领取 "),s("a-input",{staticClass:"award-name",attrs:{placeholder:"输入奖励名称",disabled:!0},model:{value:a.prize,callback:function(s){t.$set(a,"prize",s)},expression:"item.prize"}}),0!=e?s("span",{staticClass:"delete-icon"},[s("a-icon",{attrs:{type:"minus-circle"}})],1):t._e()],1)})),0),s("div",{staticClass:"add-task"},[s("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加任务")],1)])]),s("div",{staticClass:"punch-type interval"},[s("span",{staticClass:"type required"},[t._v("截止日期：")]),s("div",{staticClass:"radio"},[s("a-radio-group",{attrs:{name:"radioGroup"},model:{value:t.taskForm.time_type,callback:function(a){t.$set(t.taskForm,"time_type",a)},expression:"taskForm.time_type"}},[s("a-radio",{attrs:{value:1}},[t._v(" 永久有效 ")]),s("a-radio",{attrs:{value:2}},[t._v(" 自定义活动时间 ")])],1),2===t.taskForm.time_type?s("div",{staticClass:"mt18"},[s("a-range-picker",{on:{change:t.setActivityTime},model:{value:t.showCustomTime,callback:function(a){t.showCustomTime=a},expression:"showCustomTime"}})],1):t._e()],1)]),s("div",{staticClass:"qr-code",staticStyle:{"text-align":"left"}},[s("span",{staticClass:"cus-service required"},[t._v("客服二维码： "),s("span",{staticClass:"notes"},[t._v(" ( 用户完成任务后，联系客服领取奖励 )")])]),s("div",{staticClass:"upload-qc"},[s("m-upload",{ref:"kfQrcode",on:{change:t.uploadImg}})],1)]),s("div",{staticClass:"mb40"},[s("div",{staticClass:"card-box interval"},[s("span",[t._v("企业名片：")]),s("div",{staticClass:"switch"},[s("a-switch",{attrs:{size:"small"},model:{value:t.cardShow,callback:function(a){t.cardShow=a},expression:"cardShow"}})],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.cardShow,expression:"cardShow"}],staticClass:"information"},[s("div",{staticClass:"portrait interval"},[s("div",{staticClass:"corporate-avatar"},[t._v("企业头像：")]),s("div",{staticClass:"upload-two"},[s("m-upload",{ref:"enterpriseHead",on:{change:t.uploadBusinesshead}})],1)]),s("div",{staticClass:"corporate-name"},[s("span",{staticClass:"cr-name interval"},[t._v("企业名称："),s("a-input",{attrs:{placeholder:"请输入企业名称"},model:{value:t.taskForm.corp_card.name,callback:function(a){t.$set(t.taskForm.corp_card,"name",a)},expression:"taskForm.corp_card.name"}})],1)]),s("div",{staticClass:"mb14"},[s("div",{staticClass:"profile-title"},[t._v(" 企业简介： "),s("div",{staticClass:"switch"},[s("a-switch",{attrs:{size:"small"},model:{value:t.profileShow,callback:function(a){t.profileShow=a},expression:"profileShow"}})],1)])]),t.profileShow?s("div",{staticClass:"profile"},[s("a-textarea",{attrs:{placeholder:"请输入企业简介",rows:5},model:{value:t.taskForm.corp_card.description,callback:function(a){t.$set(t.taskForm.corp_card,"description",a)},expression:"taskForm.corp_card.description"}})],1):t._e()])]),s("div",{staticClass:"title"},[t._v("客户设置")]),s("a-alert",{staticClass:"tips",attrs:{message:"企业微信接口限制，仅支持为已添加企业员工的客户打标签",type:"info","show-icon":""}}),s("div",{staticClass:"customer-label interval"},[s("span",{staticClass:"customer-tag"},[t._v("客户标签：")]),s("div",{staticClass:"task-rule"},[s("div",{staticClass:"rule-box"},[s("div",{staticClass:"rule"},[t._v("规则：")]),t._l(t.clientTagList,(function(a,e){return s("div",{key:e,staticClass:"punch-page"},[t._v(" 为 "),s("div",{staticClass:"drop-down"},[""==a.key?[s("a-select",{staticStyle:{width:"130px","margin-left":"5px","margin-right":"5px"},attrs:{placeholder:"选择用户行为",disabled:""},on:{change:function(a){return t.setUserAction(a,e)}}},[s("a-select-option",{attrs:{value:1,disabled:t.selectOption}},[t._v("进入打卡页面")]),s("a-select-option",{attrs:{value:2}},[t._v("设置天数")])],1)]:[1==a.key?s("span",{staticClass:"set_userLable_tips"},[t._v("进入打卡页面")]):s("span",[t._v("打卡 "),s("a-input-number",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{min:1,disabled:""},model:{value:a.count,callback:function(s){t.$set(a,"count",s)},expression:"item.count"}}),t._v("天")],1)]],2),t._v(" 的客户打上 "),s("div",{staticClass:"choiceAdmin"},[0==a.clientTagArr.length?s("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(a.clientTagArr,(function(a,e){return s("a-tag",{key:e},[t._v(" "+t._s(a.name)+" ")])}))],2),s("div",[t._v(" 标签 "),s("a",[s("span",{staticClass:"delete-icon"},[s("a-icon",{attrs:{type:"minus-circle"}})],1)])])])})),s("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],2),s("div",{staticClass:"add-task"},[s("span",{staticStyle:{color:"gray"}},[s("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加任务")],1)])])]),s("div",{staticClass:"create-over"},[s("a-button",{attrs:{type:"primary"},on:{click:t.establishTask}},[t._v("修改打卡任务")])],1)],1)])],1)},i=[],c=s("1da1"),n=(s("96cf"),s("b0c0"),s("a4d3"),s("e01a"),s("d3b7"),s("159b"),s("a434"),s("7728")),r=s("6010"),o=s("c1df"),l=s.n(o),d={components:{addlableIndex:r["a"]},created:function(){this.activityId=this.$route.query.activityId,this.getdetailsData(this.activityId)},data:function(){return{showCustomTime:[],serviceCode:0,selectedList:[],selectOption:!0,visible:!1,tagList:[{count:"",prize:""},{count:"",prize:""}],clientTagList:[{key:1,count:0,tags:[],clientTagArr:[]},{key:"",count:1,tags:[],clientTagArr:[]}],taskForm:{name:"",description:"",time_type:1,type:1,start_time:"",end_time:"",tasks:"",contact_clock_tags:"",point:1,corp_card:{logo:"",name:"",description:""},employee_qrcode:""},value:0,selectInputIndex:0,delSelectlable:0,profileShow:!0,cardShow:!1}},methods:{getdetailsData:function(t){var a=this;Object(n["i"])({id:t}).then((function(t){a.taskForm={name:t.data.name,description:t.data.description,time_type:t.data.timeType,type:t.data.type,start_time:t.data.startTime,end_time:t.data.endTime,tasks:t.data.tasks,contact_clock_tags:t.data.contactClockTags,point:t.data.point,corp_card:t.data.corpCard,employee_qrcode:t.data.employeeQrcode,corp_card_status:t.data.corpCardStatus},a.handlebackData()}))},handlebackData:function(){""!=this.taskForm.start_time&&(this.showCustomTime[0]=l()(this.taskForm.start_time),this.showCustomTime[1]=l()(this.taskForm.end_time)),this.tagList=this.taskForm.tasks,this.clientTagList=this.taskForm.contact_clock_tags,this.$refs.kfQrcode.setUrl(this.taskForm.employee_qrcode),this.taskForm.corp_card&&this.$refs.enterpriseHead.setUrl(this.taskForm.corp_card.logo),this.taskForm.corp_card_status?this.cardShow=!0:this.cardShow=!1,this.taskForm.corp_card.description_status?this.profileShow=!0:this.profileShow=!1},establishTask:function(){var t=this;this.taskForm.id=this.activityId,this.taskForm.tasks=this.tagList,this.taskForm.contact_clock_tags=this.clientTagList;for(var a=0;a<this.taskForm.tasks.length;a++){if(""==this.taskForm.tasks[a].count)return this.$message.warning("打卡天数不能为空"),!1;if(""==this.taskForm.tasks[a].prize)return this.$message.warning("奖励不能为空"),!1}if(""==this.taskForm.employee_qrcode)return this.$message.warning("客服二维码不能为空"),!1;if(2==this.taskForm.time_type){if(""==this.taskForm.time_type)return this.$message.warning("开始时间不能为空"),!1;if(""==this.taskForm.end_time)return this.$message.warning("结束时间不能为空"),!1}if(this.cardShow?this.taskForm.corp_card_status=1:this.taskForm.corp_card_status=0,this.profileShow?this.taskForm.corp_card.description_status=1:this.taskForm.corp_card.description_status=0,1==this.taskForm.corp_card_status){if(""==this.taskForm.corp_card.logo)return this.$message.warning("企业头像不能为空"),!1;if(""==this.taskForm.corp_card.name)return this.$message.warning("企业名称不能为空"),!1;if(1==this.taskForm.corp_card.description_status&&""==this.taskForm.corp_card.description)return this.$message.warning("企业简介不能为空"),!1}Object(n["m"])(this.taskForm).then((function(a){t.$message.success("修改成功"),t.$router.push({path:"/roomClockIn/index"})}))},lableCutto:function(t){var a=this;this.clientTagList[this.selectInputIndex].tags.forEach((function(s,e){s.tagname==t&&a.clientTagList[a.selectInputIndex].tags.splice(e,1)}))},handchange:function(t){this.delSelectlable=t},acceptArray:function(t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var e;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t?(e=[],t.forEach((function(t,s){var i={tagid:"",tagname:""};i.tagid=t.id,i.tagname=t.name,a.clientTagList[a.selectInputIndex].tags.push(i),e[s]=t.name})),a.clientTagList[a.selectInputIndex].clientTagArr=e):(a.clientTagList[a.selectInputIndex].clientTagArr=[],a.clientTagList[a.selectInputIndex].tags=[]);case 1:case"end":return s.stop()}}),s)})))()},showModal:function(t){this.selectInputIndex=t,this.selectedList=this.clientTagList[this.selectInputIndex].clientTagArr,this.$refs.childRef.show()},setUserAction:function(t,a){1==t&&(this.selectOption=!0),this.clientTagList[a].key=t},uploadBusinesshead:function(t){this.taskForm.corp_card.logo=t},uploadImg:function(t){t&&(this.serviceCode<=1?this.serviceCode++:this.taskForm.employee_qrcode=t)},setActivityTime:function(t,a){this.taskForm.start_time=a[0],this.taskForm.end_time=a[1]},delTag:function(t){if(1===this.clientTagList.length)return this.$message.error("不能删除最后一个"),!1;1==this.clientTagList[t].key&&(this.selectOption=!1),this.clientTagList.splice(t,1)},addClinentTag:function(){var t={key:"",count:0,tags:[],clientTagArr:[]};this.clientTagList.forEach((function(a){0==a.count&&(t.count=1)})),this.clientTagList.push(t)},delClock:function(t){this.tagList.splice(t,1)},addClock:function(){if(5===this.tagList.length)return this.$message.error("不能添加五个以上"),!1;this.tagList.push({type:"0",tasg:[]})}}},u=d,p=(s("6521"),s("2877")),m=Object(p["a"])(u,e,i,!1,null,"630f446e",null);a["default"]=m.exports},"827a":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"group-index",staticStyle:{position:"relative"}},[s("a-button",{staticClass:"mb14",attrs:{type:"primary"},on:{click:function(a){return t.$router.push("/roomClockIn/create")}}},[t._v(" 创建打卡活动 ")]),s("div",{staticClass:"switch_account"},[t._v(" 公众号："),s("a-select",{staticStyle:{width:"150px"},model:{value:t.officialAccount,callback:function(a){t.officialAccount=a},expression:"officialAccount"}},t._l(t.publiclist,(function(a,e){return s("a-select-option",{key:e,attrs:{value:a.nickname}},[t._v(" "+t._s(a.nickname)+" ")])})),1)],1),s("a-card",[s("div",{staticClass:"state"},t._l(t.state.list,(function(a,e){return s("a-button",{key:e,attrs:{type:t.state.current===a?"primary":""},on:{click:function(s){return t.stateSwitchClick(a,e)}}},[t._v(" "+t._s(a)+" ")])})),1),s("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"contact_clock_tags",fn:function(a){return s("div",{staticStyle:{"min-width":"200px"}},t._l(a,(function(a,e){return s("div",{key:e,staticClass:"clientTags"},t._l(a,(function(a,e){return s("a-tag",{key:e,staticClass:"label"},[t._v(t._s(a.tagname))])})),1)})),0)}},{key:"nickname",fn:function(a){return s("div",{},[s("a-tag",[s("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(a)+" ")],1)],1)}},{key:"operate",fn:function(a,e){return s("div",{},[s("a",{on:{click:function(a){return t.detailsTableRow(e)}}},[t._v("详情")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{attrs:{href:"#"},on:{click:function(a){return t.shareBtn(e)}}},[t._v("分享")]),s("a-divider",{attrs:{type:"vertical"}}),s("a-dropdown",[s("a",{staticClass:"ant-dropdown-link"},[t._v(" 编辑"),s("a-icon",{attrs:{type:"down"}})],1),s("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[s("a-menu-item",[s("a",{on:{click:function(a){return t.modifyBtn(e)}}},[t._v("修改")])]),s("a-menu-item",[s("a",{on:{click:function(a){return t.delTableRow(e)}}},[t._v("删除")])])],1)],1)],1)}}])}),s("a-modal",{attrs:{title:"分享",maskClosable:!1,footer:null},model:{value:t.visible,callback:function(a){t.visible=a},expression:"visible"}},[s("div",{staticClass:"modeRow"},[s("div",{staticClass:"modeOne"},[s("div",{staticClass:"modeTitle"},[t._v("方式一：")]),s("div",{staticClass:"modeTips"},[t._v("群打卡二维码")]),s("div",{ref:"qrCode",staticClass:"qr-code"})]),s("div",{staticClass:"separate"}),s("div",{staticClass:"modeTwo"},[s("div",{staticClass:"modeTitle"},[t._v("方式二：")]),s("div",{staticClass:"modeTips"},[t._v("群打卡链接")]),s("div",{staticClass:"linkBox"},[t._v(t._s(t.clockInLink))])])]),s("div",{staticClass:"footRow"},[s("a-button",{staticClass:"footBtn",on:{click:t.downQrcode}},[t._v("下载二维码")]),s("a-button",{staticClass:"footBtn",attrs:{type:"primary"},on:{click:t.copyLink}},[t._v("复制打卡链接")])],1)])],1),s("input",{ref:"copyInput",staticClass:"copy-input",attrs:{type:"text"}}),s("warrantTip",{ref:"warrantTip"})],1)},i=[],c=(s("a434"),s("7728")),n=s("d044"),r=s.n(n),o=s("b30d"),l={components:{warrantTip:o["a"]},data:function(){return{publiclist:[],officialAccount:"",clockInLink:"",visible:!1,table:{col:[{key:"name",dataIndex:"name",title:"打卡活动名称"},{key:"contact_clock_tags",dataIndex:"contact_clock_tags",title:"客户标签",scopedSlots:{customRender:"contact_clock_tags"}},{key:"nickname",dataIndex:"nickname",title:"创建人",scopedSlots:{customRender:"nickname"}},{key:"type",dataIndex:"type",title:"类型"},{key:"average_day",dataIndex:"average_day",title:"平均打卡天数"},{key:"total_user",dataIndex:"total_user",title:"总打卡人数"},{key:"created_at",dataIndex:"created_at",title:"创建时间"},{key:"time",dataIndex:"time",title:"活动时间"},{key:"status",dataIndex:"status",title:"状态"},{title:"操作",scopedSlots:{customRender:"operate"}}],data:[]},state:{list:["全部","进行中","未开始","已结束"],current:"全部"},params:{status:0}}},created:function(){this.getListData(),this.setUpPublicName(),this.getPublicList()},methods:{setUpPublicName:function(){var t=this;Object(c["k"])({type:1}).then((function(a){t.officialAccount=a.data.nickname}))},getPublicList:function(){var t=this;Object(c["k"])().then((function(a){t.publiclist=a.data,0==t.publiclist.length&&t.$refs.warrantTip.show()}))},downQrcode:function(){var t=this.$refs.qrCode.childNodes[1],a=document.createElement("a"),s=new MouseEvent("click");a.download="qrcode",a.href=t.src,a.dispatchEvent(s)},copyLink:function(){var t=this.$refs.copyInput;t.value=this.clockInLink,t.select(),document.execCommand("Copy"),this.$message.success("复制成功")},shareBtn:function(t){var a=this;this.visible=!0,this.clockInLink=t.share_link,setTimeout((function(){a.initQrcode(t.share_link)}),200)},initQrcode:function(t){this.$refs.qrCode.innerHTML="",new r.a(this.$refs.qrCode,{text:t,width:122,height:122})},stateSwitchClick:function(t,a){this.state.current=t,this.params.status=a,this.getListData()},detailsTableRow:function(t){this.$router.push("/roomClockIn/show?activityId="+t.id)},modifyBtn:function(t){this.$router.push("/roomClockIn/edit?activityId="+t.id)},delTableRow:function(t){var a=this;this.$confirm({title:"提示",content:"是否删除？",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){var s=a.table.data.indexOf(t);a.table.data.splice(s,1),Object(c["f"])({id:t.id}).then((function(t){a.$message.success("删除成功")}))}})},getListData:function(){var t=this;Object(c["h"])(this.params).then((function(a){t.table.data=a.data.list}))}}},d=l,u=(s("50be"),s("2877")),p=Object(u["a"])(d,e,i,!1,null,null,null);a["default"]=p.exports},a752:function(t,a,s){"use strict";s("1b86")},b30d:function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("a-modal",{attrs:{title:"设置公众号",footer:null,maskClosable:!1,closable:!1},model:{value:t.warrantTip,callback:function(a){t.warrantTip=a},expression:"warrantTip"}},[s("p",[t._v("设置授权公众号后可完整使用功能，可通过公众号授权收集客户信息和客户行为记录")]),s("div",{staticClass:"warrant_row"},[s("h3",[t._v("提示：")]),s("p",[t._v("1.公众号类型必须为认证服务号")]),s("p",[t._v("2.公众号需绑定在企业的微信开放平台")])]),s("div",{staticStyle:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},[s("a-button",{attrs:{type:"primary"},on:{click:t.empowerAccount}},[t._v("授权公众号")])],1)])],1)},i=[],c={data:function(){return{warrantTip:!1}},methods:{show:function(){this.warrantTip=!0},empowerAccount:function(){this.$router.push({path:"/officialAccount/index"})}}},n=c,r=(s("a752"),s("2877")),o=Object(r["a"])(n,e,i,!1,null,"92020822",null);a["a"]=o.exports},b6f7:function(t,a,s){},c503:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content-top mt16"},[s("a-card",[s("div",{staticClass:"details-box"},[s("div",{staticClass:"title"},[s("span",[t._v("群打卡信息")]),s("span",[t._v("数据统计")])]),s("div",{staticClass:"details-content"},[s("div",{staticClass:"details-left"},[s("div",{staticClass:"preview elastic"},[s("span",[t._v("打卡任务名称：")]),s("div",{staticClass:"preview-box"},[s("span",{staticClass:"news"},[t._v(t._s(t.clockInData.name))])])]),s("div",{staticClass:"activity mt20 elastic"},[s("span",[t._v(" 打卡任务说明： ")]),s("div",{staticClass:"activity-name"},[s("span",{staticClass:"news"},[t._v(t._s(t.clockInData.description))])])]),s("div",{staticClass:"founder mt16 elastic"},[s("span",[t._v(" 创建人：")]),s("a-tag",[s("a-icon",{attrs:{type:"user"}}),t._v(t._s(t.clockInData.nickname))],1)],1),s("div",{staticClass:"creation-time mt16 elastic"},[s("span",[t._v("创建时间:")]),s("div",{staticClass:"time ml8"},[s("span",{staticClass:"news"},[t._v(t._s(t.clockInData.createdAt))])])]),s("div",{staticClass:"end-date mt16 elastic"},[s("span",[t._v("截止时间：")]),s("span",{staticClass:"news"},[t._v(" "+t._s(t.clockInData.time)+" ")])]),s("div",{staticClass:"tag mt16 elastic"},[s("span",[t._v("客户标签：")])]),t._l(t.clockInData.contactClockTags,(function(a,e){return s("div",{key:e,staticStyle:{"margin-top":"10px"}},t._l(a,(function(a,e){return s("a-tag",{key:e},[t._v(t._s(a.tagname))])})),1)})),s("div",{staticClass:"type mt16 elastic"},[s("span",[t._v("活动类型：")]),s("span",{staticClass:"news"},[t._v(t._s(t.clockInData.type))])]),s("div",{staticClass:"num mt16 elastic"},[s("span",[t._v("打卡任务数量：")]),s("span",{staticClass:"news"},[t._v(t._s(t.clockInData.task_count))])])],2),s("div",{staticClass:"details-right"},[s("div",{staticClass:"data-box"},[s("div",{staticClass:"data mt15"},[s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(t._s(t.statisticsData.today_user))]),s("div",{staticClass:"desc"},[t._v("今日打卡人数")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(t._s(t.statisticsData.total_user))]),s("div",{staticClass:"desc"},[t._v(" 总打卡人数 ")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(t._s(t.statisticsData.average_day))]),s("div",{staticClass:"desc"},[t._v("平均打卡天数")])])])])])])])]),s("a-card",{staticClass:"mt16"},[s("div",{staticClass:"data-details"},[s("div",{staticClass:"title"},[t._v("数据详情")]),s("div",{staticClass:"tag-btn"},[s("div",{staticClass:"state"},t._l(t.state.list,(function(a,e){return s("a-button",{key:e,attrs:{type:t.state.current===a?"primary":""},on:{click:function(s){return t.stateSwitchClick(a,e)}}},[t._v(" "+t._s(a)+" ")])})),1),s("div",{staticClass:"button"},[s("a-tag",{attrs:{color:"blue"}},[t._v("企业微信接口限制，仅支持为已添加企业员工的客户打标签")]),s("div",{staticStyle:{"margin-top":"10px","text-align":"right"}},[s("a-button",{attrs:{type:"primary",ghost:""},on:{click:t.batchTag}},[t._v("批量打标签")])],1)],1),s("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1),s("div",{staticClass:"search-box"},[s("div",{staticClass:"search"},[s("div",{staticClass:"shop-name"},[t._v(" 搜索客户： "),s("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入客户名称"},on:{search:t.searchClient,change:function(a){return t.emptyInput(1)}},model:{value:t.paramData.nickname,callback:function(a){t.$set(t.paramData,"nickname",a)},expression:"paramData.nickname"}})],1),s("div",{staticClass:"shopkeeper ml30"},[t._v(" 打卡天数筛选："),s("a-input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入打卡天数"},on:{pressEnter:t.searchDay,change:function(a){return t.emptyInput(2)}},model:{value:t.paramData.total_day,callback:function(a){t.$set(t.paramData,"total_day",a)},expression:"paramData.total_day"}})],1),s("div",{staticClass:"city ml30"},[t._v(" 城市： "),s("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择城市","option-label-prop":"label"},on:{change:function(a){return t.selectInput(a)}},model:{value:t.paramData.city,callback:function(a){t.$set(t.paramData,"city",a)},expression:"paramData.city"}},t._l(t.optionCity,(function(a,e){return s("a-select-option",{key:e,attrs:{value:a.city,label:a.city}},[t._v(t._s(a.city))])})),1)],1)]),s("div",{staticClass:"reset ml200"},[s("a-button",{on:{click:t.resetBtn}},[t._v("重置")])],1)]),s("div",{staticClass:"data-table"},[s("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},scopedSlots:t._u([{key:"nickname",fn:function(a,e){return s("div",{},[""!=e.avatar?s("img",{staticClass:"user_img",attrs:{src:e.avatar,alt:""}}):t._e(),t._v(" "+t._s(a)+" ")])}},{key:"employees",fn:function(a){return s("div",{},t._l(a,(function(a,e){return s("a-tag",{key:e},[s("a-icon",{attrs:{type:"user"}}),t._v(t._s(a.name))],1)})),1)}},{key:"contact_clock_tags",fn:function(a){return s("div",{},t._l(a,(function(a,e){return s("a-tag",{key:e},[t._v(t._s(a))])})),1)}},{key:"operate",fn:function(a,e){return s("div",{},[s("a",{on:{click:function(a){return t.seeTableRow(e)}}},[t._v("查看详情")])])}}])}),s("a-modal",{attrs:{title:"详细打卡天数",footer:null,maskClosable:!1},model:{value:t.signInDetails,callback:function(a){t.signInDetails=a},expression:"signInDetails"}},[s("div",{staticClass:"details_row",staticStyle:{display:"flex"}},[s("div",[s("div",{staticClass:"title_totalclockIn"},[t._v("总打卡天数：")]),s("div",{staticClass:"totalclockIn_day"},[s("span",[t._v(t._s(t.userSignData.total_day))]),t._v("天")])]),s("div",{staticClass:"separate"}),s("div",[s("div",{staticClass:"totalclockIn_right"},[t._v("参与打卡时间："),s("span",[t._v(t._s(t.userSignData.start_time))])]),s("div",{staticClass:"totalclockIn_right"},[t._v("最近打卡时间："),s("span",[t._v(t._s(t.userSignData.end_time))])])])]),s("div",{staticClass:"details_row"},[s("div",{staticClass:"series_clockIn_title"},[t._v("连续打卡任务:")]),s("div",{staticClass:"taskRowTips"},t._l(t.userSignData.task,(function(a,e){return s("a-tag",{key:e,staticClass:"taskTips"},[t._v(t._s(a))])})),1)]),s("div",{staticClass:"calendar_row"},[s("div",{staticClass:"calendar_box"},[s("Calendar",{attrs:{fullscreen:!1},scopedSlots:t._u([{key:"dateCellRender",fn:function(a){return[t.getDateCellRender(a)?s("div",{staticClass:"events"}):t._e()]}}])})],1)])])],1)])])],1)},i=[],c=(s("420d"),s("3d8c")),n=(s("d3b7"),s("159b"),s("b0c0"),s("7728")),r=s("6010"),o={components:{Calendar:c["a"],addlableIndex:r["a"]},data:function(){return{selectedRowKeys:[],askClientIds:[],userSignData:{},optionCity:[],table:{col:[{key:"nickname",dataIndex:"nickname",title:"全部客户",scopedSlots:{customRender:"nickname"}},{key:"contact_type",dataIndex:"contact_type",title:"客户类型"},{key:"clock_time",dataIndex:"clock_time",title:"最近打卡时间"},{key:"city",dataIndex:"city",title:"城市"},{key:"employees",dataIndex:"employees",title:"所属员工",scopedSlots:{customRender:"employees"}},{key:"contact_clock_tags",dataIndex:"contact_clock_tags",title:"客户标签",scopedSlots:{customRender:"contact_clock_tags"}},{key:"total_day",dataIndex:"total_day",title:"总打卡天数"},{key:"series_day",dataIndex:"series_day",title:"连续打卡天数"},{key:"user_action",dataIndex:"user_action",title:"用户行为"},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]},state:{list:["全部","进入页面未参与","参与打卡未完成","已完成"],current:"全部"},clockInData:{},statisticsData:{},clientName:"",clockInDay:"",selectValue:"",paramData:{page:1,perPage:10,id:2,status:0,nickname:"",total_day:""},signInDetails:!1}},created:function(){this.activityId=this.$route.query.activityId,this.getGroupData(this.activityId),this.paramData.id=this.activityId,this.getTableData(this.paramData)},methods:{onSelectChange:function(t){this.selectedRowKeys=t},batchTag:function(){var t=this;if(0==this.selectedRowKeys.length)return this.$message.warning("请先选中一个客户"),!1;this.askClientIds=[],this.selectedRowKeys.forEach((function(a,s){t.askClientIds[s]=t.table.data[a].id})),this.$refs.childRef.show()},acceptArray:function(t){var a=this;if(0==t.length)return this.$message.error("请至少选择一个标签"),!1;var s=[];t.forEach((function(t,a){var e={};e.tagid=t.id,e.tagname=t.name,s.push(e)})),Object(n["b"])({ids:this.askClientIds,tags:s}).then((function(t){a.getTableData(a.paramData),a.selectedRowKeys=[],a.$message.success("操作成功")}))},getDateCellRender:function(t){var a=t._d.getMonth(),s=this.userSignData.list[a];return-1!=s.indexOf(t.format("YYYY-MM-DD"))},onSelect:function(t){this.value=t,this.selectedValue=t},onPanelChange:function(t){this.value=t},seeTableRow:function(t){var a=this;Object(n["e"])({id:this.activityId,contact_id:t.id}).then((function(t){a.signInDetails=!0,a.userSignData=t.data}))},emptyInput:function(t){1==t?""==this.paramData.nickname&&this.getTableData(this.paramData):2==t&&""==this.paramData.total_day&&this.getTableData(this.paramData)},selectInput:function(t){this.getTableData(this.paramData)},searchClient:function(){this.getTableData(this.paramData)},searchDay:function(){this.getTableData(this.paramData)},resetBtn:function(){var t={page:this.paramData.page,perPage:this.paramData.perPage,id:this.paramData.id,status:this.paramData.status};this.paramData=[],this.paramData=t,this.getTableData(this.paramData)},getGroupData:function(t){var a=this;Object(n["g"])({id:t}).then((function(t){a.optionCity=t.data.city,a.clockInData=t.data.clockIn,a.statisticsData=t.data.data_statistics}))},getTableData:function(t){var a=this;Object(n["c"])(t).then((function(t){a.table.data=t.data.list}))},stateSwitchClick:function(t,a){this.state.current=t,this.paramData.status=a,this.getTableData(this.paramData)}}},l=o,d=(s("3a21"),s("2877")),u=Object(d["a"])(l,e,i,!1,null,"0da2db57",null);a["default"]=u.exports},c95f:function(t,a,s){},de23:function(t,a,s){},efaf:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"create"},[e("a-card",[e("div",{staticClass:"block"},[e("div",{staticClass:"title"},[a._v("创建打卡任务")]),e("div",{staticClass:"activity-name interval"},[e("span",{staticClass:"name required"},[a._v("打卡活动名称：")]),e("a-input",{attrs:{placeholder:"请输入打卡名称"},model:{value:a.taskForm.name,callback:function(t){a.$set(a.taskForm,"name",t)},expression:"taskForm.name"}})],1),e("div",{staticClass:"activity-description interval"},[e("span",{staticClass:"description required"},[a._v("打卡活动说明：")]),e("a-textarea",{attrs:{placeholder:"打卡活动说明",rows:5},model:{value:a.taskForm.description,callback:function(t){a.$set(a.taskForm,"description",t)},expression:"taskForm.description"}})],1),e("div",{staticClass:"punch-type interval"},[e("span",{staticClass:"type required"},[a._v("选择打卡类型：")]),e("div",{staticClass:"radio"},[e("a-radio-group",{attrs:{name:"radioGroup"},model:{value:a.taskForm.type,callback:function(t){a.$set(a.taskForm,"type",t)},expression:"taskForm.type"}},[e("a-radio",{attrs:{value:1}},[a._v("连续打卡")]),e("a-radio",{attrs:{value:2}},[a._v("累积打卡")])],1)],1)]),e("div",{staticClass:"task-setting interval"},[e("span",{staticClass:"setting required"},[a._v("打卡任务设置：")]),e("div",{staticClass:"task"},[e("div",{staticClass:"task-padding"},a._l(a.tagList,(function(t,s){return e("div",{key:s,staticClass:"task-content"},[a._v(" 第 "+a._s(s+1)+" 阶段任务：用户"),1==a.taskForm.type?e("span",[a._v("连续")]):e("span",[a._v("累计")]),a._v("打卡 "),e("a-input-number",{staticClass:"day",staticStyle:{width:"72px"},attrs:{min:1},model:{value:t.count,callback:function(s){a.$set(t,"count",s)},expression:"item.count"}}),a._v(" 天，即可领取 "),e("a-input",{staticClass:"award-name",attrs:{placeholder:"输入奖励名称"},model:{value:t.prize,callback:function(s){a.$set(t,"prize",s)},expression:"item.prize"}}),0!=s?e("span",{staticClass:"delete-icon",on:{click:function(t){return a.delClock(s)}}},[e("a-icon",{attrs:{type:"minus-circle"}})],1):a._e()],1)})),0),e("div",{staticClass:"add-task"},[e("a",{on:{click:a.addClock}},[e("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),a._v("添加任务")],1)])])]),e("div",{staticClass:"punch-type interval"},[e("span",{staticClass:"type required"},[a._v("截止日期：")]),e("div",{staticClass:"radio"},[e("a-radio-group",{attrs:{name:"radioGroup"},model:{value:a.taskForm.time_type,callback:function(t){a.$set(a.taskForm,"time_type",t)},expression:"taskForm.time_type"}},[e("a-radio",{attrs:{value:1}},[a._v(" 永久有效 ")]),e("a-radio",{attrs:{value:2}},[a._v(" 自定义活动时间 ")])],1),2===a.taskForm.time_type?e("div",{staticClass:"mt18"},[e("a-range-picker",{on:{change:a.setActivityTime}})],1):a._e()],1)]),e("div",{staticClass:"qr-code",staticStyle:{"text-align":"left"}},[e("span",{staticClass:"cus-service required"},[a._v("客服二维码： "),e("span",{staticClass:"notes"},[a._v(" ( 用户完成任务后，联系客服领取奖励 )")])]),e("div",{staticClass:"upload-qc"},[e("m-upload",{attrs:{def:!1,text:"请上传二维码"},on:{change:a.uploadImg}})],1)]),e("div",{staticClass:"mb40"},[e("div",{staticClass:"card-box interval"},[e("span",[a._v("企业名片：")]),e("div",{staticClass:"switch"},[e("a-switch",{attrs:{size:"small"},on:{click:function(){t.cardShow?t.taskForm.corp_card_status=1:t.taskForm.corp_card_status=0}},model:{value:a.cardShow,callback:function(t){a.cardShow=t},expression:"cardShow"}})],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:a.cardShow,expression:"cardShow"}],staticClass:"information"},[e("div",{staticClass:"portrait interval"},[e("div",{staticClass:"corporate-avatar"},[a._v("企业头像：")]),e("div",{staticClass:"upload-two"},[e("m-upload",{attrs:{def:!1,text:"请上传头像"},on:{change:a.uploadBusinesshead}})],1)]),e("div",{staticClass:"corporate-name"},[e("span",{staticClass:"cr-name interval"},[a._v("企业名称："),e("a-input",{attrs:{placeholder:"请输入企业名称"},model:{value:a.taskForm.corp_card.name,callback:function(t){a.$set(a.taskForm.corp_card,"name",t)},expression:"taskForm.corp_card.name"}})],1)]),e("div",{staticClass:"mb14"},[e("div",{staticClass:"profile-title"},[a._v(" 企业简介： "),e("div",{staticClass:"switch"},[e("a-switch",{attrs:{size:"small","default-checked":""},on:{change:function(){t.profileShow?t.taskForm.corp_card.description_status=1:t.taskForm.corp_card.description_status=0}},model:{value:a.profileShow,callback:function(t){a.profileShow=t},expression:"profileShow"}})],1)])]),a.profileShow?e("div",{staticClass:"profile"},[e("a-textarea",{attrs:{placeholder:"请输入企业简介",rows:5},model:{value:a.taskForm.corp_card.description,callback:function(t){a.$set(a.taskForm.corp_card,"description",t)},expression:"taskForm.corp_card.description"}})],1):a._e()])]),e("div",{staticClass:"title"},[a._v("客户设置")]),e("a-alert",{staticClass:"tips",attrs:{message:"企业微信接口限制，仅支持为已添加企业员工的客户打标签",type:"info","show-icon":""}}),e("div",{staticClass:"customer-label interval"},[e("span",{staticClass:"customer-tag"},[a._v("客户标签：")]),e("div",{staticClass:"task-rule"},[e("div",{staticClass:"rule-box"},[e("div",{staticClass:"rule"},[a._v("规则：")]),a._l(a.clientTagList,(function(t,s){return e("div",{key:s,staticClass:"punch-page"},[a._v(" 为 "),e("div",{staticClass:"drop-down"},[""==t.key?[e("a-select",{staticStyle:{width:"130px","margin-left":"5px","margin-right":"5px"},attrs:{placeholder:"选择用户行为"},on:{change:function(t){return a.setUserAction(t,s)}}},[e("a-select-option",{attrs:{value:1,disabled:a.selectOption}},[a._v("进入打卡页面")]),e("a-select-option",{attrs:{value:2}},[a._v("设置天数")])],1)]:[1==t.key?e("span",{staticClass:"set_userLable_tips"},[a._v("进入打卡页面")]):e("span",[a._v("打卡 "),e("a-input-number",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{min:1},model:{value:t.count,callback:function(s){a.$set(t,"count",s)},expression:"item.count"}}),a._v("天")],1)]],2),a._v(" 的客户打上 "),e("div",{staticClass:"choiceAdmin",on:{click:function(t){return a.showModal(s)}}},[0==t.clientTagArr.length?e("span",{staticClass:"operationTips"},[a._v("请选择标签")]):a._e(),a._l(t.clientTagArr,(function(t,i){return e("a-tag",{key:i},[a._v(" "+a._s(t.name)+" "),e("a-icon",{attrs:{type:"close"},on:{click:function(t){return t.stopPropagation(),a.delTagsArr(s,i)}}})],1)}))],2),e("div",[a._v(" 标签 "),e("a",{on:{click:function(t){return a.delTag(s)}}},[e("span",{staticClass:"delete-icon"},[e("a-icon",{attrs:{type:"minus-circle"}})],1)])])])})),e("addlableIndex",{ref:"childRef",on:{choiceTagsArr:a.acceptArray}})],2),e("div",{staticClass:"add-task"},[e("a",{on:{click:a.addClinentTag}},[e("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),a._v(" 添加任务 ")],1)])])]),e("div",{staticClass:"create-over"},[e("a-button",{attrs:{type:"primary"},on:{click:a.establishTask}},[a._v("创建打卡任务")])],1)],1)])],1)},i=[],c=(s("b0c0"),s("a4d3"),s("e01a"),s("d3b7"),s("159b"),s("a434"),s("7728")),n=s("6010"),r={components:{addlableIndex:n["a"]},data:function(){return{selectedList:[],selectOption:!0,visible:!1,tagList:[{count:"",prize:""},{count:"",prize:""}],clientTagList:[{key:1,count:0,tags:[],clientTagArr:[]},{key:"",count:1,tags:[],clientTagArr:[]}],taskForm:{name:"",description:"",time_type:1,type:1,start_time:"",end_time:"",tasks:"",contact_clock_tags:"",corp_card_status:0,point:0,corp_card:{logo:"",name:"",description:"",description_status:1},employee_qrcode:""},value:0,cardShow:!1,profileShow:!0,selectInputIndex:0,delSelectlable:0}},methods:{establishTask:function(){var t=this;if(this.taskForm.tasks=this.tagList,this.taskForm.contact_clock_tags=this.clientTagList,!this.taskForm.name)return this.$message.warning("打卡名称未填写"),!1;if(!this.taskForm.description)return this.$message.warning("打卡说明未填写"),!1;var a=[];this.taskForm.tasks.forEach((function(t,s){a[s]=t.count}));for(var s=0;s<this.taskForm.tasks.length;s++){if(""==this.taskForm.tasks[s].count)return this.$message.warning("打卡天数不能为空"),!1;if(""==this.taskForm.tasks[s].prize)return this.$message.warning("奖励不能为空"),!1;for(var e=0;e<a.length;e++){if(this.taskForm.tasks[s].count==a[e]&&s!=e)return this.$message.error("阶段"+(s+1)+"的打卡天数和阶段"+(e+1)+"打卡天数不能相同"),!1;this.taskForm.tasks[s].count<a[e]&&s>e&&this.$message.error("打卡阶段"+(s+1)+"天数应大于打卡阶段"+(e+1)+"天数")}}if(2==this.taskForm.time_type){if(""==this.taskForm.time_type)return this.$message.warning("开始时间不能为空"),!1;if(""==this.taskForm.end_time)return this.$message.warning("结束时间不能为空"),!1}if(""==this.taskForm.employee_qrcode)return this.$message.warning("客服二维码不能为空"),!1;if(1==this.taskForm.corp_card_status){if(""==this.taskForm.corp_card.logo)return this.$message.warning("企业头像不能为空"),!1;if(""==this.taskForm.corp_card.name)return this.$message.warning("企业名称不能为空"),!1;if(1==this.taskForm.corp_card.description_status&&""==this.taskForm.corp_card.description)return this.$message.warning("企业简介不能为空"),!1}Object(c["a"])(this.taskForm).then((function(a){t.$message.success("创建成功"),t.$router.push({path:"/roomClockIn/index"})}))},showModal:function(t){this.selectInputIndex=t,this.$refs.childRef.show(this.clientTagList[this.selectInputIndex].clientTagArr)},delTagsArr:function(t,a){this.clientTagList[t].tags.splice(a,1),this.clientTagList[t].clientTagArr.splice(a,1)},acceptArray:function(t){var a=this;if(t){var s=[];t.forEach((function(t,e){var i={tagid:"",tagname:""};i.tagid=t.id,i.tagname=t.name,a.clientTagList[a.selectInputIndex].tags.push(i),s[e]=t})),this.clientTagList[this.selectInputIndex].clientTagArr=s}else this.clientTagList[this.selectInputIndex].clientTagArr=[],this.clientTagList[this.selectInputIndex].tags=[]},setUserAction:function(t,a){1==t&&(this.selectOption=!0),this.clientTagList[a].key=t},uploadBusinesshead:function(t){this.taskForm.corp_card.logo=t},uploadImg:function(t){this.taskForm.employee_qrcode=t},setActivityTime:function(t,a){this.taskForm.start_time=a[0],this.taskForm.end_time=a[1]},delTag:function(t){if(1===this.clientTagList.length)return this.$message.error("不能删除最后一个"),!1;1==this.clientTagList[t].key&&(this.selectOption=!1),this.clientTagList.splice(t,1)},addClinentTag:function(){var t={key:"",count:0,tags:[],clientTagArr:[]};this.clientTagList.forEach((function(a){0==a.count&&(t.count=1)})),this.clientTagList.push(t)},addTag:function(){if(3===this.tagList.length)return this.$message.error("不能添加3个以上"),!1;this.tagList.push({type:"0",tasg:[]})},delClock:function(t){this.tagList.splice(t,1)},addClock:function(){if(5===this.tagList.length)return this.$message.error("不能添加五个以上"),!1;this.tagList.push({type:"0",tasg:[]})}}},o=r,l=(s("359c"),s("2877")),d=Object(l["a"])(o,e,i,!1,null,"b14f0ffa",null);a["default"]=d.exports}}]);