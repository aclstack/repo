(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["contact-message-batch-send"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var n=a("6b75");function r(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},"0e64":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"select-group"},[n("a-modal",{attrs:{"on-ok":"handleOk",width:526,footer:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[n("template",{slot:"title"},[t._v(" 选择群聊 ")]),n("div",{staticClass:"content"},[n("div",{staticClass:"tips"},[t._v(" 全部群聊（"+t._s(t.groups.length)+"）： ")]),n("div",{staticClass:"groups"},t._l(t.groups,(function(e,r){return t.resetFlag?n("div",{key:r,staticClass:"item"},[n("div",{staticClass:"icon"},[n("img",{attrs:{src:a("8522")}})]),n("div",{staticClass:"info"},[n("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")]),n("div",{staticClass:"count"},[t._v(" "+t._s(e.contact_num)+" / "+t._s(e.roomMax)+" ")])]),n("div",[n("div",{staticClass:"select"},[t.resetFlag?n("a-checkbox",{attrs:{checked:e.select},on:{change:function(a){return t.selectChange(a,e)}}}):t._e()],1)])]):t._e()})),0),n("div",{staticClass:"confirm"},[n("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)])],2)],1)},r=[],s=a("b85c"),i=(a("d3b7"),a("159b"),a("4de4"),a("59e4")),o={data:function(){return{modalShow:!1,loading:!1,groups:[],currentData:{},resetFlag:!0}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.currentData=a,this.getData((function(a){e.reset(),e.groups.forEach((function(e){t.forEach((function(t){t.wxChatId===e.wxChatId&&(e.select=!0)}))}))})),this.modalShow=!0},selectChange:function(t,e){this.resetFlag=!1,e.select=t.target.checked,this.resetFlag=!0},confirm:function(){this.hide();var t=this.groups.filter((function(t){return!0===t.select}));this.$emit("change",t,this.currentData)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(i["o"])({roomGroupId:0,page:1,perPage:1e3}).then((function(a){t.groups=a.data,e&&e()}))},show:function(){this.getData(),this.reset(),this.modalShow=!0},hide:function(){this.modalShow=!1},reset:function(){var t,e=Object(s["a"])(this.groups);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(n){e.e(n)}finally{e.f()}}}},c=o,l=(a("2897"),a("2877")),u=Object(l["a"])(c,n,r,!1,null,"b583576e",null);e["a"]=u.exports},2263:function(t,e,a){"use strict";a("9c58")},2897:function(t,e,a){"use strict";a("9d3f")},"2ee5":function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"g",(function(){return s})),a.d(e,"e",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"a",(function(){return c})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return u})),a.d(e,"b",(function(){return d})),a.d(e,"c",(function(){return m})),a.d(e,"l",(function(){return f})),a.d(e,"k",(function(){return p})),a.d(e,"j",(function(){return h}));var n=a("b775");function r(t){return Object(n["b"])({url:"/channelCodeGroup/index",method:"get",params:t})}function s(t){return Object(n["b"])({url:"/channelCodeGroup/update",method:"put",data:t})}function i(t){return Object(n["b"])({url:"/channelCodeGroup/store",method:"post",data:t})}function o(t){return Object(n["b"])({url:"/channelCodeGroup/move",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/channelCode/store",method:"post",data:t})}function l(t){return Object(n["b"])({url:"/channelCode/update",method:"put",data:t})}function u(t){return Object(n["b"])({url:"/channelCode/index",method:"get",params:t})}function d(t){return Object(n["b"])({url:"/channelCode/contact",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/channelCode/show",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/channelCode/statisticsIndex",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/channelCode/statistics",method:"get",params:t})}function h(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}},"3d08":function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"g",(function(){return s})),a.d(e,"f",(function(){return i})),a.d(e,"b",(function(){return o})),a.d(e,"e",(function(){return c})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return u}));var n=a("b775");function r(t){return Object(n["b"])({url:"/contactMessageBatchSend/index",method:"get",params:t})}function s(t){return Object(n["b"])({url:"/contactMessageBatchSend/store",method:"post",data:t})}function i(t){return Object(n["b"])({url:"/contactMessageBatchSend/show",method:"get",params:t})}function o(t){return Object(n["b"])({url:"/contactMessageBatchSend/destroy",method:"delete",data:t})}function c(t){return Object(n["b"])({url:"/contactMessageBatchSend/remind",method:"post",data:t})}function l(t){return Object(n["b"])({url:"/contactMessageBatchSend/contactReceiveIndex",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/contactMessageBatchSend/employeeSendIndex",method:"get",params:t})}},"3eb2":function(t,e,a){"use strict";a("ca9b")},"3ee7":function(t,e,a){},"4a04":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:636,footer:!1,centered:"",maskClosable:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 选择成员 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"left-content"},[a("div",{staticClass:"tips"},[t._v(" 没有想要添加的成员？ "),a("a",{attrs:{href:"#"}},[t._v("添加成员教程")])]),a("div",{staticClass:"search"},[a("a-input-search",{attrs:{placeholder:"请输入成员昵称"},on:{search:t.search}})],1),a("div",{staticClass:"member"},t._l(t.members,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-checkbox",{on:{change:function(a){return t.selectChange(e)}},model:{value:e.select,callback:function(a){t.$set(e,"select",a)},expression:"v.select"}})],1)])})),0)]),a("div",{staticClass:"right-content"},[a("div",{staticClass:"tips"},[t._v(" 已选成员：（"+t._s(t.selectedMembers.length)+"） ")]),a("div",{staticClass:"member"},t._l(t.selectedMembers,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])])])})),0)])]),a("div",{staticClass:"confirm"},[a("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.go}},[t._v("确定")])],1)],2)],1)},r=[],s=a("b85c"),i=(a("d3b7"),a("159b"),a("4de4"),a("a434"),a("2ee5")),o={data:function(){return{modalShow:!1,loading:!1,members:[],selectedMembers:[],currentData:{}}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.selectedMembers=[],t.forEach((function(t,a){e.selectedMembers[a]=t})),this.currentData=a,this.getData("",(function(t){e.selectedMembers.forEach((function(t){e.members.forEach((function(e){t.wxUserId===e.wxUserId&&(t.avatar||(t.avatar=e.avatar),e.select=!0)}))}))})),this.reset(),this.modalShow=!0},search:function(t){this.getData(t)},selectChange:function(t){var e=-1,a=this.selectedMembers.filter((function(a,n){if(a.id===t.id)return e=n,a}));if(a.length)return this.selectedMembers.splice(e,1),!1;this.selectedMembers.push(t)},reset:function(){var t,e=Object(s["a"])(this.members);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(n){e.e(n)}finally{e.f()}},go:function(){this.hide(),this.$emit("change",this.selectedMembers)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(i["j"])({searchKeyWords:e}).then((function(e){t.members=e.data.employee,a&&a()}))},show:function(){this.getData(),this.reset(),this.selectedMembers=[],this.modalShow=!0},hide:function(){this.modalShow=!1}}},c=o,l=(a("2263"),a("2877")),u=Object(l["a"])(c,n,r,!1,null,"24741dee",null);e["a"]=u.exports},"4fce":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index_module"},[a("a-row",{staticClass:"search",attrs:{type:"flex",justify:"space-between"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/contactMessageBatchSend/store"})}}},[t._v("新建群发")])],1),a("a-table",{attrs:{columns:t.table.columns,"data-source":t.table.data},scopedSlots:t._u([{key:"content",fn:function(e){return a("div",{},t._l(e,(function(e,n){return a("div",{key:n},["text"===e.msgType?a("div",[t._v("群发消息1："+t._s(e.content))]):t._e(),"image"===e.msgType||"link"===e.msgType||"miniprogram"===e.msgType?a("div",{staticStyle:{"margin-top":"10px"}},[t._v("群发消息2：")]):t._e(),a("div",{staticStyle:{"margin-left":"15px","margin-top":"10px"}},["image"===e.msgType?a("div",[a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})]):t._e(),"link"===e.msgType?a("div",[a("div",[t._v(t._s(e.url))]),a("div",{staticStyle:{display:"flex"}},[a("div",[a("div",[t._v(t._s(e.title))]),a("div",[t._v(t._s(e.desc))])]),a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})])]):t._e(),"miniprogram"===e.msgType?a("div",[a("div",{staticClass:"applets"},[a("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" ")]),a("div",{staticClass:"image"},[a("img",{attrs:{src:e.pic_url}})]),a("div",{staticClass:"applets-logo"},[t._v(" 小程序 ")])])]):t._e()])])})),0)}},{key:"sendWay",fn:function(e){return a("div",{},[a("span",1==e?[t._v("立即发送")]:[t._v("定时发送")])])}},{key:"action",fn:function(e,n){return a("div",{},[0!=n.notReceivedTotal?a("a",{on:{click:function(e){return t.remindSend(n)}}},[t._v("提醒发送")]):a("span",{staticStyle:{color:"gray"}},[t._v("提醒发送")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.$router.push({path:"/contactMessageBatchSend/show?batchId="+n.id})}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.delRowTable(n)}}},[t._v("删除")])],1)}}])})],1)},r=[],s=a("3d08"),i={data:function(){return{table:{columns:[{title:"群发内容",dataIndex:"content",scopedSlots:{customRender:"content"}},{title:"群发类型",dataIndex:"sendWay",key:"sendWay",scopedSlots:{customRender:"sendWay"}},{title:"发送时间",dataIndex:"definiteTime",key:"definiteTime"},{title:"已发送成员",key:"sendTotal",dataIndex:"sendTotal"},{title:"送达客户",key:"receivedTotal",dataIndex:"receivedTotal"},{title:"未发送成员",key:"notSendTotal",dataIndex:"notSendTotal"},{title:"未送达客户",key:"notReceivedTotal",dataIndex:"notReceivedTotal"},{title:"创建时间",key:"createdAt",dataIndex:"createdAt"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],data:[{}]}}},created:function(){this.getTableData()},methods:{remindSend:function(t){var e=this;Object(s["e"])({batchId:t.id}).then((function(t){e.$message.success("提醒成功")}))},delRowTable:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){Object(s["b"])({batchId:t.id}).then((function(t){e.$message.success("删除成功"),e.getTableData()}))}})},getTableData:function(){var t=this;Object(s["d"])().then((function(e){t.table.data=e.data.list}))},onSearch:function(){}}},o=i,c=(a("a8e1"),a("2877")),l=Object(c["a"])(o,n,r,!1,null,null,null);e["default"]=l.exports},5513:function(t,e,a){},"59e4":function(t,e,a){"use strict";a.d(e,"C",(function(){return r})),a.d(e,"k",(function(){return s})),a.d(e,"i",(function(){return i})),a.d(e,"x",(function(){return o})),a.d(e,"D",(function(){return c})),a.d(e,"u",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"y",(function(){return d})),a.d(e,"A",(function(){return m})),a.d(e,"l",(function(){return f})),a.d(e,"t",(function(){return p})),a.d(e,"s",(function(){return h})),a.d(e,"B",(function(){return g})),a.d(e,"e",(function(){return b})),a.d(e,"c",(function(){return v})),a.d(e,"d",(function(){return _})),a.d(e,"z",(function(){return y})),a.d(e,"b",(function(){return C})),a.d(e,"w",(function(){return w})),a.d(e,"q",(function(){return k})),a.d(e,"o",(function(){return x})),a.d(e,"v",(function(){return T})),a.d(e,"a",(function(){return S})),a.d(e,"n",(function(){return I})),a.d(e,"j",(function(){return O})),a.d(e,"p",(function(){return j})),a.d(e,"g",(function(){return D})),a.d(e,"h",(function(){return A})),a.d(e,"m",(function(){return $})),a.d(e,"r",(function(){return P}));var n=a("b775");function r(t){return Object(n["b"])({url:"/workRoomGroup/index",method:"get",params:t})}function s(t){return Object(n["b"])({url:"/workRoomGroup/destroy",method:"delete",data:t})}function i(t){return Object(n["b"])({url:"/workRoomGroup/store",method:"post",data:t})}function o(t){return Object(n["b"])({url:"/workRoomGroup/update",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/workRoom/index",method:"get",params:t})}function l(t){return Object(n["b"])({url:"/workRoom/syn",method:"put",data:t})}function u(t){return Object(n["b"])({url:"/workRoom/batchUpdate",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/workContactRoom/index",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/workEmployeeDepartment/memberIndex",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/workRoom/statisticsIndex",method:"get",params:t})}function h(t){return Object(n["b"])({url:"/workRoom/statistics",method:"get",params:t})}function g(t){return Object(n["b"])({url:"/workRoomAutoPull/index",method:"get",params:t})}function b(t){return Object(n["b"])({url:"/workRoomAutoPull/update",method:"put",data:t})}function v(t){return Object(n["b"])({url:"/workRoomAutoPull/store",method:"post",data:t})}function _(t){return Object(n["b"])({url:"/workRoomAutoPull/show",method:"get",params:t})}function y(t){return Object(n["b"])({url:"/workContactTagGroup/index",method:"get",params:t})}function C(t){return Object(n["b"])({url:"/workContactTag/store",method:"post",data:t})}function w(t){return Object(n["b"])({url:"/workContactTag/allTag",method:"get",params:t})}function k(t){return Object(n["b"])({url:"/workRoom/roomIndex",method:"get",params:t})}function x(t){return Object(n["b"])({url:"/roomTagPull/roomList",method:"get",params:t})}function T(t){return Object(n["b"])({url:"/roomTagPull/index",method:"get",params:t})}function S(t){return Object(n["b"])({url:"/roomTagPull/store",method:"POST",data:t})}function I(t){return Object(n["b"])({url:"/roomTagPull/show",method:"GET",params:t})}function O(t){return Object(n["b"])({url:"/roomTagPull/destroy",method:"DELETE",data:t})}function j(t){return Object(n["b"])({url:"/roomTagPull/remindSend",method:"GET",params:t})}function D(t){return Object(n["b"])({url:"/roomTagPull/chooseContact",method:"GET",params:t})}function A(t){return Object(n["b"])({url:"/roomTagPull/filterContact",method:"POST",data:t})}function $(t){return Object(n["b"])({url:"/roomTagPull/showContact",method:"GET",params:t})}function P(t){return Object(n["b"])({url:"/contactMessageBatchSend/showRoom",method:"GET",params:t})}},"5d5c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-white-module"},[a("div",{staticClass:"c"},[a("div",{staticClass:"left"},[a("a-form-model",{ref:"ruleForm",attrs:{model:t.form,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("div",{staticClass:"title"},[t._v("基础信息")]),a("a-form-model-item",{attrs:{label:"选择群发账号"}},[a("a-button",{on:{click:function(e){return t.$refs.selectMember.show()}}},[t._v("+点击选择")]),a("div",t._l(t.form.employeeIds,(function(e){return a("a-tag",{key:e.id},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-model-item",{ref:"sendWay",attrs:{label:"选择客户"}},[a("a-row",[a("a-radio-group",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("a-radio",{attrs:{value:1}},[t._v("全部客户")]),a("a-radio",{attrs:{value:2}},[t._v("筛选客户")])],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:2==t.form.type,expression:"form.type == 2"}],staticClass:"client_module"},[a("a-form-model-item",{attrs:{required:"","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"性别"}},[a("a-radio-group",{model:{value:t.form.filterParams.gender,callback:function(e){t.$set(t.form.filterParams,"gender",e)},expression:"form.filterParams.gender"}},[a("a-radio",{attrs:{value:3}},[t._v("全部性别")]),a("a-radio",{attrs:{value:1}},[t._v("仅男性粉丝")]),a("a-radio",{attrs:{value:2}},[t._v("仅女性粉丝")]),a("a-radio",{attrs:{value:0}},[t._v("未知性别")])],1)],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"所在群聊"}},[a("a-button",{on:{click:function(e){return t.$refs.selectGroup.show()}}},[t._v("选择群聊")]),a("div",t._l(t.form.filterParams.rooms,(function(e,n){return a("a-tag",{key:n},[t._v(t._s(e.name))])})),1)],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"添加时间"}},[a("a-range-picker",{staticStyle:{width:"280px"},on:{change:t.setUpTime}})],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"标签"}},[a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(1)}}},[0==t.form.filterParams.tags.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(t.form.filterParams.tags,(function(e,n){return a("a-tag",{key:n},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(1,n)}}})],1)}))],2)]),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"排除客户"}},[a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(2)}}},[0==t.form.filterParams.excludeContacts.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(t.form.filterParams.excludeContacts,(function(e,n){return a("a-tag",{key:n},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(2,n)}}})],1)}))],2),a("div",{staticClass:"hint_text"},[t._v(" 可根据标签选择客户，群发时将不会发送给该标签内的客户。若选择了排除的客户，需要较长的时间创建本条群发消息哦 ")]),a("div",{staticClass:"hint_text hint_text1"},[t._v("将消息发送给符合条件的粉丝")])])],1),a("div",{staticClass:"hint"},[t._v(" 将群发消息给全部账号的查看客户 "),a("span")])],1),a("div",{staticClass:"title"},[t._v("编辑群发消息")]),a("a-form-model-item",{ref:"textContent",attrs:{label:"群发消息1:",prop:"textContent"}},[a("a-row",{staticClass:"msg_module"},[a("a-input",{staticClass:"form_textarea",attrs:{autoSize:{minRows:6},maxLength:400,type:"textarea",placeholder:"请输入回复内容"},model:{value:t.form.textContent,callback:function(e){t.$set(t.form,"textContent",e)},expression:"form.textContent"}}),a("div",{staticClass:"text_num"},[t._v(t._s(t.form.textContent.length)+"/400")])],1)],1),a("a-form-model-item",{ref:"name6",attrs:{label:"群发消息2:"}},[a("a-row",{staticClass:"msg_module"},[a("a-row",[t._v(" 选择消息类型 "),a("a-radio-group",{staticClass:"msg_type",on:{change:t.switchRadio},model:{value:t.msgType,callback:function(e){t.msgType=e},expression:"msgType"}},[a("a-radio",{attrs:{value:"1"}},[t._v("图片")]),a("a-radio",{attrs:{value:"2"}},[t._v("链接")]),a("a-radio",{attrs:{value:"3"}},[t._v("小程序")])],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:1==t.msgType,expression:"msgType == 1"}]},[a("upload",{ref:"overImg",attrs:{"file-type":1},on:{success:t.uploadImageSuccess},model:{value:t.form.content.image.pic_url,callback:function(e){t.$set(t.form.content.image,"pic_url",e)},expression:"form.content.image.pic_url"}})],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:2==t.msgType,expression:"msgType == 2"}]},[a("a-form-model-item",{attrs:{required:"","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"链接地址："}},[a("a-input",{attrs:{placeholder:"请输入链接地址"},model:{value:t.form.content.link.url,callback:function(e){t.$set(t.form.content.link,"url",e)},expression:"form.content.link.url"}})],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"链接标题："}},[a("a-input",{attrs:{placeholder:"请输入标题"},model:{value:t.form.content.link.title,callback:function(e){t.$set(t.form.content.link,"title",e)},expression:"form.content.link.title"}})],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"链接摘要："}},[a("a-input",{attrs:{placeholder:"请输入链接摘要"},model:{value:t.form.content.link.desc,callback:function(e){t.$set(t.form.content.link,"desc",e)},expression:"form.content.link.desc"}})],1),a("a-form-model-item",{attrs:{"label-col":t.childLabelCol,"wrapper-col":t.wrapperCol,label:"链接封面："}},[a("upload",{ref:"linkOver",attrs:{"file-type":1},on:{success:t.uploadLinkSuccess},model:{value:t.form.content.link.picture,callback:function(e){t.$set(t.form.content.link,"picture",e)},expression:"form.content.link.picture"}})],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:3==t.msgType,expression:"msgType == 3"}]},[a("a-form-model-item",{attrs:{required:"",label:"填写标题：","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol}},[a("a-input",{attrs:{placeholder:"请填写小程序标题(4-12个字符)",maxLength:12},model:{value:t.form.content.miniprogram.title,callback:function(e){t.$set(t.form.content.miniprogram,"title",e)},expression:"form.content.miniprogram.title"}})],1),a("a-form-model-item",{attrs:{required:"",label:"AppID","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol}},[a("a-input",{attrs:{placeholder:"请填写小程序AppID,必须是关联到企业的小程序应用"},model:{value:t.form.content.miniprogram.appid,callback:function(e){t.$set(t.form.content.miniprogram,"appid",e)},expression:"form.content.miniprogram.appid"}})],1),a("a-form-model-item",{attrs:{required:"",label:"page路径：","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol}},[a("a-input",{attrs:{placeholder:"请填写小程序路径，例如：pages/index"},model:{value:t.form.content.miniprogram.page,callback:function(e){t.$set(t.form.content.miniprogram,"page",e)},expression:"form.content.miniprogram.page"}})],1),a("a-form-model-item",{attrs:{required:"",label:"图片封面：","label-col":t.childLabelCol,"wrapper-col":t.wrapperCol}},[a("upload",{ref:"appletImg",attrs:{"file-type":1},on:{success:t.uploadMiniprogramSuccess},model:{value:t.form.content.miniprogram.pic_media_id,callback:function(e){t.$set(t.form.content.miniprogram,"pic_media_id",e)},expression:"form.content.miniprogram.pic_media_id"}})],1)],1)],1)],1),a("a-form-model-item",{ref:"sendWay",attrs:{label:"群发时间："}},[a("a-row",[a("a-radio-group",{model:{value:t.form.sendWay,callback:function(e){t.$set(t.form,"sendWay",e)},expression:"form.sendWay"}},[a("a-radio",{attrs:{value:"1"}},[t._v("立即发送")]),a("a-radio",{attrs:{value:"2"}},[t._v("定时发送")])],1)],1),2==t.form.sendWay?a("a-row",[a("a-date-picker",{attrs:{"show-time":"",placeholder:"请选择时间"},on:{change:t.selectTime}})],1):t._e(),a("div",{staticClass:"hint hint1"},[t._v(" 注意，客户每个月最多接收来自同一企业的管理员的4条群发消息，4条消息可在同一天发送 ")])],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[a("a-button",{attrs:{type:"primary",loading:t.btnLoading,disabled:t.btnLoading},on:{click:t.onSubmit}},[t._v("通知成员立即发送")])],1)],1)],1),a("div",{staticStyle:{"margin-left":"30px","margin-top":"180px"}},[a("m-preview",{ref:"preview"})],1)]),a("selectMember",{ref:"selectMember",on:{change:function(e){return t.form.employeeIds=e}}}),a("selectGroup",{ref:"selectGroup",on:{change:function(e){return t.form.filterParams.rooms=e}}}),a("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1)},r=[],s=(a("9911"),a("d3b7"),a("159b"),a("a434"),a("3d08")),i=a("4a04"),o=a("0e64"),c=a("6010"),l=a("ff04"),u={components:{selectMember:i["a"],selectGroup:o["a"],addlableIndex:c["a"],upload:l["a"]},data:function(){return{labelCol:{span:4},childLabelCol:{span:4},wrapperCol:{span:20},btnLoading:!1,form:{employeeIds:[],type:1,filterParams:{gender:3,rooms:[],addTimeStart:"",addTimeEnd:"",tags:[],excludeContacts:[]},textContent:"",definiteTime:"",sendWay:"1",content:{link:{url:"",title:"",desc:"",picture:""},image:{media_id:"",pic_url:""},miniprogram:{title:"",pic_media_id:"",appid:"",page:""}}},tagsType:1,msgType:"1"}},mounted:function(){},watch:{"form.textContent":function(){this.$refs.preview.setText(this.form.textContent),this.form.textContent.length>400&&(this.$message.warning("最多输入400个字"),this.form.textContent=this.form.textContent.substring(0,1500))},"form.content.link":{deep:!0,handler:function(){var t=this,e=this.form.content.link;this.$nextTick((function(){t.$refs.preview.setLink(e.title,e.desc,e.pictureImg)}))}},"form.content.miniprogram":{deep:!0,handler:function(){var t=this,e=this.form.content.miniprogram;this.$nextTick((function(){t.$refs.preview.setApplets(e.title,e.pic_media_idImg)}))}}},methods:{switchRadio:function(){if(1==this.msgType)this.$refs.preview.setImage(this.form.content.image.pic_urlImg),this.$refs.preview.setLink(),this.$refs.preview.setApplets();else if(2==this.msgType){this.$refs.preview.setImage();var t=this.form.content.link;this.$refs.preview.setLink(t.title,t.desc,t.pictureImg),this.$refs.preview.setApplets()}else if(3==this.msgType){this.$refs.preview.setImage(),this.$refs.preview.setLink();var e=this.form.content.miniprogram;this.$refs.preview.setApplets(e.title,e.pic_media_idImg)}},uploadMiniprogramSuccess:function(t){this.form.content.miniprogram.pic_media_idImg=t.fullPath},uploadLinkSuccess:function(t){this.form.content.link.pictureImg=t.fullPath},uploadImageSuccess:function(t){this.form.content.image.pic_urlImg=t.fullPath,this.$refs.preview.setImage(t.fullPath)},selectTime:function(t,e){this.form.definiteTime=e},onSubmit:function(){var t=this,e=JSON.parse(JSON.stringify(this.form)),a={},n=[];if(0!==this.form.employeeIds.length){if(e.employeeIds=[],this.form.employeeIds.forEach((function(t,a){e.employeeIds[a]=t.employeeId})),1==this.form.type)e.filterParams=JSON.stringify({});else{if(0==this.form.filterParams.rooms.length?e.filterParams.rooms=[]:(e.filterParams.rooms=[],this.form.filterParams.rooms.forEach((function(t,a){e.filterParams.rooms[a]=t.id}))),""==this.form.filterParams.addTimeStart)return this.$message.warning("筛选客户时间不能为空"),!1;e.filterParams.tags=[],0!=this.form.filterParams.tags.length&&this.form.filterParams.tags.forEach((function(t,a){e.filterParams.tags[a]=t.id})),e.filterParams.excludeContacts=[],0!=this.form.filterParams.excludeContacts.length&&this.form.filterParams.excludeContacts.forEach((function(t,a){e.filterParams.excludeContacts[a]=t.id})),e.filterParams=JSON.stringify(e.filterParams)}if(""!==this.form.textContent&&(a={msgType:"text",content:this.form.textContent},n.push(a)),"1"===this.msgType){if(delete e.content.image,delete e.content.miniprogram,""===this.form.textContent&&""===this.form.content.image.pic_url)return void this.$message.warning("请上传图片");""!==this.form.content.image.pic_url&&(a={msgType:"image",media_id:(new Date).getTime(),pic_url:this.form.content.image.pic_url},n.push(a))}else if("2"===this.msgType){if(""===this.form.textContent&&-1===this.form.content.link.url.indexOf("http://")&&-1===this.form.content.link.url.indexOf("https://"))return void this.$message.warning("链接地址输入不正确");""!==this.form.content.link.url&&(a={msgType:"link",title:this.form.content.link.title,pic_url:this.form.content.link.picture,desc:this.form.content.link.desc,url:this.form.content.link.url},n.push(a))}else if("3"===this.msgType){if(""===this.form.textContent){if(""===this.form.content.miniprogram.pic_media_id)return void this.$message.warning("请选择封面");if(""===this.form.content.miniprogram.title)return void this.$message.warning("请填写标题");if(""===this.form.content.miniprogram.appid)return void this.$message.warning("请输入appId");if(""===this.form.content.miniprogram.page)return void this.$message.warning("请输入小程序路径")}""!==this.form.content.miniprogram.page&&(a={msgType:"miniprogram",title:this.form.content.miniprogram.title,pic_media_id:this.form.content.miniprogram.pic_media_id,appid:this.form.content.miniprogram.appid,page:this.form.content.miniprogram.page},n.push(a))}if(2==this.form.sendWay){if(""===this.form.definiteTime)return void this.$message.warning("请选择时间")}else e.definiteTime=this.getDateTime();e.content=JSON.stringify(n),Object(s["g"])(e).then((function(e){t.$message.success("创建成功"),t.$router.push({path:"/contactMessageBatchSend/index"})}))}else this.$message.warning("请选择群发账号")},getDateTime:function(){var t=(new Date).getFullYear(),e=(new Date).getMonth()+1<10?"0"+((new Date).getMonth()+1):(new Date).getMonth()+1,a=(new Date).getDate()<10?"0"+(new Date).getDate():(new Date).getDate(),n=(new Date).getHours(),r=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes(),s=(new Date).getSeconds()<10?"0"+(new Date).getSeconds():(new Date).getSeconds(),i=t+"-"+e+"-"+a+" "+n+":"+r+":"+s;return i},acceptArray:function(t){1==this.tagsType?this.form.filterParams.tags=t:this.form.filterParams.excludeContacts=t},showModal:function(t){this.tagsType=t,1==this.tagsType?this.$refs.childRef.show(this.form.filterParams.tags):this.$refs.childRef.show(this.form.filterParams.excludeContacts)},delTagsArr:function(t,e){1==t?this.form.filterParams.tags.splice(e,1):this.form.filterParams.excludeContacts.splice(e,1)},setUpTime:function(t,e){this.form.filterParams.addTimeStart=e[0],this.form.filterParams.addTimeEnd=e[1]}}},d=u,m=(a("3eb2"),a("2877")),f=Object(m["a"])(d,n,r,!1,null,"34d67bb2",null);e["default"]=f.exports},6010:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tagsModal"},[a("a-modal",{staticClass:"modelCard",attrs:{title:"选择标签",maskClosable:!1},on:{ok:t.handleOk},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[t._l(t.lableArr,(function(e,n){return a("div",{key:n,staticClass:"labelRow"},[a("div",{staticClass:"labelTitle"},[t._v(t._s(e.groupName))]),a("div",{staticClass:"labelContent"},[a("div",{staticClass:"labeladdBtn",on:{click:function(a){t.showInput=e.id}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加 ")],1),t.showInput==e.id?a("a-input",{staticClass:"lable_input",attrs:{placeholder:"输入后回车"},on:{blur:t.closeInput,pressEnter:function(a){return t.inputLable(e.id,n)}},model:{value:t.addlableCont,callback:function(e){t.addlableCont=e},expression:"addlableCont"}}):t._e(),t._l(e.tags,(function(e,n){return a("div",{key:n,ref:"hello",refInFor:!0,staticClass:"labelSub",class:[-1!=t.choiceTagsArr.indexOf(e)?"lableSelect":""],on:{click:function(a){return t.selectTags(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)])})),a("span",{staticClass:"add_tags",on:{click:t.addNametags}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 新建标签组 ")],1)],2),a("a-modal",{attrs:{title:"新建标签组"},on:{ok:t.handleNewTags},model:{value:t.addNewTags,callback:function(e){t.addNewTags=e},expression:"addNewTags"}},[a("div",{staticClass:"add_tigs"},[a("a-icon",{attrs:{type:"bell",theme:"filled"}}),t._v(" 管理员可根据不同部门选择展示不同的标签组，部门管理员可创建部门可见的标签 ")],1),a("a-form-model",{attrs:{model:t.tagsform,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{attrs:{label:"标签组名称"}},[a("a-input",{attrs:{placeholder:"请输入标签组名称"},model:{value:t.tagsform.name,callback:function(e){t.$set(t.tagsform,"name",e)},expression:"tagsform.name"}})],1)],1)],1)],1)},r=[],s=a("1da1"),i=(a("96cf"),a("a434"),a("d3b7"),a("159b"),a("b0c0"),a("7728")),o={data:function(){return{modalShow:!1,addNewTags:!1,showInput:0,addlableCont:"",lableArr:[],labelCol:{span:5},wrapperCol:{span:18},tagsform:{name:"",resource:1,selectSection:[]},tipsWarn:!0,choiceTagsArr:[]}},created:function(){this.getClientTags()},methods:{getClientTags:function(){var t=this;Object(i["d"])({page:1,perPage:10}).then((function(e){t.lableArr=e.data}))},selectTags:function(t){var e=this.choiceTagsArr.indexOf(t);-1==e?this.choiceTagsArr.push(t):this.choiceTagsArr.splice(e,1)},memberSelectChange:function(t){this.tagsform.selectSection=t},show:function(t){var e=this;this.choiceTagsArr=[],void 0!=t&&t.forEach((function(t,a){e.choiceTagsArr[a]=t})),this.modalShow=!0},delSelect:function(t){this.tagsform.selectSection.splice(t,1)},handleOk:function(t){this.modalShow=!1,this.$emit("choiceTagsArr",this.choiceTagsArr)},handleNewTags:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=t.tagsform.name){e.next=3;break}return t.$message.warning("标签组名称不能为空"),e.abrupt("return");case 3:Object(i["j"])({groupName:t.tagsform.name}).then((function(e){t.getClientTags(),t.tagsform.name="",t.$message.success("创建成功"),t.addNewTags=!1}));case 4:case"end":return e.stop()}}),e)})))()},closeInput:function(){this.showInput=!1},inputLable:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=[],r.push(a.addlableCont),s={groupId:t,tagName:r},n.next=5,Object(i["l"])(s).then((function(t){}));case 5:o={name:a.addlableCont},a.lableArr[e].tags.push(o),a.showInput=!1,a.addlableCont="";case 9:case"end":return n.stop()}}),n)})))()},addNametags:function(){this.addNewTags=!0}}},c=o,l=(a("981e"),a("2877")),u=Object(l["a"])(c,n,r,!1,null,null,null);e["a"]=u.exports},"6b75":function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},7728:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"m",(function(){return s})),a.d(e,"f",(function(){return i})),a.d(e,"h",(function(){return o})),a.d(e,"g",(function(){return c})),a.d(e,"c",(function(){return l})),a.d(e,"i",(function(){return u})),a.d(e,"l",(function(){return d})),a.d(e,"d",(function(){return m})),a.d(e,"e",(function(){return f})),a.d(e,"j",(function(){return p})),a.d(e,"b",(function(){return h})),a.d(e,"k",(function(){return g}));var n=a("b775");function r(t){return Object(n["b"])({url:"/roomClockIn/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/roomClockIn/update",method:"put",data:t})}function i(t){return Object(n["b"])({url:"/roomClockIn/destroy",method:"delete",data:t})}function o(t){return Object(n["b"])({url:"/roomClockIn/index",method:"get",params:t})}function c(t){return Object(n["b"])({url:"/roomClockIn/show",method:"get",params:t})}function l(t){return Object(n["b"])({url:"/roomClockIn/showContact",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/roomClockIn/info",method:"get",params:t})}function d(t){return Object(n["b"])({url:"/workContactTag/store",method:"post",data:t})}function m(t){return Object(n["b"])({url:"/workContactTag/contactTagList",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/roomClockIn/dayDetail",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/workContactTagGroup/store",method:"post",data:t})}function h(t){return Object(n["b"])({url:"/roomClockIn/batchContactTags",method:"put",data:t})}function g(t){return Object(n["b"])({url:"/officialAccount/index",method:"GET",params:t})}},"77de":function(t,e,a){"use strict";a("c03c")},"78f4":function(t,e,a){},8522:function(t,e,a){t.exports=a.p+"assets/avatar-room-default.67bead38.svg"},"981e":function(t,e,a){"use strict";a("78f4")},"9c58":function(t,e,a){},"9d3f":function(t,e,a){},a8e1:function(t,e,a){"use strict";a("5513")},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var n=a("06c5");function r(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(n["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(c)throw i}}}}},c03c:function(t,e,a){},ca9b:function(t,e,a){},dd26:function(t,e,a){"use strict";a("3ee7")},f40c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{staticClass:"top child_module",staticStyle:{"padding-bottom":"50px"},attrs:{gutter:0,type:"flex",justify:"space-between"}},[a("a-col",{attrs:{span:16}},[a("div",{staticClass:"left"},[a("div",{staticClass:"child_title"},[t._v("基本详情")]),a("div",{staticClass:"user_info"},[a("div",{staticClass:"item"},[a("span",[t._v("创建者：")]),a("div",{staticClass:"user"},[a("a-icon",{staticClass:"icon",attrs:{type:"user"}}),t._v(" "+t._s(t.seatInfoData.creator))],1)]),a("div",{staticClass:"item"},[a("span",[t._v("创建时间：")]),t._v(t._s(t.seatInfoData.createdAt))]),a("div",{staticClass:"item"},[a("span",[t._v("群发类型：")]),t.seatInfoData.filterParams?[t._v("筛选客户")]:[t._v("全部客户")]],2),a("div",{staticClass:"item",staticStyle:{display:"flex"}},[a("span",[t._v("群发消息：")]),t._l(t.seatInfoData.content,(function(e,n){return a("div",{key:n,staticStyle:{width:"570px"}},["text"===e.msgType?a("div",[t._v("群发消息1："+t._s(e.content))]):t._e(),"image"===e.msgType||"link"===e.msgType||"miniprogram"===e.msgType?a("div",{staticStyle:{"margin-top":"10px"}},[t._v("群发消息2：")]):t._e(),a("div",{staticStyle:{"margin-left":"15px","margin-top":"10px"}},["image"===e.msgType?a("div",[a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})]):t._e(),"link"==e.msgType?a("div",[a("div",[t._v(t._s(e.url))]),a("div",{staticStyle:{display:"flex"}},[a("div",[a("div",[t._v(t._s(e.title))]),a("div",[t._v(t._s(e.desc))])]),a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.pic_url,alt:""}})])]):t._e(),"miniprogram"==e.msgType?a("div",[a("div",{staticClass:"applets"},[a("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" ")]),a("div",{staticClass:"image"},[a("img",{staticStyle:{width:"100px"},attrs:{src:e.pic_url}})]),a("div",{staticClass:"applets-logo"},[t._v(" 小程序 ")])])]):t._e()])])}))],2)]),a("div",{staticClass:"obj"},[a("span",{staticClass:"title"},[t._v("群发对象：")]),a("div",{staticClass:"data"},[t.seatInfoData.filterParams?a("div",{staticClass:"item"},[a("p",{staticClass:"p"},[t._v("在 "),t._l(t.seatInfoData.filterParamsDetail.rooms,(function(e,n){return a("a-tag",{key:n},[t._v(t._s(e.name))])})),t._v(" 中，满足以下条件中的客户")],2),a("div",{staticClass:"sex"},[a("span",[t._v("性别：")]),1==t.seatInfoData.filterParamsDetail.gender?[t._v("全部性别")]:t._e(),2==t.seatInfoData.filterParamsDetail.gender?[t._v("男")]:t._e(),3==t.seatInfoData.filterParamsDetail.gender?[t._v("女")]:t._e(),4==t.seatInfoData.filterParamsDetail.gender?[t._v("未知性别")]:t._e()],2),a("div",{staticClass:"sex",staticStyle:{"margin-top":"-20px"}},[a("span",[t._v("标签：")]),t._l(t.seatInfoData.filterParamsDetail.tags,(function(e,n){return a("a-tag",{key:n},[t._v(t._s(e.name))])}))],2)]):a("a-tag",[t._v("全部客户")])],1)])])]),a("a-col",{staticClass:"msg_module",attrs:{span:7}},[a("div",{staticClass:"msg_title"},[t._v("客户收到的消息")]),a("m-preview",{ref:"preview"})],1)],1),a("a-row",{attrs:{gutter:0,type:"flex",justify:"space-between"}},[a("a-col",{attrs:{span:24}},[a("div",{staticClass:"child_module"},[a("div",{staticClass:"child_title"},[t._v("数据统计")]),a("a-row",{staticClass:"total",attrs:{type:"flex",gutter:20,justify:"space-between"}},[a("a-col",{staticClass:"item",attrs:{span:8}},[a("a-row",{staticClass:"total_module",attrs:{type:"flex",justify:"space-between"}},[a("a-col",{staticClass:"item item_hr",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.sendTotal))]),a("span",[t._v("人")]),a("p",[t._v("已发送成员")])]),a("a-col",{staticClass:"item",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.receivedTotal))]),a("span",[t._v("人")]),a("p",[t._v("送达用户")])])],1)],1),a("a-col",{staticClass:"item",attrs:{span:8}},[a("a-row",{staticClass:"total_module",attrs:{type:"flex",justify:"space-between"}},[a("a-col",{staticClass:"item item_hr",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.notSendTotal))]),a("span",[t._v("人")]),a("p",[t._v("未发送成员")])]),a("a-col",{staticClass:"item",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.notReceivedTotal))]),a("span",[t._v("人")]),a("p",[t._v("未送达客户")])])],1)],1),a("a-col",{staticClass:"item",attrs:{span:8}},[a("a-row",{staticClass:"total_module",attrs:{type:"flex",justify:"space-between"}},[a("a-col",{staticClass:"item item_hr",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.receiveLimitTotal))]),a("span",[t._v("人")]),a("p",[t._v("客户接受已达上限")])]),a("a-col",{staticClass:"item",attrs:{span:12}},[a("span",{staticStyle:{"font-size":"25px"}},[t._v(t._s(t.seatInfoData.notFriendTotal))]),a("span",[t._v("人")]),a("p",[t._v("因不是好友发送失败")])])],1)],1)],1)],1)])],1),a("a-row",{attrs:{gutter:7,type:"flex",justify:"space-between"}},[a("a-col",{attrs:{span:12}},[a("div",{staticClass:"child_module"},[a("div",{staticClass:"child_title"},[t._v("成员详情")]),a("a-tabs",{on:{change:t.tabMemberPanel},model:{value:t.memberAskData.sendStatus,callback:function(e){t.$set(t.memberAskData,"sendStatus",e)},expression:"memberAskData.sendStatus"}},[a("a-tab-pane",{key:0,attrs:{tab:"未发送成员"}}),a("a-tab-pane",{key:1,attrs:{tab:"已发送成员"}}),a("a-tab-pane",{key:2,attrs:{tab:"发送失败"}})],1),a("div",{staticClass:"search_module"},[a("div",{staticClass:"total_num"},[a("a-icon",{attrs:{type:"user"}}),t._v(" "),a("span",{staticClass:"text"},[t._v("共"+t._s(t.memberTable.data.length)+"人")])],1),a("a-input-search",{attrs:{placeholder:"请输入成员名称"},on:{search:t.searchMember,change:t.emptyMember},model:{value:t.memberAskData.keyWords,callback:function(e){t.$set(t.memberAskData,"keyWords",e)},expression:"memberAskData.keyWords"}})],1),a("a-table",{staticStyle:{"margin-top":"10px"},attrs:{columns:t.memberTable.columns,"data-source":t.memberTable.data},scopedSlots:t._u([{key:"name",fn:function(e,n){return a("div",{},[a("div",[a("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:n.employeeAvatar,alt:""}}),t._v(" "+t._s(n.employeeName)+" ")])])}},{key:"status",fn:function(e){return a("div",{},[0==e?a("a-tag",{attrs:{color:"gray"}},[t._v("未发送")]):t._e(),1==e?a("a-tag",{attrs:{color:"green"}},[t._v("已发送")]):t._e(),2==e?a("a-tag",{attrs:{color:"red"}},[t._v("发送失败")]):t._e()],1)}},{key:"operation",fn:function(e,n){return a("div",{},[a("a",{on:{click:function(e){return t.tipSend(n)}}},[t._v("提醒")])])}}])})],1)]),a("a-col",{attrs:{span:12}},[a("div",{staticClass:"child_module"},[a("div",{staticClass:"child_title"},[t._v("客户详情")]),a("a-tabs",{on:{change:t.tabClientPanel},model:{value:t.clientAskData.sendStatus,callback:function(e){t.$set(t.clientAskData,"sendStatus",e)},expression:"clientAskData.sendStatus"}},[a("a-tab-pane",{key:1,attrs:{tab:"已送达"}}),a("a-tab-pane",{key:0,attrs:{tab:"未送达客户","force-render":""}}),a("a-tab-pane",{key:3,attrs:{tab:"客户接收达上限","force-render":""}}),a("a-tab-pane",{key:2,attrs:{tab:"已不是好友客户","force-render":""}})],1),a("div",{staticClass:"search_module"},[a("div",{staticClass:"total_num"},[a("a-icon",{attrs:{type:"user"}}),t._v(" "),a("span",{staticClass:"text"},[t._v("共"+t._s(t.clientTable.data.length)+"人")])],1),a("a-input-search",{attrs:{placeholder:"请输入客户名称"},on:{search:t.searchCustomer,change:t.emptyCustomer},model:{value:t.clientAskData.keyWords,callback:function(e){t.$set(t.clientAskData,"keyWords",e)},expression:"clientAskData.keyWords"}})],1),a("a-table",{staticStyle:{"margin-top":"10px"},attrs:{columns:t.clientTable.columns,"data-source":t.clientTable.data},scopedSlots:t._u([{key:"name",fn:function(e,n){return a("div",{},[a("div",[a("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:n.contactAvatar,alt:""}}),t._v(" "+t._s(n.contactName)+" ")])])}},{key:"status",fn:function(e){return a("div",{},[0==e?a("a-tag",{attrs:{color:"gray"}},[t._v("未发送")]):t._e(),1==e?a("a-tag",{attrs:{color:"green"}},[t._v("已发送")]):t._e(),2==e?a("a-tag",{attrs:{color:"red"}},[t._v("因客户不是好友导致发送失败")]):t._e(),3==e?a("a-tag",{attrs:{color:"red"}},[t._v("因客户已经收到其他群发消息导致发送失败")]):t._e()],1)}}])})],1)])],1)],1)},r=[],s=(a("d3b7"),a("159b"),a("3d08")),i={components:{},data:function(){return{num:3,seatInfoData:{},memberAskData:{batchId:"",sendStatus:0,keyWords:""},memberTable:{columns:[{title:"成员",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"发送状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"发送数目",dataIndex:"sendContactTotal"},{title:"发送时间",dataIndex:"sendTime"},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],data:[]},clientAskData:{batchId:"",sendStatus:1,keyWords:""},clientTable:{columns:[{title:"客户",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"发送状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"发送时间",dataIndex:"sendTime"}],data:[]}}},created:function(){this.batchId=this.$route.query.batchId,this.getSeatData(this.batchId),this.memberAskData.batchId=this.batchId,this.clientAskData.batchId=this.batchId,this.getMemberData(),this.getClientData()},methods:{getSeatData:function(t){var e=this;Object(s["f"])({batchId:t}).then((function(t){e.seatInfoData=t.data,e.previewShow(e.seatInfoData.content)}))},previewShow:function(t){var e=this;this.$nextTick((function(){t.forEach((function(t){"text"==t.msgType&&e.$refs.preview.setText(t.content),"image"==t.msgType&&e.$refs.preview.setImage(t.pic_url),"link"==t.msgType&&e.$refs.preview.setLink(t.title,t.desc,t.pic_url),"miniprogram"==t.msgType&&e.$refs.preview.setApplets(t.title,t.pic_url)}))}))},tipSend:function(t){var e=this;Object(s["e"])({batchId:this.batchId}).then((function(t){e.$message.success("提醒成功")}))},searchMember:function(){this.getMemberData()},emptyMember:function(){""==this.memberAskData.keyWords&&this.getMemberData()},tabClientPanel:function(){this.clientAskData.keyWords="",this.getClientData()},searchCustomer:function(){this.getClientData()},emptyCustomer:function(){""==this.clientAskData.keyWords&&this.getClientData()},getClientData:function(){var t=this;Object(s["a"])(this.clientAskData).then((function(e){t.clientTable.data=e.data.list}))},tabMemberPanel:function(){this.memberAskData.keyWords="",this.getMemberData()},getMemberData:function(){var t=this;Object(s["c"])(this.memberAskData).then((function(e){t.memberTable.data=e.data.list}))}}},o=i,c=(a("77de"),a("2877")),l=Object(c["a"])(o,n,r,!1,null,null,null);e["default"]=l.exports},ff04:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-upload",{class:t.btnType?"avatar-uploader":"btn-type",attrs:{name:"file","list-type":"picture-card",headers:t.headers,method:"post","show-upload-list":!1,action:t.uploadApi,"before-upload":t.beforeUpload,accept:"image/*"},on:{change:t.handleChange}},[t.btnType?a("div",[t.imageUrl?a("div",{staticClass:"img-wrapper"},[a("img",{staticClass:"img",attrs:{src:t.imageUrl,alt:"avatar"}})]):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}})],1)]):a("a-button",{attrs:{type:"link"}},[t._v("重新上传")])],1)},r=[],s=(a("a9e3"),a("b0c0"),a("ac1f"),a("1276"),a("d81d"),a("99af"),a("caad"),a("2532"),a("a15b"),a("8ded")),i=a.n(s),o={model:{prop:"modelVal",event:"changeImg"},props:{fileType:{type:Number||Array,default:1},modelVal:{default:"",type:String},btnType:{type:Boolean,default:!0}},data:function(){return{loading:!1,imageUrl:"",FileTypeArr:["",["jpg","png","jpeg"],["mp3","amr"],["mp4"],["doc","docx","xls","xlsx","csv","ppt","pptx","txt","pdf","Xmind"]],uploadApi:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL+"/dashboard/common/upload"}},computed:{headers:function(){var t=i.a.get("ACCESS_TOKEN");return{Accept:"application/json",Authorization:t}}},created:function(){},methods:{showImg:function(t){this.imageUrl=t},handleChange:function(t){if("uploading"!==t.file.status){if("done"===t.file.status){var e=t.file.response.data;this.$emit("success",e),this.$emit("changeImg",e.path),this.imageUrl=e.fullPath,this.loading=!1}if("error"===t.file.status&&t.file.response){var a=t.file.response;this.$message.error(a.msg)}}else this.loading=!0},beforeUpload:function(t){var e=this,a=this._getFileSuffix(t.name).toLowerCase(),n=t.type.split("/")[0],r=t.size/1024/1024<2,s=t.size/1024/1024<10,i=[];this.fileType instanceof Array?this.fileType.map((function(t){i.concat(e.FileTypeArr[t])})):i=this.FileTypeArr[this.fileType];var o=i.includes(a);return o?"video"===n?(s||this.$message.error("上传文件过大"),o&&s):(r||this.$message.error("上传文件过大"),o&&r):(this.$message.error("您只能上传以下类型： ".concat(i.join(","))),!1)},_getFileSuffix:function(t){return t.substring(t.lastIndexOf(".")+1)}}},c=o,l=(a("dd26"),a("2877")),u=Object(l["a"])(c,n,r,!1,null,null,null);e["a"]=u.exports}}]);