(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auto-tag"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var s=a("6b75");function n(t,e){if(t){if("string"===typeof t)return Object(s["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(s["a"])(t,e):void 0}}},"0ab8":function(t,e,a){"use strict";a.d(e,"i",(function(){return n})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return c})),a.d(e,"e",(function(){return o})),a.d(e,"f",(function(){return l})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"c",(function(){return m}));var s=a("b775");function n(t){return Object(s["b"])({url:"/autoTag/store",method:"post",data:t})}function i(t){return Object(s["b"])({url:"/autoTag/index",method:"get",params:t})}function r(t){return Object(s["b"])({url:"/autoTag/destroy",method:"delete",data:t})}function c(t){return Object(s["b"])({url:"/autoTag/onOff",method:"put",data:t})}function o(t){return Object(s["b"])({url:"/autoTag/show",method:"get",params:t})}function l(t){return Object(s["b"])({url:"/autoTag/showContactKeyWord",method:"get",params:t})}function u(t){return Object(s["b"])({url:"/autoTag/showContactRoom",method:"get",params:t})}function d(t){return Object(s["b"])({url:"/autoTag/showContactTime",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/workMessage/index",method:"get",params:t})}},"0de9":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rules-details"},[a("a-card",[a("div",{staticClass:"title"},[t._v("基本信息")]),a("div",{staticClass:"information"},[a("div",{staticClass:"ifm-left"},[a("div",{staticClass:"name"},[a("span",[t._v("规则名称：")]),a("span",[t._v(t._s(t.auto_tag.name))])]),a("div",{staticClass:"member mt16"},[a("span",[t._v("打标签方式：")]),a("span",[t._v("根据客户入群行为")])]),a("div",{staticClass:"founder mt16"},[a("span",[t._v("创建者：")]),a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(t.auto_tag.nickname))],1)],1),a("div",{staticClass:"create-time mt16"},[a("span",[t._v("创建时间：")]),a("span",[t._v(t._s(t.auto_tag.createdAt))])]),a("div",{staticClass:"state mt16"},[a("span",[t._v("规则状态：")]),a("a-switch",{staticClass:"mr4",attrs:{size:"small",checked:1==t.auto_tag.onOff}}),t.auto_tag.onOff?a("span",[t._v("已开启")]):a("span",[t._v("已关闭")])],1)]),a("div",{staticClass:"ifm-right"},[a("div",{staticClass:"title-set"},[a("span",[t._v("规则设置：")]),a("span",{staticClass:"black"},[t._v("共"+t._s(t.tagRule.length)+"条规则")])]),t._l(t.tagRule,(function(e,s){return a("div",{key:s,staticClass:"set-content mt18 ml84"},[a("span",{staticClass:"title-small black"},[t._v("规则"+t._s(s+1))]),a("p",{staticClass:"keys ml4"},[t._v(" 用户加入群聊 "),t._l(e.rooms,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.name))])})),t._v(" 时，打上标签 "),t._l(e.tags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.tagname))])}))],2)])}))],2)])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"title"},[t._v("数据统计")]),a("div",{staticClass:"data-num"},[a("div",{staticClass:"data-box mb20"},[a("div",{staticClass:"data"},[a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.total_count))]),a("div",{staticClass:"desc"},[t._v("打标签总数")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.today_count))]),a("div",{staticClass:"desc"},[t._v("今日打标签数")])])])])])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"search"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"customer"},[a("span",[t._v("搜索用户：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入要搜索的客户","allow-clear":""},on:{search:t.searchUser,change:function(e){return t.emptyInput(0)}},model:{value:t.paramsTable.contact_name,callback:function(e){t.$set(t.paramsTable,"contact_name",e)},expression:"paramsTable.contact_name"}})],1),a("div",{staticClass:"customer-service ml20"},[a("span",[t._v("所属客服：")]),a("a-select",{staticStyle:{width:"160px"},attrs:{"default-value":"请选择客服"}},[a("a-select-option",{attrs:{value:"Home"}},[t._v("刘波")]),a("a-select-option",{attrs:{value:"Company"}},[t._v("小子")])],1)],1),a("div",{staticClass:"room-name ml20"},[a("span",[t._v("群聊名称：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入群聊名称","allow-clear":""},on:{search:t.searchGroup,change:function(e){return t.emptyInput(1)}},model:{value:t.paramsTable.room_name,callback:function(e){t.$set(t.paramsTable,"room_name",e)},expression:"paramsTable.room_name"}})],1),a("div",{staticClass:"add-time ml20"},[a("span",[t._v("加入群聊时间：")]),a("a-range-picker",{staticStyle:{width:"220px"},attrs:{allowClear:!0},on:{change:t.searchTime},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1),a("div",{staticClass:"join-mode"},[a("span",{staticClass:"ml20"},[t._v("入群方式：")]),a("a-select",{staticStyle:{width:"210px"},attrs:{placeholder:"请选择入群方式"},on:{change:t.joinGroupMode},model:{value:t.paramsTable.join_scene,callback:function(e){t.$set(t.paramsTable,"join_scene",e)},expression:"paramsTable.join_scene"}},[a("a-select-option",{attrs:{value:0}},[t._v("全部方式")]),a("a-select-option",{attrs:{value:1}},[t._v("群成员直接邀请入群")]),a("a-select-option",{attrs:{value:2}},[t._v("群成员通过链接邀请入群")]),a("a-select-option",{attrs:{value:3}},[t._v("通过扫描二维码入群")])],1)],1)]),a("div",{staticClass:"reset"},[a("a-button",{on:{click:t.resetTable}},[t._v("重置")])],1)]),a("div",{staticClass:"table-box mt36"},[a("div",{staticClass:"store-box mb20"},[a("span",{staticClass:"customers-title"},[t._v("共"+t._s(t.table.data.length)+"个用户")]),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticStyle:{cursor:"pointer"},on:{click:t.updateTable}},[a("a-icon",{attrs:{type:"redo"}}),t._v("更新数据")],1)],1),a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"employeeName",fn:function(e){return a("div",{},[a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e))],1)],1)}},{key:"roomName",fn:function(e){return a("div",{},[a("a-tag",[t._v(t._s(e))])],1)}},{key:"joinScene",fn:function(e){return a("div",{},[1==e?a("span",[t._v("成员邀请入群")]):t._e(),2==e?a("span",[t._v("邀请链接入群")]):t._e(),3==e?a("span",[t._v("扫描群二维码入群")]):t._e()])}}])},[a("div",{attrs:{slot:"operate"},slot:"operate"},[a("div",[a("a",[t._v("客户详情")])])])])],1)])])],1)},n=[],i=a("0ab8"),r={data:function(){return{selectDate:[],paramsTable:{contact_name:"",employee:"",room_name:"",start_time:"",end_time:"",page:1,perPage:15},auto_tag:{},tagRule:[],statistics:{},table:{col:[{key:"contactName",dataIndex:"contactName",title:"客户",scopedSlots:{customRender:"contactName"}},{key:"employeeName",dataIndex:"employeeName",title:"所属客服",scopedSlots:{customRender:"employeeName"}},{key:"roomName",dataIndex:"roomName",title:"用户添加群聊",scopedSlots:{customRender:"roomName"}},{key:"joinScene",dataIndex:"joinScene",title:"入群方式",scopedSlots:{customRender:"joinScene"}},{key:"joinTime",dataIndex:"joinTime",title:"加入群聊时间"},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]}}},created:function(){this.idRow=this.$route.query.idRow,this.paramsTable.id=this.idRow,this.getDetailsData(this.idRow),this.getTableData(this.paramsTable)},methods:{updateTable:function(){this.table.data=[],this.getTableData(this.paramsTable)},joinGroupMode:function(t){this.getTableData(this.paramsTable)},searchUser:function(){this.getTableData(this.paramsTable)},searchGroup:function(){this.getTableData(this.paramsTable)},emptyInput:function(t){0==t?""==this.paramsTable.contact_name&&this.getTableData(this.paramsTable):""==this.paramsTable.room_name&&this.getTableData(this.paramsTable)},searchTime:function(t,e){this.paramsTable.start_time=e[0],this.paramsTable.end_time=e[1],this.getTableData(this.paramsTable)},resetTable:function(){var t={id:this.idRow,page:1,perPage:15};this.selectDate=[],this.paramsTable=t,this.getTableData(this.paramsTable)},getTableData:function(t){var e=this;Object(i["g"])(t).then((function(t){e.table.data=t.data.list}))},getDetailsData:function(t){var e=this;Object(i["e"])({id:t}).then((function(t){e.auto_tag=t.data.auto_tag,e.tagRule=e.auto_tag.tagRule,e.statistics=t.data.statistics}))}}},c=r,o=(a("a4ee"),a("2877")),l=Object(o["a"])(c,s,n,!1,null,"659ec56c",null);e["default"]=l.exports},"0e64":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"select-group"},[s("a-modal",{attrs:{"on-ok":"handleOk",width:526,footer:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[s("template",{slot:"title"},[t._v(" 选择群聊 ")]),s("div",{staticClass:"content"},[s("div",{staticClass:"tips"},[t._v(" 全部群聊（"+t._s(t.groups.length)+"）： ")]),s("div",{staticClass:"groups"},t._l(t.groups,(function(e,n){return t.resetFlag?s("div",{key:n,staticClass:"item"},[s("div",{staticClass:"icon"},[s("img",{attrs:{src:a("8522")}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")]),s("div",{staticClass:"count"},[t._v(" "+t._s(e.contact_num)+" / "+t._s(e.roomMax)+" ")])]),s("div",[s("div",{staticClass:"select"},[t.resetFlag?s("a-checkbox",{attrs:{checked:e.select},on:{change:function(a){return t.selectChange(a,e)}}}):t._e()],1)])]):t._e()})),0),s("div",{staticClass:"confirm"},[s("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),s("a-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)])],2)],1)},n=[],i=a("b85c"),r=(a("d3b7"),a("159b"),a("4de4"),a("59e4")),c={data:function(){return{modalShow:!1,loading:!1,groups:[],currentData:{},resetFlag:!0}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.currentData=a,this.getData((function(a){e.reset(),e.groups.forEach((function(e){t.forEach((function(t){t.wxChatId===e.wxChatId&&(e.select=!0)}))}))})),this.modalShow=!0},selectChange:function(t,e){this.resetFlag=!1,e.select=t.target.checked,this.resetFlag=!0},confirm:function(){this.hide();var t=this.groups.filter((function(t){return!0===t.select}));this.$emit("change",t,this.currentData)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(r["o"])({roomGroupId:0,page:1,perPage:1e3}).then((function(a){t.groups=a.data,e&&e()}))},show:function(){this.getData(),this.reset(),this.modalShow=!0},hide:function(){this.modalShow=!1},reset:function(){var t,e=Object(i["a"])(this.groups);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(s){e.e(s)}finally{e.f()}}}},o=c,l=(a("2897"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,"b583576e",null);e["a"]=u.exports},1195:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAzCAYAAADsBOpPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAQrSURBVGhD7ZjbK21RFMbPP+l+SeRW7hS5veCFeEJur0S5xZN4EEUkIUpKvCCXouQaxum3m3M119pr7zPX2nsrHV+NdmuNMb7vs8295pjrj/ww/BpONf5vw09PT7KzsyPLy8syNTUV+eSa+8lCwobv7+9la2tLuru7JScnR9LS0qKC++Spoz4RJGR4fX1dmpubJTc319eoN6ijnr6wCGWYf/HCwoKvKSIrK0vy8/Mjn355gv4wSyWU4ZGRkSgzeXl50tnZKXNzc5FvkLXLJ9fcJ2/W0w9PUAQ2PD8/7xLWsbGxIZ+fn6rKDe6T9+uDLwgCGT45OYkSZE2enp6qivigjnovB7y2sDb8/v4ug4ODLqGKigq5urpSFXagnj6TB174bWBt+ObmRqqrqx0RflRHR0cqGwz00a+54IXfBtaG9/b2JDs72xGZmJhQmXCgX3PBC78NrA0PDQ05ApmZmXJ2dqYy4UA/PJoTfhtYG25vb3fIy8vLA69dL+iHR3PCbwNrw0VFRQ55XV2d3N3dqUw40A+P5oTfBtaGCwoKHPLa2lq5vb1VmXCgHx7NCb8NrA03NjY65CUlJXJxcaEy4UA/PJoTfhtYG+7t7XXIicPDQ5UJB/pNPvhtYG14ZWVF0tPTHYGxsTGVCQf6NRe88NvA2vD19bVUVVU5IoyKYb9l+syRFF74bWBt+O3tTfr7+x0RIllbM7zw28DaMDg/P5fi4mKXWKLDD3zw2iKQYbC5uekS1BF2vIQvCAIbBjMzM1EDOddtbW0yOjoayXMA5ZNr7vvVkw+KUIZZb0tLSy4DQYN+23VrIpRhRsHFxUUpLCz0NWMTAwMDoeaRQIYxOj09LTU1NZKRkeFrJEiUlZXJ5OSk9SwMrA0/PDxIS0uLrzDBw58nQF9fX2RT4EUKn1xz39x0vAEv/DawMsxw3dTUFCXEqaGnp0dWV1f/OQyRp45687ShA36bIf6fhnd3d33XakdHR0Tg+flZVdqBevro93Kig148xDXMzOrdldhSx8fH5eXlRVWFA/3weN8aoRdv1o5pmL29oaHBRVZfXy/b29sxN4iggAc+eE0ddGPNFjEN81A3SRiwDw4OVDa5gNc8IBCxNhVfw/xLvH81j7Ovry9VkVzAC7+ph77f0vA1zKZgnmi7urrk9fVVZVMD+NHRmujjw4sow7yBqaysdBo5HB4fH6tsaoGOedjFh/eNUJRh1pNuIILMqonCb+b2/m6iDA8PD7samLq+E+iZ+vgx4TL8+PjoOnoTib7hCQr0TH384EvDZZjJv7S01ClmC/34+FDZ7wF65taNH/NE4jK8v7/veh62traqzPcCXe0BP/jScBleW1tzPc686+e7YP6O8IMvDZfhy8tLmZ2djYyGhO3Il2ygqz0Q5iHXZfgn4NdwqvFrONX4YYZF/gKB6bB2CTcbPgAAAABJRU5ErkJggg=="},"14f8":function(t,e,a){},"1aec":function(t,e,a){"use strict";a("ba6a")},2263:function(t,e,a){"use strict";a("9c58")},2897:function(t,e,a){"use strict";a("9d3f")},"2ee5":function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"g",(function(){return i})),a.d(e,"e",(function(){return r})),a.d(e,"f",(function(){return c})),a.d(e,"a",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return u})),a.d(e,"b",(function(){return d})),a.d(e,"c",(function(){return m})),a.d(e,"l",(function(){return p})),a.d(e,"k",(function(){return h})),a.d(e,"j",(function(){return f}));var s=a("b775");function n(t){return Object(s["b"])({url:"/channelCodeGroup/index",method:"get",params:t})}function i(t){return Object(s["b"])({url:"/channelCodeGroup/update",method:"put",data:t})}function r(t){return Object(s["b"])({url:"/channelCodeGroup/store",method:"post",data:t})}function c(t){return Object(s["b"])({url:"/channelCodeGroup/move",method:"put",data:t})}function o(t){return Object(s["b"])({url:"/channelCode/store",method:"post",data:t})}function l(t){return Object(s["b"])({url:"/channelCode/update",method:"put",data:t})}function u(t){return Object(s["b"])({url:"/channelCode/index",method:"get",params:t})}function d(t){return Object(s["b"])({url:"/channelCode/contact",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/channelCode/show",method:"get",params:t})}function p(t){return Object(s["b"])({url:"/channelCode/statisticsIndex",method:"get",params:t})}function h(t){return Object(s["b"])({url:"/channelCode/statistics",method:"get",params:t})}function f(t){return Object(s["b"])({url:"/workDepartment/index",method:"get",params:t})}},4253:function(t,e,a){"use strict";a("f1a5")},"444c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("div",{staticClass:"tag-box"},[a("div",{staticClass:"page_top"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/autoTag/keywordCreate")}}},[t._v("添加规则")]),a("div",{staticClass:"search_term"},[a("div",{staticClass:"choice_tags"},[a("span",[t._v("客户标签：")]),a("div",{staticClass:"showTagsBox",on:{click:t.showModel}},[0==t.selectTags.length?a("span",{staticClass:"showTagTips"},[t._v("请选择标签")]):a("div",t._l(t.selectTags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.name))])})),1)])]),a("selectTags",{ref:"popupRef",on:{onChange:t.acceptData}}),a("div",{},[a("span",[t._v("搜索规则：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规则名称搜索","allow-clear":""},on:{search:t.searchRuleName,change:t.emptyRule},model:{value:t.searchRuleData,callback:function(e){t.searchRuleData=e},expression:"searchRuleData"}})],1)],1)],1),a("div",{staticClass:"rule-list"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"fuzzy_match_keyword",fn:function(e){return""!=e?a("div",{},t._l(e,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1):t._e()}},{key:"exact_match_keyword",fn:function(e){return""!=e?a("div",{},t._l(e,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1):t._e()}},{key:"tags",fn:function(e){return a("div",{},t._l(e,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1)}},{key:"on_off",fn:function(e,s){return a("div",{},[a("a-switch",{attrs:{size:"small",defaultChecked:1==e},on:{change:function(e){return t.openSwitch(e,s)}}}),a("span",1==e?[t._v("已开启")]:[t._v("已关闭")])],1)}},{key:"operate",fn:function(e,s){return a("div",{},[a("span",[a("a",{on:{click:function(e){return t.$router.push("/autoTag/keywordShow?idRow="+s.id)}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.deltableRow(s)}}},[t._v("删除")])],1)])}}],null,!0)})],1)])])},n=[],i=(a("d3b7"),a("159b"),a("a434"),a("0ab8")),r=a("5588"),c={components:{selectTags:r["a"]},data:function(){return{selectTags:[],table:{col:[{key:"name",dataIndex:"name",title:"规则名称"},{key:"mark_tag_count",dataIndex:"mark_tag_count",title:"已打标签数"},{key:"fuzzy_match_keyword",dataIndex:"fuzzy_match_keyword",title:"模糊匹配",scopedSlots:{customRender:"fuzzy_match_keyword"}},{key:"exact_match_keyword",dataIndex:"exact_match_keyword",title:"精准匹配",scopedSlots:{customRender:"exact_match_keyword"}},{key:"tags",dataIndex:"tags",title:"添加的标签",scopedSlots:{customRender:"tags"}},{key:"created_at",dataIndex:"created_at",title:"创建时间"},{key:"on_off",dataIndex:"on_off",title:"规则状态",scopedSlots:{customRender:"on_off"}},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]},typeTable:1,searchRuleData:"",tagsParamArr:[],showPopup:!1}},created:function(){this.getTableData({type:this.typeTable})},methods:{openSwitch:function(t,e){e.on_off=t?1:2,Object(i["d"])({id:e.id,on_off:e.on_off}).then((function(t){}))},showModel:function(){this.$refs.popupRef.show(this.selectTags)},acceptData:function(t){var e=this;this.tagsParamArr=[],t.forEach((function(t,a){e.tagsParamArr[a]=t.id})),this.selectTags=t,this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},deltableRow:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){var a=e.table.data.indexOf(t);Object(i["a"])({id:t.id}).then((function(t){e.$message.success("删除成功"),e.table.data.splice(a,1)}))}})},emptyRule:function(t){""==this.searchRuleData&&this.getTableData({type:this.typeTable})},searchRuleName:function(){this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},getTableData:function(t){var e=this;Object(i["b"])(t).then((function(t){e.table.data=t.data.list}))}}},o=c,l=(a("1aec"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,"93cdd0f4",null);e["default"]=u.exports},"4a04":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"details"},[a("a-modal",{attrs:{"on-ok":"handleOk",width:636,footer:!1,centered:"",maskClosable:!1},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v(" 选择成员 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"left-content"},[a("div",{staticClass:"tips"},[t._v(" 没有想要添加的成员？ "),a("a",{attrs:{href:"#"}},[t._v("添加成员教程")])]),a("div",{staticClass:"search"},[a("a-input-search",{attrs:{placeholder:"请输入成员昵称"},on:{search:t.search}})],1),a("div",{staticClass:"member"},t._l(t.members,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])]),a("div",{staticClass:"radio"},[a("a-checkbox",{on:{change:function(a){return t.selectChange(e)}},model:{value:e.select,callback:function(a){t.$set(e,"select",a)},expression:"v.select"}})],1)])})),0)]),a("div",{staticClass:"right-content"},[a("div",{staticClass:"tips"},[t._v(" 已选成员：（"+t._s(t.selectedMembers.length)+"） ")]),a("div",{staticClass:"member"},t._l(t.selectedMembers,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("div",{staticClass:"user-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.avatar}})]),a("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")])])])})),0)])]),a("div",{staticClass:"confirm"},[a("a-button",{on:{click:function(e){t.modalShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.go}},[t._v("确定")])],1)],2)],1)},n=[],i=a("b85c"),r=(a("d3b7"),a("159b"),a("4de4"),a("a434"),a("2ee5")),c={data:function(){return{modalShow:!1,loading:!1,members:[],selectedMembers:[],currentData:{}}},methods:{setSelect:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.selectedMembers=[],t.forEach((function(t,a){e.selectedMembers[a]=t})),this.currentData=a,this.getData("",(function(t){e.selectedMembers.forEach((function(t){e.members.forEach((function(e){t.wxUserId===e.wxUserId&&(t.avatar||(t.avatar=e.avatar),e.select=!0)}))}))})),this.reset(),this.modalShow=!0},search:function(t){this.getData(t)},selectChange:function(t){var e=-1,a=this.selectedMembers.filter((function(a,s){if(a.id===t.id)return e=s,a}));if(a.length)return this.selectedMembers.splice(e,1),!1;this.selectedMembers.push(t)},reset:function(){var t,e=Object(i["a"])(this.members);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.select=!1}}catch(s){e.e(s)}finally{e.f()}},go:function(){this.hide(),this.$emit("change",this.selectedMembers)},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(r["j"])({searchKeyWords:e}).then((function(e){t.members=e.data.employee,a&&a()}))},show:function(){this.getData(),this.reset(),this.selectedMembers=[],this.modalShow=!0},hide:function(){this.modalShow=!1}}},o=c,l=(a("2263"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,"24741dee",null);e["a"]=u.exports},"4dbc":function(t,e,a){"use strict";a("6691")},"502a":function(t,e,a){},"51a2c":function(t,e,a){"use strict";a("502a")},5588:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tagselectPopup"},[a("a-modal",{attrs:{title:"选择标签",maskClosable:!1,footer:null},model:{value:t.showTagsPopup,callback:function(e){t.showTagsPopup=e},expression:"showTagsPopup"}},[a("a-input-search",{attrs:{placeholder:"请输入企业标签",allowClear:""},on:{search:t.seekTags,change:t.emptyInput},model:{value:t.seekClientTags,callback:function(e){t.seekClientTags=e},expression:"seekClientTags"}}),t._l(t.groupsData,(function(e,s){return 0!=t.groupsData.length?a("div",{key:s,staticClass:"tagsGroup"},[a("div",{staticClass:"groupTitle"},[t._v(t._s(e.groupName))]),a("div",{staticClass:"groupRow"},t._l(e.tags,(function(e,s){return a("a-tag",{key:s,class:t.getActiveClass(e),on:{click:function(a){return t.addTagsContent(e)}}},[t._v(" "+t._s(e.name)+" ")])})),1)]):t._e()})),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.groupsData.length,expression:"groupsData.length==0"}],staticClass:"emptyTips"},[a("Empty")],1),a("div",{staticClass:"footRowBtns"},[a("a-button",{staticClass:"footRow_btn",on:{click:t.closePopup}},[t._v("取消")]),a("a-button",{staticClass:"footRow_btn",attrs:{type:"primary"},on:{click:t.castArray}},[t._v("保存")])],1)],2)],1)},n=[],i=a("b85c"),r=(a("06f4"),a("fc25")),c=(a("d3b7"),a("159b"),a("a434"),a("7728")),o={components:{Empty:r["a"]},beforeCreate:function(){this.simpleImage=r["a"].PRESENTED_IMAGE_SIMPLE},props:["controlPopup"],data:function(){return{showTagsPopup:!1,seekClientTags:"",groupsData:[],selectTagsArray:[]}},watch:{},created:function(){this.getTagsData()},methods:{addTagsContent:function(t){var e=[];this.selectTagsArray.forEach((function(t,a){e[a]=t.id}));var a=e.indexOf(t.id);-1==a?this.selectTagsArray.push(t):this.selectTagsArray.splice(a,1)},getActiveClass:function(t){var e,a=Object(i["a"])(this.selectTagsArray);try{for(a.s();!(e=a.n()).done;){var s=e.value;if(s.id===t.id)return{selectTagsStyle:!0}}}catch(n){a.e(n)}finally{a.f()}return{selectTagsStyle:!1}},show:function(t){var e=this;this.showTagsPopup=!0,this.selectTagsArray=[],t.forEach((function(t,a){e.selectTagsArray[a]=t}))},closePopup:function(){this.showTagsPopup=!1},getTagsData:function(t){var e=this;Object(c["d"])(t).then((function(t){e.groupsData=t.data}))},seekTags:function(){this.getTagsData({name:this.seekClientTags})},emptyInput:function(){""==this.seekClientTags&&this.getTagsData()},castArray:function(){this.showTagsPopup=!1,this.$emit("onChange",this.selectTagsArray)}}},l=o,u=(a("4dbc"),a("2877")),d=Object(u["a"])(l,s,n,!1,null,null,null);e["a"]=d.exports},"59e4":function(t,e,a){"use strict";a.d(e,"C",(function(){return n})),a.d(e,"k",(function(){return i})),a.d(e,"i",(function(){return r})),a.d(e,"x",(function(){return c})),a.d(e,"D",(function(){return o})),a.d(e,"u",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"y",(function(){return d})),a.d(e,"A",(function(){return m})),a.d(e,"l",(function(){return p})),a.d(e,"t",(function(){return h})),a.d(e,"s",(function(){return f})),a.d(e,"B",(function(){return v})),a.d(e,"e",(function(){return g})),a.d(e,"c",(function(){return _})),a.d(e,"d",(function(){return b})),a.d(e,"z",(function(){return y})),a.d(e,"b",(function(){return k})),a.d(e,"w",(function(){return C})),a.d(e,"q",(function(){return T})),a.d(e,"o",(function(){return w})),a.d(e,"v",(function(){return x})),a.d(e,"a",(function(){return A})),a.d(e,"n",(function(){return D})),a.d(e,"j",(function(){return R})),a.d(e,"p",(function(){return S})),a.d(e,"g",(function(){return I})),a.d(e,"h",(function(){return j})),a.d(e,"m",(function(){return O})),a.d(e,"r",(function(){return P}));var s=a("b775");function n(t){return Object(s["b"])({url:"/workRoomGroup/index",method:"get",params:t})}function i(t){return Object(s["b"])({url:"/workRoomGroup/destroy",method:"delete",data:t})}function r(t){return Object(s["b"])({url:"/workRoomGroup/store",method:"post",data:t})}function c(t){return Object(s["b"])({url:"/workRoomGroup/update",method:"put",data:t})}function o(t){return Object(s["b"])({url:"/workRoom/index",method:"get",params:t})}function l(t){return Object(s["b"])({url:"/workRoom/syn",method:"put",data:t})}function u(t){return Object(s["b"])({url:"/workRoom/batchUpdate",method:"put",data:t})}function d(t){return Object(s["b"])({url:"/workContactRoom/index",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/workEmployeeDepartment/memberIndex",method:"get",params:t})}function p(t){return Object(s["b"])({url:"/workDepartment/index",method:"get",params:t})}function h(t){return Object(s["b"])({url:"/workRoom/statisticsIndex",method:"get",params:t})}function f(t){return Object(s["b"])({url:"/workRoom/statistics",method:"get",params:t})}function v(t){return Object(s["b"])({url:"/workRoomAutoPull/index",method:"get",params:t})}function g(t){return Object(s["b"])({url:"/workRoomAutoPull/update",method:"put",data:t})}function _(t){return Object(s["b"])({url:"/workRoomAutoPull/store",method:"post",data:t})}function b(t){return Object(s["b"])({url:"/workRoomAutoPull/show",method:"get",params:t})}function y(t){return Object(s["b"])({url:"/workContactTagGroup/index",method:"get",params:t})}function k(t){return Object(s["b"])({url:"/workContactTag/store",method:"post",data:t})}function C(t){return Object(s["b"])({url:"/workContactTag/allTag",method:"get",params:t})}function T(t){return Object(s["b"])({url:"/workRoom/roomIndex",method:"get",params:t})}function w(t){return Object(s["b"])({url:"/roomTagPull/roomList",method:"get",params:t})}function x(t){return Object(s["b"])({url:"/roomTagPull/index",method:"get",params:t})}function A(t){return Object(s["b"])({url:"/roomTagPull/store",method:"POST",data:t})}function D(t){return Object(s["b"])({url:"/roomTagPull/show",method:"GET",params:t})}function R(t){return Object(s["b"])({url:"/roomTagPull/destroy",method:"DELETE",data:t})}function S(t){return Object(s["b"])({url:"/roomTagPull/remindSend",method:"GET",params:t})}function I(t){return Object(s["b"])({url:"/roomTagPull/chooseContact",method:"GET",params:t})}function j(t){return Object(s["b"])({url:"/roomTagPull/filterContact",method:"POST",data:t})}function O(t){return Object(s["b"])({url:"/roomTagPull/showContact",method:"GET",params:t})}function P(t){return Object(s["b"])({url:"/contactMessageBatchSend/showRoom",method:"GET",params:t})}},"5b13":function(t,e,a){},"5eb3":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rules-details"},[a("a-card",[a("div",{staticClass:"title"},[t._v("基本信息")]),a("div",{staticClass:"information"},[a("div",{staticClass:"ifm-left"},[a("div",{staticClass:"name"},[a("span",[t._v("规则名称：")]),a("span",[t._v(t._s(t.auto_tag.name))])]),a("div",{staticClass:"member mt16"},[a("span",[t._v("打标签方式：")]),a("span",[t._v("根据客户成为企业微信客户时间段")])]),a("div",{staticClass:"founder mt16"},[a("span",[t._v("创建者：")]),a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(t.auto_tag.nickname))],1)],1),a("div",{staticClass:"add-tag mt16"},[a("span",[t._v("生效成员：")]),a("span",t._l(t.auto_tag.employees,(function(e,s){return a("a-tag",{key:s},[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e.name))],1)})),1)]),a("div",{staticClass:"create-time mt16"},[a("span",[t._v("创建时间：")]),a("span",[t._v(t._s(t.auto_tag.createdAt))])]),a("div",{staticClass:"auto mt16"},[a("span",[t._v("自动添加标签：")]),t._l(t.auto_tag.tags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])}))],2),a("div",{staticClass:"state mt16"},[a("span",[t._v("规则状态：")]),a("a-switch",{staticClass:"mr4",attrs:{size:"small",checked:1==t.auto_tag.onOff}}),t.auto_tag.onOff?a("span",[t._v("已开启")]):a("span",[t._v("已关闭")])],1)]),a("div",{staticClass:"ifm-right"},[a("div",{staticClass:"title-set"},[a("span",[t._v("规则设置：")]),a("span",{staticClass:"black"},[t._v(" 共"+t._s(t.tagRule.length)+"条规则 ")])]),t._l(t.tagRule,(function(e,s){return a("div",{key:s,staticClass:"set-content mt18 ml84"},[a("span",{staticClass:"title-small black"},[t._v("规则"+t._s(s+1))]),a("p",{staticClass:"keys ml4"},[t._v("客户在 每 "),1==e.time_type?a("span",[t._v("天")]):t._e(),2==e.time_type?a("span",[t._v("周")]):t._e(),3==e.time_type?a("span",[t._v("月")]):t._e(),t._v(" 的 "),2==e.time_type?t._l(e.schedule,(function(e){return a("span",{key:e},[t._v(t._s(t.weekData[e].value))])})):t._e(),3==e.time_type?t._l(e.schedule,(function(e){return a("span",{key:e},[t._v(t._s(t.monthData[e].value))])})):t._e(),t._v(" 【"+t._s(e.start_time)+"-"+t._s(e.end_time)+"】 内添加生效成员时， 将会被自动打上 "),t._l(e.tags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.tagname))])})),t._v(" 标签")],2)])}))],2)])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"title"},[t._v("数据统计")]),a("div",{staticClass:"data-num"},[a("div",{staticClass:"data-box mb20"},[a("div",{staticClass:"data"},[a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.total_count))]),a("div",{staticClass:"desc"},[t._v("打标签总数")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.today_count))]),a("div",{staticClass:"desc"},[t._v("今日打标签数")])])])])])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"search"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"customer"},[a("span",[t._v("搜索用户：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入要搜索的客户","allow-clear":""},on:{search:t.searchUser,change:t.emptyInput},model:{value:t.paramsTable.contact_name,callback:function(e){t.$set(t.paramsTable,"contact_name",e)},expression:"paramsTable.contact_name"}})],1),a("div",{staticClass:"customer-service ml20"},[a("span",[t._v("所属客服：")]),a("a-select",{staticStyle:{width:"160px"},attrs:{"default-value":"请选择客服"}},[a("a-select-option",{attrs:{value:"Home"}},[t._v("刘波")]),a("a-select-option",{attrs:{value:"Company"}},[t._v("小子")])],1)],1),a("div",{staticClass:"join-mode"},[a("span",{staticClass:"ml20"},[t._v("规则筛选：")]),a("a-select",{staticStyle:{width:"180px"},attrs:{"default-value":"请选择规则"}},[a("a-select-option",{attrs:{value:"1"}},[t._v(" 规则一 ")]),a("a-select-option",{attrs:{value:"2"}},[t._v(" 规则二 ")])],1)],1),a("div",{staticClass:"add-time ml20"},[a("span",[t._v("添加好友时间：")]),a("a-range-picker",{staticStyle:{width:"220px"},attrs:{allowClear:!0},on:{change:t.searchTime},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1)]),a("div",{staticClass:"reset"},[a("a-button",{on:{click:t.resetTable}},[t._v("重置")])],1)]),a("div",{staticClass:"table-box mt36"},[a("div",{staticClass:"store-box mb20"},[a("span",{staticClass:"customers-title"},[t._v("共"+t._s(t.table.data.length)+"个客户")]),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticStyle:{cursor:"pointer"},on:{click:t.updateTable}},[a("a-icon",{attrs:{type:"redo"}}),t._v("更新数据")],1)],1),a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"employeeName",fn:function(e){return a("div",{},[a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e))],1)],1)}},{key:"tagRuleId",fn:function(e){return a("div",{},[a("a-tag",[t._v("规则"+t._s(e))])],1)}},{key:"operate",fn:function(e,s){return a("div",{},[a("div",[a("a",{on:{click:function(e){return t.clientDetails(s)}}},[t._v("客户详情")])])])}}])})],1)])])],1)},n=[],i=a("0ab8"),r={data:function(){return{weekData:[{key:"0",value:"周日"},{key:"1",value:"周一"},{key:"2",value:"周二"},{key:"3",value:"周三"},{key:"4",value:"周四"},{key:"5",value:"周五"},{key:"6",value:"周六"}],monthData:[{key:"1",value:"1号"},{key:"2",value:"2号"},{key:"3",value:"3号"},{key:"4",value:"4号"},{key:"5",value:"5号"},{key:"6",value:"6号"},{key:"7",value:"7号"},{key:"8",value:"8号"},{key:"9",value:"9号"},{key:"10",value:"10号"},{key:"11",value:"11号"},{key:"12",value:"12号"},{key:"13",value:"13号"},{key:"14",value:"14号"},{key:"15",value:"15号"},{key:"16",value:"16号"},{key:"17",value:"17号"},{key:"18",value:"18号"},{key:"19",value:"19号"},{key:"20",value:"20号"},{key:"21",value:"21号"},{key:"22",value:"22号"},{key:"23",value:"23号"},{key:"24",value:"24号"},{key:"25",value:"25号"},{key:"26",value:"26号"},{key:"27",value:"27号"},{key:"28",value:"28号"},{key:"29",value:"29号"},{key:"30",value:"30号"},{key:"31",value:"31号"},{key:"32",value:"32号"}],auto_tag:[],tagRule:[],statistics:[],selectDate:[],paramsTable:{contact_name:"",employee:"",start_time:"",end_time:"",page:1,perPage:15},table:{col:[{key:"contactName",dataIndex:"contactName",title:"客户",scopedSlots:{customRender:"contactName"}},{key:"employeeName",dataIndex:"employeeName",title:"所属客服",scopedSlots:{customRender:"employeeName"}},{key:"tagRuleId",dataIndex:"tagRuleId",title:"生效规则",scopedSlots:{customRender:"tagRuleId"}},{key:"createdAt",dataIndex:"createdAt",title:"添加好友时间"},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]}}},created:function(){this.idRow=this.$route.query.idRow,this.paramsTable.id=this.idRow,this.getDetailsData(this.idRow),this.getTableData(this.paramsTable)},methods:{searchTime:function(t,e){this.paramsTable.start_time=e[0],this.paramsTable.end_time=e[1],this.getTableData(this.paramsTable)},resetTable:function(){var t={id:this.idRow,page:1,perPage:15};this.selectDate=[],this.paramsTable=t,this.getTableData(this.paramsTable)},emptyInput:function(){""==this.paramsTable.contact_name&&this.getTableData(this.paramsTable)},searchUser:function(){this.getTableData(this.paramsTable)},updateTable:function(){this.table.data=[],this.getTableData(this.paramsTable)},clientDetails:function(t){},getTableData:function(t){var e=this;Object(i["h"])(t).then((function(t){e.table.data=t.data.list}))},getDetailsData:function(t){var e=this;Object(i["e"])({id:t}).then((function(t){e.auto_tag=t.data.auto_tag,e.tagRule=e.auto_tag.tagRule,e.statistics=t.data.statistics}))}}},c=r,o=(a("51a2c"),a("2877")),l=Object(o["a"])(c,s,n,!1,null,"080b9a25",null);e["default"]=l.exports},6010:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tagsModal"},[a("a-modal",{staticClass:"modelCard",attrs:{title:"选择标签",maskClosable:!1},on:{ok:t.handleOk},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[t._l(t.lableArr,(function(e,s){return a("div",{key:s,staticClass:"labelRow"},[a("div",{staticClass:"labelTitle"},[t._v(t._s(e.groupName))]),a("div",{staticClass:"labelContent"},[a("div",{staticClass:"labeladdBtn",on:{click:function(a){t.showInput=e.id}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加 ")],1),t.showInput==e.id?a("a-input",{staticClass:"lable_input",attrs:{placeholder:"输入后回车"},on:{blur:t.closeInput,pressEnter:function(a){return t.inputLable(e.id,s)}},model:{value:t.addlableCont,callback:function(e){t.addlableCont=e},expression:"addlableCont"}}):t._e(),t._l(e.tags,(function(e,s){return a("div",{key:s,ref:"hello",refInFor:!0,staticClass:"labelSub",class:[-1!=t.choiceTagsArr.indexOf(e)?"lableSelect":""],on:{click:function(a){return t.selectTags(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)])})),a("span",{staticClass:"add_tags",on:{click:t.addNametags}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 新建标签组 ")],1)],2),a("a-modal",{attrs:{title:"新建标签组"},on:{ok:t.handleNewTags},model:{value:t.addNewTags,callback:function(e){t.addNewTags=e},expression:"addNewTags"}},[a("div",{staticClass:"add_tigs"},[a("a-icon",{attrs:{type:"bell",theme:"filled"}}),t._v(" 管理员可根据不同部门选择展示不同的标签组，部门管理员可创建部门可见的标签 ")],1),a("a-form-model",{attrs:{model:t.tagsform,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{attrs:{label:"标签组名称"}},[a("a-input",{attrs:{placeholder:"请输入标签组名称"},model:{value:t.tagsform.name,callback:function(e){t.$set(t.tagsform,"name",e)},expression:"tagsform.name"}})],1)],1)],1)],1)},n=[],i=a("1da1"),r=(a("96cf"),a("a434"),a("d3b7"),a("159b"),a("b0c0"),a("7728")),c={data:function(){return{modalShow:!1,addNewTags:!1,showInput:0,addlableCont:"",lableArr:[],labelCol:{span:5},wrapperCol:{span:18},tagsform:{name:"",resource:1,selectSection:[]},tipsWarn:!0,choiceTagsArr:[]}},created:function(){this.getClientTags()},methods:{getClientTags:function(){var t=this;Object(r["d"])({page:1,perPage:10}).then((function(e){t.lableArr=e.data}))},selectTags:function(t){var e=this.choiceTagsArr.indexOf(t);-1==e?this.choiceTagsArr.push(t):this.choiceTagsArr.splice(e,1)},memberSelectChange:function(t){this.tagsform.selectSection=t},show:function(t){var e=this;this.choiceTagsArr=[],void 0!=t&&t.forEach((function(t,a){e.choiceTagsArr[a]=t})),this.modalShow=!0},delSelect:function(t){this.tagsform.selectSection.splice(t,1)},handleOk:function(t){this.modalShow=!1,this.$emit("choiceTagsArr",this.choiceTagsArr)},handleNewTags:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=t.tagsform.name){e.next=3;break}return t.$message.warning("标签组名称不能为空"),e.abrupt("return");case 3:Object(r["j"])({groupName:t.tagsform.name}).then((function(e){t.getClientTags(),t.tagsform.name="",t.$message.success("创建成功"),t.addNewTags=!1}));case 4:case"end":return e.stop()}}),e)})))()},closeInput:function(){this.showInput=!1},inputLable:function(t,e){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,i,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n=[],n.push(a.addlableCont),i={groupId:t,tagName:n},s.next=5,Object(r["l"])(i).then((function(t){}));case 5:c={name:a.addlableCont},a.lableArr[e].tags.push(c),a.showInput=!1,a.addlableCont="";case 9:case"end":return s.stop()}}),s)})))()},addNametags:function(){this.addNewTags=!0}}},o=c,l=(a("981e"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,null,null);e["a"]=u.exports},6691:function(t,e,a){},"68af":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rule-box"},[a("a-card",[a("div",{staticClass:"set-keywords"},[a("div",{staticClass:"title"},[t._v(" 规则基础信息 ")]),a("div",{staticClass:"content mt22"},[a("div",{staticClass:"mode elastic"},[a("span",{staticClass:"tip-gray"},[t._v("根据规则，当客户在设定时间段内成为企业微信客户，将自动被打上标签")])]),a("div",{staticClass:"mode elastic mt24"},[a("span",[t._v("规则名称：")]),a("div",{staticClass:"add-key"},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写规则名称，仅内部可见"},model:{value:t.formAskData.name,callback:function(e){t.$set(t.formAskData,"name",e)},expression:"formAskData.name"}})],1)]),a("div",{staticClass:"mode elastic mt24"},[a("span",[t._v("生效成员：")]),a("div",{staticClass:"btn"},[a("a-dropdown",[a("a-button",{staticStyle:{"margin-left":"8px",width:"180px"},on:{click:function(e){return t.$refs.selectMember.setSelect(t.showSelectStaff)}}},[t._v(" 选择生效成员"),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),a("selectMember",{ref:"selectMember",on:{change:t.effectStaff}})],1),a("div",{staticClass:"memberRow"},t._l(t.showSelectStaff,(function(e,s){return a("div",{key:s,staticClass:"tags"},[t._v(" "+t._s(e.name)+" "),a("span",{staticClass:"closeIcon",on:{click:function(e){return t.delIconSpan(s)}}},[a("a-icon",{attrs:{type:"close"}})],1)])})),0)])]),a("div",{staticClass:"automatic mt50"},[a("div",{staticClass:"title"},[t._v("设置打标签规则")]),a("div",{staticClass:"content mt30"},[a("div",{staticClass:"task"},[t._l(t.tag_rule,(function(e,s){return a("div",{key:s,staticClass:"task-padding"},[a("div",{staticClass:"task-content"},[t._v(" 规则"+t._s(s+1)+"：为每 "),a("div",{staticClass:"task-content ml4 mr4"},[a("a-select",{staticStyle:{width:"65px"},on:{change:function(e){return t.switchTimeType(s)}},model:{value:e.time_type,callback:function(a){t.$set(e,"time_type",a)},expression:"item.time_type"}},[a("a-select-option",{attrs:{value:1}},[t._v("天")]),a("a-select-option",{attrs:{value:2}},[t._v("周")]),a("a-select-option",{attrs:{value:3}},[t._v("月")])],1)],1),a("div",{staticStyle:{display:"flex"}},[2==e.time_type?a("a-select",{staticStyle:{width:"490px"},attrs:{mode:"tags",placeholder:"请选择日期"},model:{value:e.schedule,callback:function(a){t.$set(e,"schedule",a)},expression:"item.schedule"}},t._l(t.weekData,(function(e,s){return a("a-select-option",{key:s,attrs:{value:e.key}},[t._v(t._s(e.value))])})),1):t._e(),3==e.time_type?a("a-select",{staticStyle:{width:"490px"},attrs:{mode:"tags",placeholder:"请选择日期"},model:{value:e.schedule,callback:function(a){t.$set(e,"schedule",a)},expression:"item.schedule"}},t._l(t.monthData,(function(e,s){return a("a-select-option",{key:s,attrs:{value:e.key}},[t._v(t._s(e.value))])})),1):t._e(),a("a-time-picker",{staticClass:"mr10 ml8",staticStyle:{width:"100px"},attrs:{placeholder:"开始时间"},on:{change:function(e){return t.addStartTime()}},model:{value:e.start_time,callback:function(a){t.$set(e,"start_time",a)},expression:"item.start_time"}}),a("a-time-picker",{staticClass:"mr6",staticStyle:{width:"100px"},attrs:{placeholder:"结束时间"},model:{value:e.end_time,callback:function(a){t.$set(e,"end_time",a)},expression:"item.end_time"}})],1),a("span",[t._v("添加的用户")])]),a("div",{staticClass:"tag"},[t._v("打上 "),a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(s)}}},[0==e.clientTagArr.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(e.clientTagArr,(function(e,n){return a("a-tag",{key:n},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(s,n)}}})],1)}))],2),t._v(" 的标签 "),t.tag_rule.length>1?a("span",{staticClass:"delete-icon",staticStyle:{"margin-left":"7px",cursor:"pointer"},on:{click:function(e){return t.delTag(s)}}},[a("a-icon",{attrs:{type:"minus-circle"}})],1):t._e()])])})),a("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}}),a("div",{staticClass:"add-task"},[t.tag_rule.length<10?a("a",{on:{click:t.addRuleName}},[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1):a("span",[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1),a("span",{staticClass:"tip-gray"},[t._v("（添加的多条规则可同时生效，最多设置5个规则）")])])],2)])]),a("div",{staticClass:"create-btn mt60"},[a("a-button",{attrs:{type:"primary"},on:{click:t.setUpRule}},[t._v("创建规则")])],1)])],1)},n=[],i=(a("d3b7"),a("159b"),a("a434"),a("b0c0"),a("0ab8")),r=a("c1df"),c=a.n(r),o=a("6010"),l=a("4a04"),u={components:{addlableIndex:o["a"],selectMember:l["a"]},data:function(){return{weekData:[{key:"0",value:"周日"},{key:"1",value:"周一"},{key:"2",value:"周二"},{key:"3",value:"周三"},{key:"4",value:"周四"},{key:"5",value:"周五"},{key:"6",value:"周六"}],monthData:[{key:"1",value:"1号"},{key:"2",value:"2号"},{key:"3",value:"3号"},{key:"4",value:"4号"},{key:"5",value:"5号"},{key:"6",value:"6号"},{key:"7",value:"7号"},{key:"8",value:"8号"},{key:"9",value:"9号"},{key:"10",value:"10号"},{key:"11",value:"11号"},{key:"12",value:"12号"},{key:"13",value:"13号"},{key:"14",value:"14号"},{key:"15",value:"15号"},{key:"16",value:"16号"},{key:"17",value:"17号"},{key:"18",value:"18号"},{key:"19",value:"19号"},{key:"20",value:"20号"},{key:"21",value:"21号"},{key:"22",value:"22号"},{key:"23",value:"23号"},{key:"24",value:"24号"},{key:"25",value:"25号"},{key:"26",value:"26号"},{key:"27",value:"27号"},{key:"28",value:"28号"},{key:"29",value:"29号"},{key:"30",value:"30号"},{key:"31",value:"31号"},{key:"32",value:"32号"}],formAskData:{type:3,name:"",employees:[],tag_rule:[]},tag_rule:[{time_type:1,start_time:"",end_time:"",schedule:[],tags:[],clientTagArr:[]}],popupMemberData:[],showSelectStaff:[]}},created:function(){},methods:{moment:c.a,switchTimeType:function(t){this.tag_rule[t].schedule=[]},effectStaff:function(t){var e=this;this.showSelectStaff=t,t.forEach((function(t,a){e.formAskData.employees[a]=t.wxUserId}))},delIconSpan:function(t){this.showSelectStaff.splice(t,1),this.formAskData.employees.splice(t,1)},showModal:function(t){this.selectInputIndex=t,this.$refs.childRef.show(this.tag_rule[this.selectInputIndex].clientTagArr)},delTagsArr:function(t,e){this.tag_rule[t].tags.splice(e,1),this.tag_rule[t].clientTagArr.splice(e,1)},acceptArray:function(t){var e=this;if(t){var a=[];t.forEach((function(t,s){var n={tagid:"",tagname:""};n.tagid=t.id,n.tagname=t.name,e.tag_rule[e.selectInputIndex].tags.push(n),a[s]=t})),this.tag_rule[this.selectInputIndex].clientTagArr=a}else this.tag_rule[this.selectInputIndex].clientTagArr=[],this.tag_rule[this.selectInputIndex].tags=[]},delTag:function(t){this.tag_rule.splice(t,1)},addRuleName:function(){var t={time_type:1,start_time:"",end_time:"",tags:[],schedule:[],clientTagArr:[]};this.tag_rule.push(t)},addStartTime:function(t){},setUpRule:function(){var t=this;if(""==this.formAskData.name)return this.$message.error("规则名称不能为空"),!1;if(""==this.formAskData.employees)return this.$message.error("生效成员不能为空"),!1;for(var e=0;e<this.tag_rule.length;e++){var a={time_type:1,start_time:"",end_time:"",schedule:[],tags:[]};if(1!=this.tag_rule[e].time_type&&0==this.tag_rule[e].schedule.length)return this.$message.error("规则"+(e+1)+"选择的日期不能为空"),!1;if(""==this.tag_rule[e].start_time)return this.$message.error("规则"+(e+1)+"开始时间不能为空"),!1;if(""==this.tag_rule[e].end_time)return this.$message.error("规则"+(e+1)+"结束时间不能为空"),!1;if(this.tag_rule[e].start_time>this.tag_rule[e].end_time)return this.$message.error("规则"+(e+1)+"开始时间不得大于结束时间"),!1;if(""==this.tag_rule[e].tags)return this.$message.error("规则"+(e+1)+"需要打上的标签不能为空"),!1;a.time_type=this.tag_rule[e].time_type,a.start_time=this.tag_rule[e].start_time,a.end_time=this.tag_rule[e].end_time,a.tags=this.tag_rule[e].tags,a.schedule=this.tag_rule[e].schedule,this.formAskData.tag_rule.push(a)}this.formAskData.tag_rule.forEach((function(t,e){t.start_time=t.start_time.format("HH:mm:ss"),t.end_time=t.end_time.format("HH:mm:ss")})),Object(i["i"])(this.formAskData).then((function(e){t.$message.success("创建成功"),t.$router.push({path:"/autoTag/ruleTagging"})}))}}},d=u,m=(a("aacd"),a("2877")),p=Object(m["a"])(d,s,n,!1,null,"03b7ec4a",null);e["default"]=p.exports},"6b75":function(t,e,a){"use strict";function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}a.d(e,"a",(function(){return s}))},"6ef5":function(t,e,a){"use strict";a("8374")},7728:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"m",(function(){return i})),a.d(e,"f",(function(){return r})),a.d(e,"h",(function(){return c})),a.d(e,"g",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"i",(function(){return u})),a.d(e,"l",(function(){return d})),a.d(e,"d",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"j",(function(){return h})),a.d(e,"b",(function(){return f})),a.d(e,"k",(function(){return v}));var s=a("b775");function n(t){return Object(s["b"])({url:"/roomClockIn/store",method:"post",data:t})}function i(t){return Object(s["b"])({url:"/roomClockIn/update",method:"put",data:t})}function r(t){return Object(s["b"])({url:"/roomClockIn/destroy",method:"delete",data:t})}function c(t){return Object(s["b"])({url:"/roomClockIn/index",method:"get",params:t})}function o(t){return Object(s["b"])({url:"/roomClockIn/show",method:"get",params:t})}function l(t){return Object(s["b"])({url:"/roomClockIn/showContact",method:"get",params:t})}function u(t){return Object(s["b"])({url:"/roomClockIn/info",method:"get",params:t})}function d(t){return Object(s["b"])({url:"/workContactTag/store",method:"post",data:t})}function m(t){return Object(s["b"])({url:"/workContactTag/contactTagList",method:"get",params:t})}function p(t){return Object(s["b"])({url:"/roomClockIn/dayDetail",method:"get",params:t})}function h(t){return Object(s["b"])({url:"/workContactTagGroup/store",method:"post",data:t})}function f(t){return Object(s["b"])({url:"/roomClockIn/batchContactTags",method:"put",data:t})}function v(t){return Object(s["b"])({url:"/officialAccount/index",method:"GET",params:t})}},"78f4":function(t,e,a){},"811e":function(t,e,a){},8374:function(t,e,a){},8522:function(t,e,a){t.exports=a.p+"assets/avatar-room-default.67bead38.svg"},"8c90":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("div",{staticClass:"tag-box"},[a("div",{staticClass:"page_top"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/autoTag/dayPartCreate")}}},[t._v("添加规则")]),a("div",{staticClass:"search_term"},[a("div",{staticClass:"choice_tags"},[a("span",[t._v("客户标签：")]),a("div",{staticClass:"showTagsBox",on:{click:t.showModel}},[0==t.selectTags.length?a("span",{staticClass:"showTagTips"},[t._v("请选择标签")]):a("div",t._l(t.selectTags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.name))])})),1)])]),a("selectTags",{ref:"popupRef",attrs:{controlPopup:t.showPopup},on:{onChange:t.acceptData}}),a("div",{},[a("span",[t._v("搜索规则：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规则名称搜索","allow-clear":""},on:{search:t.searchRuleName,change:t.emptyRule},model:{value:t.searchRuleData,callback:function(e){t.searchRuleData=e},expression:"searchRuleData"}})],1)],1)],1),a("div",{staticClass:"rule-list"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"nickname",fn:function(e){return a("div",{},[a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e))],1)],1)}},{key:"tags",fn:function(e){return a("div",{},t._l(e,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1)}},{key:"on_off",fn:function(e,s){return a("div",{},[a("a-switch",{attrs:{size:"small",defaultChecked:1==e},on:{change:function(e){return t.openSwitch(e,s)}}}),a("span",1==e?[t._v("已开启")]:[t._v("已关闭")])],1)}},{key:"operate",fn:function(e,s){return a("div",{},[a("span",[a("a",{on:{click:function(e){return t.$router.push("/autoTag/dayPartShow?idRow="+s.id)}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.deltableRow(s)}}},[t._v("删除")])],1)])}}])})],1)])])},n=[],i=(a("d3b7"),a("159b"),a("a434"),a("0ab8")),r=a("5588"),c={components:{selectTags:r["a"]},data:function(){return{selectTags:[],tagsParamArr:[],showPopup:!1,table:{col:[{key:"name",dataIndex:"name",title:"规则名称"},{key:"mark_tag_count",dataIndex:"mark_tag_count",title:"已打标签数"},{key:"nickname",dataIndex:"nickname",title:"创建人",scopedSlots:{customRender:"nickname"}},{key:"created_at",dataIndex:"created_at",title:"创建时间"},{key:"tags",dataIndex:"tags",title:"添加的标签",scopedSlots:{customRender:"tags"}},{key:"on_off",dataIndex:"on_off",title:"规则状态",scopedSlots:{customRender:"on_off"}},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]},typeTable:3,searchRuleData:""}},created:function(){this.getTableData({type:this.typeTable})},methods:{openSwitch:function(t,e){e.on_off=t?1:2,Object(i["d"])({id:e.id,on_off:e.on_off}).then((function(t){}))},showModel:function(){this.$refs.popupRef.show(this.selectTags)},acceptData:function(t){var e=this;this.tagsParamArr=[],t.forEach((function(t,a){e.tagsParamArr[a]=t.id})),this.selectTags=t,this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},searchRuleName:function(){this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},emptyRule:function(t){""==this.searchRuleData&&this.getTableData({type:this.typeTable})},deltableRow:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){var a=e.table.data.indexOf(t);Object(i["a"])({id:t.id}).then((function(t){e.$message.success("删除成功"),e.table.data.splice(a,1)}))}})},getTableData:function(t){var e=this;Object(i["b"])(t).then((function(t){e.table.data=t.data.list}))}}},o=c,l=(a("ab1f"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,"79d54f09",null);e["default"]=u.exports},"8f8b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("a-tabs",{attrs:{type:"card"},on:{change:t.switchPage},model:{value:t.tabPage,callback:function(e){t.tabPage=e},expression:"tabPage"}},[a("a-tab-pane",{key:1,attrs:{tab:"关键词打标签"}},[a("keywordIndex")],1),a("a-tab-pane",{key:2,attrs:{tab:"客户入群行为打标签","force-render":""}},[a("joinRoomIndex")],1),a("a-tab-pane",{key:3,attrs:{tab:"分时段打标签"}},[a("dayPartIndex")],1)],1)],1)},n=[],i=a("444c"),r=a("9922"),c=a("8c90"),o={components:{keywordIndex:i["default"],joinRoomIndex:r["default"],dayPartIndex:c["default"]},data:function(){return{tabPage:1}},methods:{switchPage:function(){}}},l=o,u=a("2877"),d=Object(u["a"])(l,s,n,!1,null,null,null);e["default"]=d.exports},"908e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rules-details"},[a("a-card",[a("div",{staticClass:"title"},[t._v(" 基本信息 ")]),a("div",{staticClass:"information"},[a("div",{staticClass:"ifm-left"},[a("div",{staticClass:"founder"},[a("span",[t._v("创建人：")]),a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(t.auto_tag.nickname))],1)],1),a("div",{staticClass:"member mt16"},[a("span",[t._v("生效成员：")]),a("div",{staticClass:"effectBox"},[a("div",{staticClass:"effectContent"},t._l(t.auto_tag.employees,(function(e,s){return a("a-tag",{key:s},[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e.name))],1)})),1)])]),a("div",{staticClass:"create-time mt16"},[a("span",[t._v("创建时间：")]),a("span",[t._v(t._s(t.auto_tag.createdAt))])]),a("div",{staticClass:"add-tag mt16"},[a("span",[t._v("自动添加标签：")]),t._l(t.auto_tag.tags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])}))],2)]),a("div",{staticClass:"ifm-right"},[a("div",{staticClass:"title-set"},[a("span",[t._v("规则设置：")]),a("span",{staticClass:"black"},[t._v("共"+t._s(t.tagRule.length)+"条规则")])]),t._l(t.tagRule,(function(e,s){return a("div",{key:s,staticClass:"set-content mt18 ml84"},[a("span",{staticClass:"title-small black"},[t._v("规则"+t._s(s+1))]),t._l(e.tags,(function(e,s){return a("p",{key:s,staticClass:"keys ml4"},[t._v(" 为"),a("span",[t._v("每天")]),t._v("触发关键词"),a("span",[t._v(t._s(e.tagid))]),t._v("次的客户自动打上 "),a("a-tag",[t._v(t._s(e.tagname))]),t._v(" 标签 ")],1)}))],2)}))],2)])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"title"},[t._v("数据统计")]),a("div",{staticClass:"data-num"},[a("div",{staticClass:"data-box mb20"},[a("div",{staticClass:"data"},[a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.total_count))]),a("div",{staticClass:"desc"},[t._v("打标签总数")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"count"},[t._v(t._s(t.statistics.today_count))]),a("div",{staticClass:"desc"},[t._v("今日打标签数")])])])])])]),a("a-card",{staticClass:"mt16"},[a("div",{staticClass:"search"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"customer"},[a("span",[t._v("搜索用户：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入要搜索的客户","allow-clear":""},on:{search:t.searchUser,change:t.emptyInput},model:{value:t.paramsTable.contact_name,callback:function(e){t.$set(t.paramsTable,"contact_name",e)},expression:"paramsTable.contact_name"}})],1),a("div",{staticClass:"customer-service ml20"},[a("span",[t._v("所属客服：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入客服"}})],1),a("div",{staticClass:"add-time ml20"},[a("span",[t._v("添加好友时间：")]),a("a-range-picker",{staticStyle:{width:"220px"},attrs:{allowClear:!0},on:{change:t.searchTime},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1)]),a("div",{staticClass:"reset"},[a("a-button",{on:{click:t.resetTable}},[t._v("重置")])],1)]),a("div",{staticClass:"table-box mt30"},[a("div",{staticClass:"store-box mb20"},[a("span",{staticClass:"customers-title"},[t._v(" 共"+t._s(t.table.data.length)+"个客户 ")]),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticStyle:{cursor:"pointer"},on:{click:t.updateTable}},[a("a-icon",{attrs:{type:"redo"}}),t._v("更新数据")],1)],1),a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"employeeName",fn:function(e){return a("div",{},[a("a-tag",[a("a-icon",{attrs:{type:"user"}}),t._v(t._s(e))],1)],1)}},{key:"keyword",fn:function(e){return a("div",{},[a("a-tag",[t._v(t._s(e))])],1)}},{key:"operate",fn:function(e,s){return a("div",{},[a("div",[a("a",{on:{click:function(e){return t.chatRow(s)}}},[t._v("聊天记录")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:t.detailsRow}},[t._v("详情")])],1)])}}])})],1),a("a-modal",{attrs:{title:"聊天记录",maskClosable:!1,footer:null,width:"750px"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticClass:"message-wrapper"},[a("ul",{staticClass:"message-content"},t._l(t.messageData,(function(e,s){return a("li",{key:s,staticClass:"message-item"},[a("div",{staticClass:"people-wrapper",class:1==e.isCurrentUser?"people-self":""},[a("div",{staticClass:"people-avatar"},[e.avatar?a("img",{staticClass:"img",attrs:{src:e.avatar,onerror:t.errorImg,alt:""}}):a("a-icon",{staticClass:"icon",attrs:{type:"user"}})],1),a("div",{staticClass:"people-info"},[a("div",{staticClass:"name-wrapper",class:1==e.isCurrentUser?"self-name-wrapper":""},[a("span",{staticClass:"name"},[t._v(t._s(e.name))]),a("span",{staticClass:"message-time"},[t._v(t._s(e.msgDataTime))])]),1==e.type||e.type>7?a("div",{class:["info",1==e.isCurrentUser?"self-info":""]},[t._v(" "+t._s(e.content.content)+" "),e.content.item?a("div",{staticClass:"info-item"},t._l(e.content.item,(function(e,s){return a("div",{key:s},[a("div",[t._v(" "+t._s(e.content)+" ")])])})),0):t._e()]):a("div",{class:["info","white",1==e.isCurrentUser?"self-info":""]},[2==e.type?a("a",{attrs:{href:e.content.ossFullPath,target:"blank"}},[a("img",{staticClass:"img",attrs:{src:e.content.ossFullPath,onerror:t.errorImg,alt:""}})]):t._e(),4==e.type?a("audio",{staticClass:"audio",attrs:{controls:""}},[a("source",{attrs:{src:e.content.ossFullPath,type:"audio/mpeg"}}),a("source",{attrs:{src:e.content.ossFullPath,type:"audio/ogg"}})]):t._e(),5==e.type?a("video",{staticClass:"video",attrs:{poster:"",controls:"","data-setup":"{}",preload:"auto"}},[a("source",{attrs:{src:e.content.ossFullPath}})]):t._e(),6==e.type?a("div",{staticClass:"little"},[a("div",{staticClass:"wrpper"},[t._v("小程序")]),a("div",{staticClass:"title-wrapper"},[a("div",{staticClass:"name"},[t._v(t._s(e.content.displayname))]),a("div",{staticClass:"title"},[t._v(t._s(e.content.title))]),a("div",{staticClass:"description"},[t._v(" "+t._s(e.content.description)+" ")])])]):t._e(),7==e.type?a("a",{attrs:{href:e.content.ossFullPath,target:"blank"}},[a("div",{staticClass:"other"},[a("a-icon",{staticClass:"file",attrs:{type:"file"}}),a("span",{staticClass:"file-name"},[t._v("文件")])],1)]):t._e()])])])])})),0)])])],1)])],1)},n=[],i=a("0ab8"),r={data:function(){return{visible:!1,messageData:[],errorImg:'this.src="'+a("1195")+'"',selectDate:[],paramsTable:{contact_name:"",employee:"",start_time:"",end_time:"",page:1,perPage:15},auto_tag:{},tagRule:[],statistics:{},table:{col:[{key:"contactName",dataIndex:"contactName",title:"客户",scopedSlots:{customRender:"contactName"}},{key:"employeeName",dataIndex:"employeeName",title:"所属员工",scopedSlots:{customRender:"employeeName"}},{key:"keyword",dataIndex:"keyword",title:"最近触发关键词",scopedSlots:{customRender:"keyword"}},{key:"createTagTime",dataIndex:"createTagTime",title:"添加标签时间"},{key:"createTime",dataIndex:"createTime",title:"添加好友时间"},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]}}},created:function(){this.idRow=this.$route.query.idRow,this.paramsTable.id=this.idRow,this.getDetailsData(this.idRow),this.getTableData(this.paramsTable)},methods:{resetTable:function(){var t={id:this.idRow,page:1,perPage:15};this.selectDate=[],this.paramsTable=t,this.getTableData(this.paramsTable)},emptyInput:function(){""==this.paramsTable.contact_name&&this.getTableData(this.paramsTable)},searchUser:function(){this.getTableData(this.paramsTable)},chatRow:function(t){var e=this;this.visible=!0,Object(i["c"])({toUserType:0,workEmployeeId:t.employeeId,toUserId:t.contactId,page:1,perPage:1e4}).then((function(t){e.messageData=t.data.list}))},detailsRow:function(){},updateTable:function(){this.table.data=[],this.getTableData(this.paramsTable)},searchTime:function(t,e){this.paramsTable.start_time=e[0],this.paramsTable.end_time=e[1],this.getTableData(this.paramsTable)},getTableData:function(t){var e=this;Object(i["f"])(t).then((function(t){e.table.data=t.data.list}))},getDetailsData:function(t){var e=this;Object(i["e"])({id:t}).then((function(t){e.auto_tag=t.data.auto_tag,e.tagRule=e.auto_tag.tagRule,e.statistics=t.data.statistics}))}}},c=r,o=(a("4253"),a("2877")),l=Object(o["a"])(c,s,n,!1,null,"786285e4",null);e["default"]=l.exports},"981e":function(t,e,a){"use strict";a("78f4")},9922:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",[a("div",{staticClass:"tag-box"},[a("div",{staticClass:"page_top"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/autoTag/joinRoomCreate")}}},[t._v("添加规则")]),a("div",{staticClass:"search_term"},[a("div",{staticClass:"choice_tags"},[a("span",[t._v("客户标签：")]),a("div",{staticClass:"showTagsBox",on:{click:t.showModel}},[0==t.selectTags.length?a("span",{staticClass:"showTagTips"},[t._v("请选择标签")]):a("div",t._l(t.selectTags,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.name))])})),1)])]),a("selectTags",{ref:"popupRef",on:{onChange:t.acceptData}}),a("div",{},[a("span",[t._v("搜索规则：")]),a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规则名称搜索","allow-clear":""},on:{search:t.searchRuleName,change:t.emptyRule},model:{value:t.searchRuleData,callback:function(e){t.searchRuleData=e},expression:"searchRuleData"}})],1)],1)],1),a("div",{staticClass:"rule-list"},[a("a-table",{attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"tags",fn:function(e){return a("div",{},t._l(e,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e))])})),1)}},{key:"on_off",fn:function(e,s){return a("div",{},[a("a-switch",{attrs:{size:"small",defaultChecked:1==e},on:{change:function(e){return t.openSwitch(e,s)}}}),a("span",1==e?[t._v("已开启")]:[t._v("已关闭")])],1)}},{key:"operate",fn:function(e,s){return a("div",{},[a("span",[a("a",{on:{click:function(e){return t.$router.push("/autoTag/joinRoomShow?idRow="+s.id)}}},[t._v("详情")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.deltableRow(s)}}},[t._v("删除")])],1)])}}])})],1)])])},n=[],i=(a("d3b7"),a("159b"),a("a434"),a("0ab8")),r=a("5588"),c={components:{selectTags:r["a"]},data:function(){return{selectTags:[],tagsParamArr:[],typeTable:2,searchRuleData:"",table:{col:[{key:"name",dataIndex:"name",title:"规则名称"},{key:"mark_tag_count",dataIndex:"mark_tag_count",title:"已打标签数"},{key:"tags",dataIndex:"tags",title:"添加的标签",scopedSlots:{customRender:"tags"}},{key:"created_at",dataIndex:"created_at",title:"创建时间"},{key:"on_off",dataIndex:"on_off",title:"规则状态",scopedSlots:{customRender:"on_off"}},{key:"operate",dataIndex:"operate",title:"操作",scopedSlots:{customRender:"operate"}}],data:[]}}},created:function(){this.getTableData({type:this.typeTable})},methods:{openSwitch:function(t,e){e.on_off=t?1:2,Object(i["d"])({id:e.id,on_off:e.on_off}).then((function(t){}))},showModel:function(){this.$refs.popupRef.show(this.selectTags)},acceptData:function(t){var e=this;this.tagsParamArr=[],t.forEach((function(t,a){e.tagsParamArr[a]=t.id})),this.selectTags=t,this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},deltableRow:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){var a=e.table.data.indexOf(t);Object(i["a"])({id:t.id}).then((function(t){e.$message.success("删除成功"),e.table.data.splice(a,1)}))}})},searchRuleName:function(){this.getTableData({type:this.typeTable,name:this.searchRuleData,tags:this.tagsParamArr})},emptyRule:function(t){""==this.searchRuleData&&this.getTableData({type:this.typeTable})},getTableData:function(t){var e=this;Object(i["b"])(t).then((function(t){e.table.data=t.data.list}))}}},o=c,l=(a("e92e"),a("2877")),u=Object(l["a"])(o,s,n,!1,null,"7fe109e9",null);e["default"]=u.exports},"9c58":function(t,e,a){},"9d3f":function(t,e,a){},a4ee:function(t,e,a){"use strict";a("811e")},aacd:function(t,e,a){"use strict";a("14f8")},ab1f:function(t,e,a){"use strict";a("5b13")},ad56:function(t,e,a){},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var s=a("06c5");function n(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(s["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return c=t.done,t},e:function(t){o=!0,r=t},f:function(){try{c||null==a["return"]||a["return"]()}finally{if(o)throw r}}}}},ba6a:function(t,e,a){},c6e1:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rule-box"},[a("a-card",[a("div",{staticClass:"create-rule"},[a("div",{staticClass:"title"},[t._v("创建自动打卡标签规则")]),a("div",{staticClass:"content mt22"},[a("div",{staticClass:"tag-mode"},[a("div",{staticClass:"mode elastic"},[a("span",[t._v("打卡标签方式：")]),a("div",{staticClass:"block"},[t._v("关键词打标签")])]),a("p",{staticClass:"tip-gray ml98"},[t._v("根据客户聊天行为，设定客户在聊天过程中提到的关键词，自动将提到关键词的客户打标签")])]),a("div",{staticClass:"rule-name elastic mt20"},[a("span",[t._v("规则名称：")]),a("div",[a("a-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请填写规则名称，仅内部可见"},model:{value:t.formAskData.name,callback:function(e){t.$set(t.formAskData,"name",e)},expression:"formAskData.name"}})],1)]),a("div",{staticClass:"effect"},[a("div",{staticClass:"take-effect elastic mt20"},[a("span",[t._v("生效员工：")]),a("a-button",{staticStyle:{width:"180px"},on:{click:function(e){return t.$refs.selectMember.setSelect(t.showSelectStaff)}}},[t._v("选择成员")])],1),a("div",{staticClass:"memberRow"},t._l(t.showSelectStaff,(function(e,s){return a("div",{key:s,staticClass:"tags"},[t._v(" "+t._s(e.name)+" "),a("span",{staticClass:"closeIcon",on:{click:function(e){return t.delIconSpan(s)}}},[a("a-icon",{attrs:{type:"close"}})],1)])})),0),a("p",{staticClass:"tip-gray ml70"},[t._v("仅针对开通了消息存档的员工生效")]),a("selectMember",{ref:"selectMember",on:{change:t.effectStaff}})],1)])]),a("div",{staticClass:"set-keywords mt50"},[a("div",{staticClass:"title"},[t._v("设置关键词")]),a("div",{staticClass:"content mt22"},[a("div",{staticClass:"mode elastic"},[a("span",[t._v("模糊匹配 "),a("a-popover",[a("template",{slot:"content"},[t._v(" 客户与员工聊天中对话内容只要包含某个关键词，"),a("br"),t._v(" 客户就会被自动打上标签 ")]),a("a-icon",{attrs:{type:"question-circle"}})],2),t._v(" ： ")],1),a("div",{staticClass:"add-key"},[a("a-button",{on:{click:function(e){return t.addkeyWordType(0)}}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加关键词")],1)],1),a("div",{staticClass:"keyTermsRow"},t._l(t.formAskData.fuzzy_match_keyword,(function(e,s){return a("a-tag",{key:s,attrs:{closable:"",type:"info"},on:{close:function(e){return t.delkeyTerms(s,0)}}},[t._v(t._s(e))])})),1)]),a("div",{staticClass:"mode elastic mt24"},[a("span",[t._v(" 精准匹配 "),a("a-popover",[a("template",{slot:"content"},[t._v(" 客户与员工聊天中对话内容只提到某个关键词，"),a("br"),t._v(" 客户才会被自动打上标签 ")]),a("a-icon",{attrs:{type:"question-circle"}})],2),t._v(" ： ")],1),a("div",{staticClass:"add-key"},[a("a-button",{on:{click:function(e){return t.addkeyWordType(1)}}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加关键词")],1)],1),a("div",{staticClass:"keyTermsRow"},t._l(t.formAskData.exact_match_keyword,(function(e,s){return a("a-tag",{key:s,attrs:{closable:"",type:"info"},on:{close:function(e){return t.delkeyTerms(s,1)}}},[t._v(t._s(e))])})),1)])]),a("a-modal",{attrs:{title:"添加匹配关键词",maskClosable:!1},on:{ok:t.addwordKey},model:{value:t.addwordKeyPopup,callback:function(e){t.addwordKeyPopup=e},expression:"addwordKeyPopup"}},[t._l(t.addkeyArray,(function(e,s){return a("div",{key:s,staticClass:"keywordRow"},[a("div",{staticClass:"keywordIndex"},[t._v("关键词"+t._s(s+1)+"：")]),a("a-input",{attrs:{placeholder:"请输入关键词"},model:{value:t.addkeyArray[s],callback:function(e){t.$set(t.addkeyArray,s,e)},expression:"addkeyArray[index]"}}),1!=t.addkeyArray.length?a("span",{staticClass:"keywordDelIcon",on:{click:function(e){return t.delCruxWord(s)}}},[a("a-icon",{attrs:{type:"minus-circle"}})],1):t._e()],1)})),a("div",{staticClass:"addRowEvent"},[a("span",{staticClass:"addkeyWordBtn",on:{click:t.addkeyData}},[a("a-icon",{attrs:{type:"plus-circle"}}),t._v("添加关键词")],1)])],2)],1),a("div",{staticClass:"automatic mt50"},[a("div",{staticClass:"title"},[t._v("自动打标签 "),a("span",{staticClass:"tips"},[t._v("触发关键词次数为触发模糊匹配和精准匹配关键词总和")])]),a("div",{staticClass:"content mt30"},[a("div",{staticClass:"task"},[a("div",{staticClass:"task-padding"},t._l(t.tag_rule,(function(e,s){return a("div",{key:s,staticClass:"task-content"},[t._v(" 规则"+t._s(s+1)+"：客户每 "),a("div",{staticClass:"task-content ml4 mr4"},[a("a-select",{model:{value:e.time_type,callback:function(a){t.$set(e,"time_type",a)},expression:"item.time_type"}},[a("a-select-option",{attrs:{value:1}},[t._v("天")]),a("a-select-option",{attrs:{value:2}},[t._v("周")]),a("a-select-option",{attrs:{value:3}},[t._v("月")])],1)],1),t._v(" 触发关键词 "),a("div",{staticClass:"ml4 mr4"},[a("a-input-number",{staticStyle:{width:"52px"},attrs:{min:1,max:10},model:{value:e.trigger_count,callback:function(a){t.$set(e,"trigger_count",a)},expression:"item.trigger_count"}})],1),t._v(" 次自动打上 "),a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(s)}}},[0==e.clientTagArr.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(e.clientTagArr,(function(e,n){return a("a-tag",{key:n},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(s,n)}}})],1)}))],2),t._v(" 标签 "),t.tag_rule.length>1?a("span",{staticClass:"delete-icon",staticStyle:{"margin-left":"7px",cursor:"pointer"},on:{click:function(e){return t.delTag(s)}}},[a("a-icon",{attrs:{type:"minus-circle"}})],1):t._e()])})),0),a("div",{staticClass:"add-task"},[t.tag_rule.length<10?a("a",{on:{click:t.addRuleName}},[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1):a("span",[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1),a("span",{staticClass:"tip-gray"},[t._v("（添加的多条规则可同时生效，最多设置10个规则）")])])]),a("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1)]),a("div",{staticClass:"create-btn mt60"},[a("a-button",{attrs:{type:"primary"},on:{click:t.setUpRule}},[t._v("创建规则")])],1)])],1)},n=[],i=(a("a434"),a("d3b7"),a("159b"),a("b0c0"),a("0ab8")),r=a("6010"),c=a("4a04"),o={components:{addlableIndex:r["a"],selectMember:c["a"]},data:function(){return{formAskData:{type:1,name:"",employees:[],fuzzy_match_keyword:[],exact_match_keyword:[],tag_rule:[{time_type:"",trigger_count:""}]},keyWordType:0,addwordKeyPopup:!1,addkeyArray:[""],tag_rule:[{time_type:1,trigger_count:1,tags:[],clientTagArr:[]}],visible:!1,selectInputIndex:0,delSelectlable:0,selectedList:[],showSelectStaff:[]}},methods:{delIconSpan:function(t){this.showSelectStaff.splice(t,1),this.formAskData.employees.splice(t,1)},effectStaff:function(t){var e=this;this.showSelectStaff=t,t.forEach((function(t,a){e.formAskData.employees[a]=t.wxUserId}))},showModal:function(t){this.selectInputIndex=t,this.$refs.childRef.show(this.tag_rule[this.selectInputIndex].clientTagArr)},delTagsArr:function(t,e){this.tag_rule[t].tags.splice(e,1),this.tag_rule[t].clientTagArr.splice(e,1)},handchange:function(t){this.delSelectlable=t},acceptArray:function(t){var e=this;if(t){var a=[];t.forEach((function(t,s){var n={tagid:"",tagname:""};n.tagid=t.id,n.tagname=t.name,e.tag_rule[e.selectInputIndex].tags.push(n),a[s]=t})),this.tag_rule[this.selectInputIndex].clientTagArr=a}else this.tag_rule[this.selectInputIndex].clientTagArr=[],this.tag_rule[this.selectInputIndex].tags=[]},setUpRule:function(){var t=this;if(""==this.formAskData.name)return this.$message.error("规则名称不能为空"),!1;if(""==this.formAskData.employees)return this.$message.error("请添加规则生效成员"),!1;if(""==this.formAskData.fuzzy_match_keyword&&""==this.formAskData.exact_match_keyword)return this.$message.error("请添加关键字"),!1;for(var e=0;e<this.tag_rule.length;e++)if(""==this.tag_rule[e].tags)return this.$message.error("规则"+(e+1)+"标签不能为空"),!1;this.formAskData.tag_rule=this.tag_rule,Object(i["i"])(this.formAskData).then((function(e){t.$message.success("创建成功"),t.$router.push({path:"/autoTag/ruleTagging"})}))},delTag:function(t){this.tag_rule.splice(t,1)},addRuleName:function(){var t={time_type:1,trigger_count:1,tags:[],clientTagArr:[]};this.tag_rule.push(t)},delkeyTerms:function(t,e){0==e?this.formAskData.fuzzy_match_keyword.splice(t,1):1==e&&this.formAskData.exact_match_keyword.splice(t,1)},addkeyWordType:function(t){var e=this;this.addwordKeyPopup=!0,this.keyWordType=t,0==this.keyWordType&&(""==this.formAskData.fuzzy_match_keyword?this.addkeyArray=[""]:(this.addkeyArray=[],this.formAskData.fuzzy_match_keyword.forEach((function(t,a){e.addkeyArray[a]=t})))),1==this.keyWordType&&(""==this.formAskData.exact_match_keyword?this.addkeyArray=[""]:(this.addkeyArray=[],this.formAskData.exact_match_keyword.forEach((function(t,a){e.addkeyArray[a]=t}))))},addwordKey:function(){for(var t=this,e=0;e<this.addkeyArray.length;e++){if(""==this.addkeyArray[e])return this.$message.error("关键字"+(e+1)+"不能为空"),!1;var a=this.addkeyArray.indexOf(this.addkeyArray[e]);if(-1!=a&&a!=e)return this.$message.error("关键字"+(e+1)+"不能为与其他关键字重复"),!1}0==this.keyWordType?this.addkeyArray.forEach((function(e,a){t.formAskData.fuzzy_match_keyword[a]=e})):1==this.keyWordType&&this.addkeyArray.forEach((function(e,a){t.formAskData.exact_match_keyword[a]=e})),this.addwordKeyPopup=!1},addkeyData:function(){var t="";this.addkeyArray.push(t)},delCruxWord:function(t){this.addkeyArray.splice(t,1)}}},l=o,u=(a("f405"),a("2877")),d=Object(u["a"])(l,s,n,!1,null,"0282a86a",null);e["default"]=d.exports},e92e:function(t,e,a){"use strict";a("f424")},f1a5:function(t,e,a){},f405:function(t,e,a){"use strict";a("ad56")},f424:function(t,e,a){},fc6e:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"rule-box"},[a("a-card",[a("div",{staticClass:"set-keywords"},[a("div",{staticClass:"title"},[t._v("规则基础信息")]),a("div",{staticClass:"content mt22"},[a("div",{staticClass:"mode elastic"},[a("span",{staticClass:"tip-gray"},[t._v("设定规则，当用户加入规则内的群聊，自动给入群客户打标签")])]),a("div",{staticClass:"mode elastic mt24"},[a("span",[t._v("规则名称：")]),a("div",{staticClass:"add-key"},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请填写规则名称，仅内部可见"},model:{value:t.formAskData.name,callback:function(e){t.$set(t.formAskData,"name",e)},expression:"formAskData.name"}})],1)])])]),a("div",{staticClass:"automatic mt50"},[a("div",{staticClass:"title"},[t._v("设置打标签规则")]),a("div",{staticClass:"content mt30"},[a("div",{staticClass:"task"},[a("div",{staticClass:"task-padding"},t._l(t.tag_rule,(function(e,s){return a("div",{key:s,staticClass:"task-content"},[t._v(" 规则"+t._s(s+1)+"：用户加入群聊 "),a("div",{staticClass:"task-content ml4 mr4",on:{click:function(e){return t.showGroupPop(s)}}},[a("div",{staticClass:"groupchoose"},[""==e.rooms?a("span",{staticClass:"groupSpan"},[t._v("请选择群聊")]):a("div",t._l(e.rooms,(function(e,s){return a("a-tag",{key:s},[t._v(t._s(e.name))])})),1)])]),t._v(" 时，可打上标签 "),a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(s)}}},[0==e.clientTagArr.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(e.clientTagArr,(function(e,n){return a("a-tag",{key:n},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(s,n)}}})],1)}))],2),t._v(" 并添加评分 "),a("a-switch",{staticClass:"ml4",attrs:{size:"small"},model:{value:e.is_grade,callback:function(a){t.$set(e,"is_grade",a)},expression:"item.is_grade"}}),a("div",[e.is_grade?a("div",{staticClass:"ml6"},[a("a-input-number",{staticStyle:{width:"60px","margin-right":"10px"},attrs:{min:1},model:{value:e.grade,callback:function(a){t.$set(e,"grade",a)},expression:"item.grade"}}),t._v("分 ")],1):t._e()]),1!=t.tag_rule.length?a("span",{staticClass:"keywordDelIcon",on:{click:function(e){return t.delCruxWord(s)}}},[a("a-icon",{attrs:{type:"minus-circle"}})],1):t._e()],1)})),0),a("div",{staticClass:"add-task"},[t.tag_rule.length<10?a("a",{on:{click:t.addRule}},[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1):a("span",[a("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加规则")],1),a("span",{staticClass:"tip-gray"},[t._v("（添加的多条规则可同时生效，最多设置10个规则）")])])])])]),a("addlableIndex",{ref:"childRef",attrs:{showPopup:t.visible},on:{choiceTagsArr:t.acceptArray}}),a("selectGroup",{ref:"selectGroup",on:{change:t.receiveGroup}}),a("div",{staticClass:"create-btn mt60"},[a("a-button",{attrs:{type:"primary"},on:{click:t.setUprule}},[t._v("创建规则")])],1)],1)],1)},n=[],i=(a("d3b7"),a("159b"),a("b0c0"),a("a434"),a("0ab8")),r=a("6010"),c=a("0e64"),o={components:{addlableIndex:r["a"],selectGroup:c["a"]},data:function(){return{value:1,formAskData:{type:2,name:""},tag_rule:[{is_grade:!1,grade:1,rooms:[],tags:[],clientTagArr:[]}],visible:!1,selectInputIndex:0,delSelectlable:0,showSelectStaff:[],selectGroupIpt:0}},methods:{showGroupPop:function(t){this.selectGroupIpt=t,this.$refs.selectGroup.show()},receiveGroup:function(t){var e=this;t.forEach((function(t,a){var s={id:"",name:""};s.id=t.id,s.name=t.name,e.tag_rule[e.selectGroupIpt].rooms.push(s)}))},showModal:function(t){this.selectInputIndex=t,this.$refs.childRef.show(this.tag_rule[this.selectInputIndex].clientTagArr)},acceptArray:function(t){var e=this;if(t){var a=[];t.forEach((function(t,s){var n={tagid:"",tagname:""};n.tagid=t.id,n.tagname=t.name,e.tag_rule[e.selectInputIndex].tags.push(n),a[s]=t})),this.tag_rule[this.selectInputIndex].clientTagArr=a}else this.tag_rule[this.selectInputIndex].clientTagArr=[],this.tag_rule[this.selectInputIndex].tags=[]},delTagsArr:function(t,e){this.tag_rule[t].tags.splice(e,1),this.tag_rule[t].clientTagArr.splice(e,1)},setUprule:function(){var t=this;if(""==this.formAskData.name)return this.$message.error("规则名称不能为空"),!1;for(var e=0;e<this.tag_rule.length;e++){if(""==this.tag_rule[e].rooms)return this.$message.error("请选择用户加入的群聊"),!1;if(""==this.tag_rule[e].tags)return this.$message.error("请选择要打的标签"),!1}this.formAskData.tag_rule=this.tag_rule,Object(i["i"])(this.formAskData).then((function(e){t.$message.success("创建成功"),t.$router.push({path:"/autoTag/ruleTagging"})}))},addRule:function(){var t={is_grade:!1,grade:1,rooms:[],tags:[],clientTagArr:[]};this.tag_rule.push(t)},delCruxWord:function(t){this.tag_rule.splice(t,1)}}},l=o,u=(a("6ef5"),a("2877")),d=Object(u["a"])(l,s,n,!1,null,"06728a90",null);e["default"]=d.exports}}]);