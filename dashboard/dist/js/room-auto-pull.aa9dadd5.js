(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room-auto-pull"],{"06c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var r=a("6b75");function o(e,t){if(e){if("string"===typeof e)return Object(r["a"])(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(r["a"])(e,t):void 0}}},1319:function(e,t,a){"use strict";a("2829")},2829:function(e,t,a){},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("6b75");function o(e){if(Array.isArray(e))return Object(r["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=a("06c5");function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return o(e)||n(e)||Object(s["a"])(e)||i()}},4873:function(e,t,a){},"4f1c":function(e,t,a){"use strict";a("4873")},"561d":function(e,t,a){"use strict";a("e9bb")},"59e4":function(e,t,a){"use strict";a.d(t,"C",(function(){return o})),a.d(t,"k",(function(){return n})),a.d(t,"i",(function(){return s})),a.d(t,"x",(function(){return i})),a.d(t,"D",(function(){return c})),a.d(t,"u",(function(){return u})),a.d(t,"f",(function(){return l})),a.d(t,"y",(function(){return d})),a.d(t,"A",(function(){return m})),a.d(t,"l",(function(){return p})),a.d(t,"t",(function(){return h})),a.d(t,"s",(function(){return f})),a.d(t,"B",(function(){return g})),a.d(t,"e",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"d",(function(){return w})),a.d(t,"z",(function(){return k})),a.d(t,"b",(function(){return y})),a.d(t,"w",(function(){return C})),a.d(t,"q",(function(){return x})),a.d(t,"o",(function(){return _})),a.d(t,"v",(function(){return R})),a.d(t,"a",(function(){return N})),a.d(t,"n",(function(){return O})),a.d(t,"j",(function(){return j})),a.d(t,"p",(function(){return I})),a.d(t,"g",(function(){return P})),a.d(t,"h",(function(){return S})),a.d(t,"m",(function(){return T})),a.d(t,"r",(function(){return A}));var r=a("b775");function o(e){return Object(r["b"])({url:"/workRoomGroup/index",method:"get",params:e})}function n(e){return Object(r["b"])({url:"/workRoomGroup/destroy",method:"delete",data:e})}function s(e){return Object(r["b"])({url:"/workRoomGroup/store",method:"post",data:e})}function i(e){return Object(r["b"])({url:"/workRoomGroup/update",method:"put",data:e})}function c(e){return Object(r["b"])({url:"/workRoom/index",method:"get",params:e})}function u(e){return Object(r["b"])({url:"/workRoom/syn",method:"put",data:e})}function l(e){return Object(r["b"])({url:"/workRoom/batchUpdate",method:"put",data:e})}function d(e){return Object(r["b"])({url:"/workContactRoom/index",method:"get",params:e})}function m(e){return Object(r["b"])({url:"/workEmployeeDepartment/memberIndex",method:"get",params:e})}function p(e){return Object(r["b"])({url:"/workDepartment/index",method:"get",params:e})}function h(e){return Object(r["b"])({url:"/workRoom/statisticsIndex",method:"get",params:e})}function f(e){return Object(r["b"])({url:"/workRoom/statistics",method:"get",params:e})}function g(e){return Object(r["b"])({url:"/workRoomAutoPull/index",method:"get",params:e})}function b(e){return Object(r["b"])({url:"/workRoomAutoPull/update",method:"put",data:e})}function v(e){return Object(r["b"])({url:"/workRoomAutoPull/store",method:"post",data:e})}function w(e){return Object(r["b"])({url:"/workRoomAutoPull/show",method:"get",params:e})}function k(e){return Object(r["b"])({url:"/workContactTagGroup/index",method:"get",params:e})}function y(e){return Object(r["b"])({url:"/workContactTag/store",method:"post",data:e})}function C(e){return Object(r["b"])({url:"/workContactTag/allTag",method:"get",params:e})}function x(e){return Object(r["b"])({url:"/workRoom/roomIndex",method:"get",params:e})}function _(e){return Object(r["b"])({url:"/roomTagPull/roomList",method:"get",params:e})}function R(e){return Object(r["b"])({url:"/roomTagPull/index",method:"get",params:e})}function N(e){return Object(r["b"])({url:"/roomTagPull/store",method:"POST",data:e})}function O(e){return Object(r["b"])({url:"/roomTagPull/show",method:"GET",params:e})}function j(e){return Object(r["b"])({url:"/roomTagPull/destroy",method:"DELETE",data:e})}function I(e){return Object(r["b"])({url:"/roomTagPull/remindSend",method:"GET",params:e})}function P(e){return Object(r["b"])({url:"/roomTagPull/chooseContact",method:"GET",params:e})}function S(e){return Object(r["b"])({url:"/roomTagPull/filterContact",method:"POST",data:e})}function T(e){return Object(r["b"])({url:"/roomTagPull/showContact",method:"GET",params:e})}function A(e){return Object(r["b"])({url:"/contactMessageBatchSend/showRoom",method:"GET",params:e})}},"5d1d":function(e,t,a){},"6b75":function(e,t,a){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}a.d(t,"a",(function(){return r}))},ad83:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"automatic-pulling"},[a("div",{staticClass:"lists",attrs:{split:!1}},[a("a-alert",{attrs:{"show-icon":!1,message:"自动拉群，不仅可以完全实现不需要员工手工拉客户进群，而且完全打破企业微信官方只能选择5个群聊的局限，流程如下：",banner:""}}),a("a-alert",{attrs:{"show-icon":!1,message:"1、在本系统添加多个群聊的二维码（群聊数量足够），添加完成后会生成一个渠道活码，一个渠道活码对应一个或多个使用成员（相当于客服）。",banner:""}}),a("a-alert",{attrs:{"show-icon":!1,message:"2、当客户扫该渠道活码之后就会先添加使用成员，同时客户会收到管理员提前设置的入群引导语，引导语中包括入群二维码，然后扫码进群。",banner:""}}),a("a-alert",{attrs:{"show-icon":!1,message:"3、当第一个群达到人数上限（最多200人）后，客户扫码添加使用成员后，推送第二群的入群二维码，客户扫码进入第二个群聊，依次往后进行。",banner:""}}),a("a-alert",{attrs:{"show-icon":!1,message:"在整个流程中，即使在客户不入群或当客户退群时，该客户其实就已添加过客服，可以保持单独联系，完善客户画像，提供一对一的精准服务。",banner:""}})],1),a("a-card",[a("a-row",[a("a-col",{attrs:{span:6}},[a("a-input",{attrs:{placeholder:"搜素群活码名称"},model:{value:e.qrcodeName,callback:function(t){e.qrcodeName=t},expression:"qrcodeName"}})],1),a("a-col",{attrs:{span:6,offset:1}},[a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/index@search",expression:"'/workRoomAutoPull/index@search'"}],staticStyle:{marginRight:"10px"},attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查找")]),a("a-button",{on:{click:e.reset}},[e._v("重置")])],1)],1),a("div",{staticClass:"table-wrapper"},[a("div",{staticClass:"top-btn"},[a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/store",expression:"'/workRoomAutoPull/store'"}],staticClass:"batch",attrs:{type:"primary"},on:{click:e.createWorkRoom}},[e._v("新建拉群")])],1),a("a-table",{attrs:{bordered:"",rowKey:"workRoomAutoPullId",columns:e.columns,"data-source":e.tableData,pagination:e.pagination,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"qrcodeUrl",fn:function(e){return a("div",{},[[a("img",{staticClass:"img",attrs:{src:e}})]],2)}},{key:"employees",fn:function(t){return a("div",{},[e._l(t,(function(t,r){return a("div",{key:r},[e._v(" "+e._s(t)+" ")])}))],2)}},{key:"tags",fn:function(t){return a("div",{},[e._l(t,(function(t,r){return a("div",{key:r},[e._v(" "+e._s(t)+" ")])}))],2)}},{key:"rooms",fn:function(t){return a("div",{},[e._l(t,(function(t,r){return a("div",{key:r,staticClass:"table-room"},[a("span",[e._v(e._s(t.roomName))]),a("span",{staticClass:"status"},[e._v(e._s(t.stateText))])])}))],2)}},{key:"action",fn:function(t,r){return a("div",{},[[a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/index@detail",expression:"'/workRoomAutoPull/index@detail'"}],attrs:{type:"link"},on:{click:function(t){return e.detail(r.workRoomAutoPullId)}}},[e._v("详情")]),a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/index@edit",expression:"'/workRoomAutoPull/index@edit'"}],attrs:{type:"link"},on:{click:function(t){return e.edit(r.workRoomAutoPullId)}}},[e._v("编辑")]),a("div",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/index@download",expression:"'/workRoomAutoPull/index@download'"}],staticClass:"download"},[a("a",{attrs:{href:r.qrcodeUrl,download:""}},[e._v("下载")])])]],2)}}])})],1)],1),a("a-modal",{attrs:{title:e.detailTitle,maskClosable:!1,width:800,visible:e.detailShow},on:{cancel:function(t){e.detailShow=!1}}},[a("div",{staticClass:"detail-wrapper"},[a("div",{staticClass:"detail-left"},[a("div",{staticClass:"top"},[a("img",{staticClass:"detail-img",attrs:{src:e.detailData.qrcodeUrl,alt:""}}),a("div",{staticClass:"text"},[a("div",[e._v(" 创建日期： "+e._s(e.detailData.createdAt)+" ")]),a("div",[e._v(e._s(e.detailData.qrcodeName))]),a("a-button",{staticClass:"top-btn",attrs:{type:"primary"}},[a("a",{attrs:{href:e.detailData.qrcodeUrl,download:""}},[e._v("下载活码")])]),a("a-button",{staticClass:"top-btn",on:{click:function(t){return e.edit(e.workRoomAutoPullId)}}},[e._v("修改")])],1)]),a("div",{staticClass:"tags"},[a("p",[e._v("入群标签")]),a("ul",{staticClass:"tags-wrapper"},e._l(e.detailData.tags,(function(t,r){return a("li",{key:r,staticClass:"tag-item"},[a("a-button",{staticClass:"group-name"},[e._v(e._s(t.groupName))]),a("div",{staticClass:"tag-content"},e._l(t.list,(function(t,r){return a("a-tag",{key:r,staticClass:"tag",attrs:{color:"green"}},[e._v(e._s(t.tagName))])})),1)],1)})),0)]),a("div",{staticClass:"bottom"},[a("div",{staticClass:"bottom-left"},[e._v(" 共 "+e._s(e.detailData.roomNum)+" 个群聊 ")]),a("ul",{staticClass:"bottom-right"},e._l(e.detailData.rooms,(function(t,r){return a("li",{key:r,staticClass:"room-item"},[a("div",{staticClass:"room-name"},[e._v(e._s(t.roomName+"("+t.num+")"))]),a("a-tag",{staticClass:"room-status",attrs:{color:"green"}},[e._v(e._s(0==t.state?"未开始":"拉人中"))])],1)})),0)])]),a("div",{staticClass:"detail-right"},[a("div",{staticClass:"member-wrapper"},[a("div",{staticClass:"member-text"},[e._v("使用成员")]),a("div",{staticClass:"member-tags"},e._l(e.detailData.employees,(function(t,r){return a("a-tag",{key:r,staticClass:"member-item"},[e._v(e._s(t.employeeName))])})),1)])])]),a("div",{attrs:{slot:"footer"},slot:"footer"},[[a("a-button",{on:{click:function(t){e.detailShow=!1}}},[e._v("关闭")])]],2)])],1)},o=[],n=a("1da1"),s=(a("96cf"),a("59e4")),i={data:function(){return{columns:[{title:"二维码",dataIndex:"qrcodeUrl",scopedSlots:{customRender:"qrcodeUrl"}},{title:"名称",dataIndex:"qrcodeName"},{title:"使用成员",dataIndex:"employees",scopedSlots:{customRender:"employees"}},{title:"标签",dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:"客户数",dataIndex:"contactNum"},{title:"群聊",dataIndex:"rooms",scopedSlots:{customRender:"rooms"}},{title:"创建时间",dataIndex:"createdAt"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],tableData:[],qrcodeName:"",pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},selectedRowKeys:[],detailData:{},detailShow:!1,workRoomAutoPullId:""}},computed:{detailTitle:function(){return"【".concat(this.detailData.qrcodeName||"","】详情")}},created:function(){this.getTableData()},methods:{getTableData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r,o,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={qrcodeName:e.qrcodeName,page:e.pagination.current,perPage:e.pagination.pageSize},t.prev=1,t.next=4,Object(s["B"])(a);case 4:r=t.sent,o=r.data,n=o.page.total,i=o.list,e.tableData=i,e.pagination.total=n,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:case"end":return t.stop()}}),t,null,[[1,12]])})))()},reset:function(){this.qrcodeName=""},handleTableChange:function(e){var t=e.current,a=e.pageSize;this.pagination.current=t,this.pagination.pageSize=a},onSelectChange:function(e,t){this.selectedRowKeys=e},batchDownload:function(){},createWorkRoom:function(){this.$router.push({path:"/workRoomAutoPull/store"})},detail:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.detailShow=!0,t.workRoomAutoPullId=e,a.prev=2,a.next=5,Object(s["d"])({workRoomAutoPullId:e});case 5:r=a.sent,o=r.data,t.detailData=o,a.next=12;break;case 10:a.prev=10,a.t0=a["catch"](2);case 12:case"end":return a.stop()}}),a,null,[[2,10]])})))()},edit:function(e){this.$router.push({path:"/workRoomAutoPull/store",query:{id:e}})},move:function(){}}},c=i,u=(a("1319"),a("2877")),l=Object(u["a"])(c,r,o,!1,null,"272c0021",null);t["default"]=l.exports},c297:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"people-wrapper"},[a("div",{staticClass:"people-left"},[a("a-input-search",{staticClass:"add-input",attrs:{maxLength:15},on:{search:e.getDepartmentList},model:{value:e.searchKeyWords,callback:function(t){e.searchKeyWords="string"===typeof t?t.trim():t},expression:"searchKeyWords"}}),a("a-tree",{attrs:{"show-icon":"",checkable:"",replaceFields:e.replaceFields,checkStrictly:!1,"expanded-keys":e.expandedKeys,"selected-keys":e.selectedKeys,"tree-data":e.treeData},on:{check:e.onCheck,expand:e.onExpand},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}},[a("a-icon",{attrs:{slot:"folder",type:"folder-open"},slot:"folder"})],1)],1),a("div",{staticClass:"people-right"},[a("div",{staticClass:"total"},[e._v("已选择成员")]),a("ul",e._l(e.choosePeopleKey,(function(t,r){return a("li",{key:r,staticClass:"number"},[a("span",{staticClass:"title"},[e._v(e._s(t.employeeName))]),a("a-icon",{staticClass:"close",attrs:{type:"close"},on:{click:function(a){return e.deletePeople(t,r)}}})],1)})),0)])])},o=[],n=a("2909"),s=a("1da1"),i=a("5530"),c=(a("4de4"),a("d3b7"),a("a15b"),a("caad"),a("2532"),a("a434"),a("d81d"),a("0481"),a("4069"),a("159b"),a("99af"),a("96cf"),a("59e4")),u=a("5880"),l={name:"Department",props:{memberKey:{type:Array,default:function(){return[]}},isChecked:{type:Array,default:function(){return[]}}},data:function(){return{searchKeyWords:"",checkedKeys:[],replaceFields:{title:"name",key:"id",children:"son"},expandedKeys:[],selectedKeys:[],treeData:[],lastCheckdKeys:[],choosePeopleKey:[],departmentIds:[],flatAry:[],unchecked:[]}},watch:{memberKey:function(e){this.choosePeopleKey=e},choosePeopleKey:function(e){this.$emit("change",e)},isChecked:function(e){this.checkedKeys=e}},computed:Object(i["a"])({},Object(u["mapGetters"])(["corpName"])),created:function(){var e=this;this.choosePeopleKey=this.memberKey,this.checkedKeys=this.isChecked;var t=this.corpName?0:2e3;setTimeout((function(){e.getDepartmentList()}),t)},methods:{getDepartmentList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,o,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={searchKeyWords:e.searchKeyWords},t.prev=1,t.next=4,Object(c["l"])(a);case 4:r=t.sent,o=r.data,n=o.department,s=o.employee,""!==e.searchKeyWords&&e.$emit("search",s),e.department=n||[],e.employee=s||[],e.treeData=[{name:e.corpName,nameEn:"company",id:"company",slots:{icon:"folder"},son:n}],t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](1);case 16:case"end":return t.stop()}}),t,null,[[1,14]])})))()},onCheck:function(e){var t=this,a=e.length,r=this.lastCheckdKeys.length,o=[],n=[];a>r?(o=e.filter((function(e){return-1==t.lastCheckdKeys.indexOf(e)&&"company"!==e})),this.getWorkDepartmentList(o.join(","))):(n=this.lastCheckdKeys.filter((function(t){return-1==e.indexOf(t)&&"company"!==t})),this.choosePeopleKey=this.choosePeopleKey.filter((function(e){return!n.includes(e.departmentId)}))),this.lastCheckdKeys=e},onExpand:function(e){this.expandedKeys=e},deletePeople:function(e,t){var a=this;this.choosePeopleKey.splice(t,1);var r=this.departmentIds[e.employeeId];r.map((function(e){var t=a.choosePeopleKey.filter((function(t){return t.departmentId==e}));if(0==t.length){var r=a.checkedKeys.indexOf("company");r>-1&&a.checkedKeys.splice(r,1),a.dealDeleteData(e),a.unchecked.map((function(e){var t=a.checkedKeys.indexOf(e);t>-1&&a.checkedKeys.splice(t,1)}))}})),0==this.choosePeopleKey.length&&(this.checkedKeys=[])},dealDeleteData:function(e){var t=this.treeData[0];this.flatAry=[],this.unchecked=[],this.flat(t.son,e);var a=this.unchecked.length;a>1&&this.filterId(this.unchecked[a-1])},filterId:function(e){var t=this;this.flatAry.filter((function(a){if(a.id==e)return t.unchecked.push(e),0!=a.parentId&&t.filterId(a.parentId),!0}))},flat:function(e,t){var a=this;e.forEach((function(e){a.flatAry.push(e),e.id==t&&(0!=e.parentId?a.unchecked=[e.id,e.parentId]:a.unchecked=[e.id]),e.son&&a.flat(e.son,t)}))},getWorkDepartmentList:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.departmentIds={},a.prev=1,a.next=4,Object(c["A"])({departmentIds:e});case 4:r=a.sent,o=r.data,o=o||[],t.choosePeopleKey=[].concat(Object(n["a"])(t.choosePeopleKey),Object(n["a"])(o)),s=[],i=[],t.choosePeopleKey.forEach((function(e){var a=i.indexOf(e.employeeId);a>-1?t.departmentIds[e.employeeId].push(e.departmentId):(t.departmentIds[e.employeeId]=[e.departmentId],i.push(e.employeeId),s.push(e))})),t.choosePeopleKey=s,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](1);case 16:case"end":return a.stop()}}),a,null,[[1,14]])})))()}}},d=l,m=(a("4f1c"),a("2877")),p=Object(m["a"])(d,r,o,!1,null,"393e889a",null);t["a"]=p.exports},dd53:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"new-pull"},[a("div",{staticClass:"content"},[a("div",{staticClass:"left-wrapper"},[a("a-card",{staticClass:"service-wrapper"},[a("div",{staticClass:"service"},[e._v("客服账号")]),a("div",{staticClass:"leading-wrapper"},[a("div",{staticClass:"user-wrapper"},[a("a-icon",{staticClass:"user",attrs:{type:"user"}})],1),e.leadingWords?a("div",{staticClass:"user-info"},[a("div",{staticClass:"info"},[e._v(e._s(e.leadingWords))])]):e._e()])])],1),a("div",{staticClass:"right-wrapper"},[a("div",{staticClass:"right"},[a("a-form",{staticClass:"form-one",attrs:{"label-col":{span:3},"wrapper-col":{span:7}}},[a("a-form-item",{staticClass:"form-group",attrs:{label:"选择分组"}},[a("a-select",{model:{value:e.workRoomGroupId,callback:function(t){e.workRoomGroupId=t},expression:"workRoomGroupId"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 未分组 ")]),e._l(e.group,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.workRoomGroupId}},[e._v(" "+e._s(t.workRoomGroupName)+" ")])}))],2)],1)],1),a("a-form",{staticClass:"form-two",attrs:{"label-col":{span:3},"wrapper-col":{span:20}}},[a("a-form-item",{staticClass:"form-item",attrs:{label:"扫码名称"}},[a("a-input",{attrs:{disabled:e.edit,maxLength:30,placeholder:"请输入扫码名称"},model:{value:e.qrcodeName,callback:function(t){e.qrcodeName=t},expression:"qrcodeName"}})],1),a("a-form-item",{staticClass:"form-item",attrs:{label:"添加验证"}},[a("a-radio-group",{model:{value:e.isVerified,callback:function(t){e.isVerified=t},expression:"isVerified"}},[a("a-radio",{attrs:{value:1}},[e._v(" 需验证 ")]),a("a-radio",{attrs:{value:2}},[e._v(" 直接通过 ")])],1)],1),a("a-form-item",{staticClass:"form-item",attrs:{label:"使用成员"}},[e.employees.length?a("div",{staticClass:"employee"},e._l(e.employees,(function(t,r){return a("a-tag",{key:r,staticClass:"tag"},[e._v(e._s(t.employeeName))])})),1):e._e(),a("a-button",{on:{click:e.addNewPeople}},[e._v("+添加成员")])],1),a("a-form-item",{staticClass:"form-item",attrs:{label:"入群打标签"}},[a("div",{staticClass:"label"},[a("ul",{staticClass:"tags-wrapper"},[e._l(e.tags,(function(t,r){return a("div",{key:r},[r<e.tagShowNum?a("li",{staticClass:"tag-item"},[a("a-button",{staticClass:"group-name",on:{click:function(a){return e.chooseTagGroup(t.groupId)}}},[e._v(e._s(t.groupName))]),a("div",{staticClass:"tag-content"},[e._l(t.list,(function(r,o){return a("a-tag",{key:o,staticClass:"tag",attrs:{color:1==r.isSelected?"#1890ff":""},on:{click:function(a){return e.chooseTag(t,r.tagId)}}},[e._v(e._s(r.tagName))])})),a("a-button",{staticClass:"add-new",on:{click:function(a){return e.addNewTag(t.groupId,t.groupName)}}},[e._v("+新建标签")])],2)],1):e._e()])})),e.tags.length>5?a("a-button",{attrs:{type:"link"},on:{click:e.showMore}},[e._v(e._s(e.tagShowMore?"收起":"展开"))]):e._e()],2)])]),a("a-form-item",{staticClass:"form-item",attrs:{label:"入群引导语"}},[a("div",{staticClass:"leading"},[a("a-row",[a("a-textarea",{attrs:{id:"textarea",disabled:e.edit,maxLength:1e3,rows:4},model:{value:e.leadingWords,callback:function(t){e.leadingWords=t},expression:"leadingWords"}})],1),a("a-row",[e._v(" 点击插入"),a("a-button",{attrs:{type:"primary",disabled:e.edit},on:{click:e.insert}},[e._v("客户名称")])],1),a("a-row",[a("a-alert",{attrs:{"show-icon":!1,message:"提示：火狐浏览器可能出现无法正确插入客户名称，请使用谷歌、360浏览器",banner:""}})],1)],1)]),a("a-form-item",{staticClass:"form-item",attrs:{label:"添加群聊"}},[a("a-row",[a("p",[e._v(" 可添加多个群聊，当前面的群人数达到上限后，自动发送后面的群二维码。即当第一个群达到人数上限，客户自动扫码会添加第二个客服，然后进入第二个群聊，依次往后进行。因系统无法判断群二维码是否真实有效，请您准确上传群对应的群二维码，否则会影响拉群效果 ")])]),a("a-row",[a("a-table",{attrs:{bordered:"",rowKey:"roomId",columns:e.columns,"data-source":e.rooms},scopedSlots:e._u([{key:"maxNum",fn:function(t,r){return a("div",{},[a("div",[e._v(" 群人数达到 "),a("a-input",{staticClass:"chat-num",model:{value:r.maxNum,callback:function(t){e.$set(r,"maxNum",t)},expression:"record.maxNum"}}),e._v(" 人，换群加入 ")],1)])}},{key:"longRoomQrcodeUrl",fn:function(t,r,o){return a("div",{},[a("div",{on:{click:function(t){return e.upload(r,o)}}},[a("upload",{attrs:{imageUrl:r.longRoomQrcodeUrl,"file-type":1},on:{success:e.uploadSuccess}})],1)])}},{key:"action",fn:function(t,r,o){return a("div",{},[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.deleteGroup(r,o)}}},[e._v("删除")])],1)}}])})],1),a("a-row",[a("a-button",{on:{click:e.chooseChat}},[e._v("+选择群聊")])],1),a("div",{staticClass:"btn-wrapper"},[a("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workRoomAutoPull/store@submit",expression:"'/workRoomAutoPull/store@submit'"}],attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)],1)])]),a("a-modal",{attrs:{title:"新建标签",maskClosable:!1,width:800,visible:e.addNewTagShow},on:{ok:e.newTagConfirm,cancel:function(t){e.addNewTagShow=!1}}},[a("div",{staticClass:"label-wrapper"},[a("span",{staticClass:"text"},[e._v("分组名称:")]),a("div",{staticClass:"containt"},[a("a-input",{staticClass:"select",attrs:{disabled:""},model:{value:e.tagGroupName,callback:function(t){e.tagGroupName=t},expression:"tagGroupName"}})],1)]),a("div",{staticClass:"label-wrapper"},[a("span",{staticClass:"text"},[e._v("标签名称:")]),a("div",{staticClass:"containt"},[a("div",[e._v("每个标签名称最多15个字符，同时新建多个标签时，请用“空格”隔开")]),a("a-input",{staticClass:"input",model:{value:e.tagName,callback:function(t){e.tagName=t},expression:"tagName"}})],1)])]),a("a-modal",{attrs:{title:"选择群聊",maskClosable:!1,width:550,visible:e.groupChatShow},on:{ok:e.addNewChat,cancel:function(t){e.groupChatShow=!1}}},[a("div",[a("a-input-search",{staticClass:"search",attrs:{placeholder:"请输入群名称"},on:{search:e.getRoomList},model:{value:e.searchGroupWord,callback:function(t){e.searchGroupWord=t},expression:"searchGroupWord"}}),a("div",{staticClass:"total"},[e._v("全部群聊("+e._s(e.total)+")")])],1),a("ul",{staticClass:"group-wrapper"},e._l(e.groupChatList,(function(t,r){return a("li",{key:r,staticClass:"group-item"},[a("div",{staticClass:"group-left"},[a("a-icon",{staticClass:"user",attrs:{type:"user"}})],1),a("div",{staticClass:"group-right"},[a("div",[a("div",[e._v(e._s(t.roomName))]),a("div",[e._v(e._s("("+t.currentNum+"/"+t.roomMax+")"))])]),a("a-checkbox",{attrs:{checked:e.judgeChecked(t.roomId)},on:{change:function(a){return e.checkChange(a,t)}}})],1)])})),0)]),a("a-modal",{attrs:{title:"选择企业成员",maskClosable:!1,width:700,bodyStyle:{"max-height":"500px",overflow:"auto"},visible:e.choosePeopleShow,okText:"确认",cancelText:"取消"},on:{ok:e.choosePeople,cancel:function(t){e.choosePeopleShow=!1}}},[a("Department",{attrs:{memberKey:e.employees},on:{change:e.peopleChange}})],1)],1)},o=[],n=a("2909"),s=a("1da1"),i=a("5530"),c=(a("96cf"),a("99af"),a("d81d"),a("4de4"),a("d3b7"),a("b0c0"),a("a434"),a("ac1f"),a("1276"),a("fb6a"),a("a15b"),a("59e4")),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file","list-type":"picture-card",headers:e.headers,method:"post","show-upload-list":!1,action:e.uploadApi,"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e.imageUrl?a("div",{staticClass:"img-wrapper"},[a("img",{staticClass:"img",attrs:{src:e.imageUrl,alt:"avatar"}})]):a("div",[a("a-icon",{attrs:{type:e.loading?"loading":"plus"}})],1)])},l=[],d=(a("a9e3"),a("caad"),a("2532"),a("8ded")),m=a.n(d),p={props:{imageUrl:{type:String,default:""},fileType:{type:Number||Array,default:1}},data:function(){return{loading:!1,FileTypeArr:["",["jpg","png","jpeg"],["mp4","avi","3gp","flv"],["mp3","mp4","wav","ogg"],["pdf"],["doc","docx","xls","xlsx","ppt","pptx","pdf"]],uploadApi:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL+"/dashboard/common/upload"}},computed:{headers:function(){var e=m.a.get("ACCESS_TOKEN");return{Accept:"application/json",Authorization:e}}},created:function(){},methods:{handleChange:function(e){if("uploading"!==e.file.status){if("done"===e.file.status){var t=e.file.response.data;this.$emit("success",t),this.loading=!1}if("error"===e.file.status&&e.file.response){var a=e.file.response;this.$message.error(a.msg)}}else this.loading=!0},beforeUpload:function(e){var t=this,a=this._getFileSuffix(e.name).toLowerCase(),r=[];this.fileType instanceof Array?this.fileType.map((function(e){r.concat(t.FileTypeArr[e])})):r=this.FileTypeArr[this.fileType];var o=r.includes(a);return o||this.$message.error("您只能上传以下类型： ".concat(r.join(","))),o},_getFileSuffix:function(e){return e.substring(e.lastIndexOf(".")+1)}}},h=p,f=(a("ea2a"),a("2877")),g=Object(f["a"])(h,u,l,!1,null,null,null),b=g.exports,v=a("c297"),w=a("5880"),k=[{title:"群名称(人数)",dataIndex:"roomName",customRender:function(e,t){return"".concat(t.roomName," (").concat(t.num,"/").concat(t.roomMax,")")}},{title:"群人数上限",dataIndex:"maxNum",scopedSlots:{customRender:"maxNum"}},{title:"群二维码",dataIndex:"longRoomQrcodeUrl",scopedSlots:{customRender:"longRoomQrcodeUrl"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],y={components:{upload:b,Department:v["a"]},data:function(){return{columns:k,id:"",edit:!1,workRoomGroupId:0,qrcodeName:"",isVerified:1,employees:[],leadingWords:"",rooms:[],tags:[],checkedTags:[],group:[],addNewTagShow:!1,tagsGroup:[],tagGroupid:"",tagGroupName:"",tagName:"",groupChatShow:!1,groupChatTable:[],searchGroupWord:"",total:0,groupChatList:[],uploadIndex:0,choosePeopleShow:!1,choosePeopleKey:[],tagShowMore:!1,tagShowNum:5}},computed:Object(i["a"])({},Object(w["mapGetters"])(["corpId"])),watch:{addNewTagShow:function(e){e||(this.tagName="")},groupChatShow:function(e){e||(this.groupChatTable=[])}},created:function(){var e=this.$route.query.id;e?(this.edit=!0,this.id=e,this.$setPageBreadcrumb("修改拉群"),this.getDetail(e)):this.getTagGroups(),this.getGroupList()},methods:{getGroupList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={corpId:e.corpId,page:1,perPage:100},t.prev=1,t.next=4,Object(c["C"])(a);case 4:r=t.sent,o=r.data.list,e.group=o,t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](1);case 11:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getDetail:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o,n,s,i,u,l,d,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(c["d"])({workRoomAutoPullId:e});case 3:r=a.sent,o=r.data,n=o.qrcodeName,s=o.isVerified,i=o.leadingWords,u=o.employees,l=o.tags,d=o.rooms,m=o.selectedTags,t.qrcodeName=n,t.isVerified=s,t.employees=u,t.tags=l,t.checkedTags=m||[],t.leadingWords=i,t.rooms=d,a.next=23;break;case 21:a.prev=21,a.t0=a["catch"](0);case 23:case"end":return a.stop()}}),a,null,[[0,21]])})))()},getTagGroups:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c["z"])();case 3:a=t.sent,r=a.data,e.tagsGroup=r,e.tags=r.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{list:[]})})),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})))()},showMore:function(){this.tagShowMore=!this.tagShowMore,this.tagShowMore?this.tagShowNum=this.tags.length:this.tagShowNum=5},addNewPeople:function(){this.choosePeopleShow=!0},peopleChange:function(e){this.choosePeopleKey=e},choosePeople:function(){0!=this.choosePeopleKey.length?(this.employees=Object(n["a"])(this.choosePeopleKey),this.choosePeopleShow=!1):this.$message.warn("请选择企业成员")},chooseTagGroup:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.edit){a.next=2;break}return a.abrupt("return");case 2:return r=t.tags.filter((function(t){return t.groupId==e}))[0],o={groupId:e},a.prev=4,a.next=7,Object(c["w"])(o);case 7:n=a.sent,s=n.data,r.list=s.map((function(e){return{tagId:e.id,tagName:e.name,isSelected:2}})),a.next=14;break;case 12:a.prev=12,a.t0=a["catch"](4);case 14:case"end":return a.stop()}}),a,null,[[4,12]])})))()},chooseTag:function(e,t){var a=this.checkedTags.indexOf(t);a>-1?this.checkedTags.splice(a,1):this.checkedTags.push(t),e.list.filter((function(e){if(e.tagId==t)return e.isSelected=a>-1?2:1,!0}))},addNewTag:function(e,t){this.tagGroupid=e,this.tagGroupName=t,this.addNewTagShow=!0},newTagConfirm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tagName){t.next=3;break}return e.$message.warn("请输入标签名称"),t.abrupt("return");case 3:return a=e.tagName.split(" "),r=a.filter((function(e){return e})),o={groupId:e.tagGroupid,tagName:r},t.prev=6,t.next=9,Object(c["b"])(o);case 9:t.next=13;break;case 11:t.prev=11,t.t0=t["catch"](6);case 13:e.addNewTagShow=!1,n=r.map((function(e){return{tagName:e}})),e.tags.map((function(t){t.groupId==e.tagGroupid&&(t.list=t.list.concat(n))})),e.$message.success("成功");case 17:case"end":return t.stop()}}),t,null,[[6,11]])})))()},getRoomList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,o,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={roomGroupId:e.workRoomGroupId,name:e.searchGroupWord},t.prev=1,t.next=4,Object(c["q"])(a);case 4:r=t.sent,o=r.data,n=o.total,s=o.list,e.groupChatList=s,e.total=n,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](1);case 14:case"end":return t.stop()}}),t,null,[[1,12]])})))()},insert:function(){var e=document.getElementById("textarea"),t=e.selectionStart;this.leadingWords=this.leadingWords.slice(0,t)+"##客户名称##"+this.leadingWords.slice(t)},chooseChat:function(){this.groupChatShow=!0,this.getRoomList()},addNewChat:function(){var e;if(0!=this.groupChatTable.length){var t=this.groupChatTable.map((function(e){return{roomId:e.roomId,roomName:e.roomName,num:e.currentNum,maxNum:"",roomMax:e.roomMax,roomQrcodeUrl:"",longRoomQrcodeUrl:""}}));(e=this.rooms).push.apply(e,Object(n["a"])(t)),this.groupChatShow=!1}else this.$message.warn("请选择群聊")},judgeChecked:function(e){var t=this.groupChatTable.filter((function(t){return t.roomId==e}));return t.length>0},checkChange:function(e,t){if(e.target.checked){var a=this.groupChatTable.filter((function(e){return e.roomId==t.roomId}));if(a.length>0)return void this.$message.warn("该群聊已添加过，请不要重复选择");this.groupChatTable.push(t)}else this.groupChatTable=this.groupChatTable.filter((function(e){return e.roomId!=t.roomId}))},deleteGroup:function(e,t){this.rooms.splice(t,1)},upload:function(e,t){this.uploadIndex=t},uploadSuccess:function(e){var t=this.rooms[this.uploadIndex];t.longRoomQrcodeUrl=e.fullPath,t.roomQrcodeUrl=e.path},submit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.employees.map((function(e){return e.employeeId})),r=e.rooms.map((function(e){return{roomId:e.roomId,maxNum:e.maxNum,roomQrcodeUrl:e.roomQrcodeUrl}})),o={isVerified:e.isVerified,employees:a.join(","),tags:e.checkedTags.join(","),rooms:JSON.stringify(r)},!e.edit){t.next=16;break}return o=Object(i["a"])(Object(i["a"])({},o),{},{workRoomAutoPullId:e.id}),t.prev=5,t.next=8,Object(c["e"])(o);case 8:e.$message.success("成功"),e.$router.push({path:"/workRoomAutoPull/index"}),t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](5);case 14:t.next=26;break;case 16:return o=Object(i["a"])(Object(i["a"])({},o),{},{corpId:e.corpId,qrcodeName:e.qrcodeName,leadingWords:e.leadingWords}),t.prev=17,t.next=20,Object(c["c"])(o);case 20:e.$message.success("成功"),e.$router.push({path:"/workRoomAutoPull/index"}),t.next=26;break;case 24:t.prev=24,t.t1=t["catch"](17);case 26:case"end":return t.stop()}}),t,null,[[5,12],[17,24]])})))()}}},C=y,x=(a("561d"),Object(f["a"])(C,r,o,!1,null,"220f96e8",null));t["default"]=x.exports},e9bb:function(e,t,a){},ea2a:function(e,t,a){"use strict";a("5d1d")}}]);