(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["work-contact"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var n=a("6b75");function o(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},"0ac89":function(t,e,a){},"0daa":function(t,e,a){},"10b3":function(t,e,a){"use strict";a("e541")},"132d":function(t,e,a){"use strict";a("f68e")},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var n=a("6b75");function o(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var r=a("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return o(t)||i(t)||Object(r["a"])(t)||s()}},"324c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",[n("a-card",{attrs:{bordered:!1}},[n("a-form",{attrs:{"label-col":{span:7},"wrapper-col":{span:14}}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"关键词："}},[n("a-input",{attrs:{placeholder:"客户姓名／昵称"},model:{value:e.screenData.keyWords,callback:function(t){e.$set(e.screenData,"keyWords",t)},expression:"screenData.keyWords"}})],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"备注："}},[n("a-input",{attrs:{placeholder:"备注"},model:{value:e.screenData.remark,callback:function(t){e.$set(e.screenData,"remark",t)},expression:"screenData.remark\t"}})],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"用户画像："}},[n("a-row",[n("a-col",{attrs:{span:10}},[n("a-select",{on:{change:e.portraitChange},model:{value:e.screenData.fieldId,callback:function(t){e.$set(e.screenData,"fieldId",t)},expression:"screenData.fieldId"}},e._l(e.UserPortraitList,(function(t){return n("a-select-option",{key:t.fieldId,attrs:{value:t.fieldId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),e.fieldTypeText?n("a-col",{attrs:{span:10,offset:2}},[n("a-input",{model:{value:e.screenData.fieldValue,callback:function(t){e.$set(e.screenData,"fieldValue",t)},expression:"screenData.fieldValue"}})],1):n("a-col",{attrs:{span:10,offset:2}},[n("a-select",{model:{value:e.optionsSelect,callback:function(t){e.optionsSelect=t},expression:"optionsSelect"}},e._l(e.fieldSelect.options,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1)],1)],1)],1),n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"客户性别："}},[n("a-select",{model:{value:e.screenData.gender,callback:function(t){e.$set(e.screenData,"gender",t)},expression:"screenData.gender"}},e._l(e.genderList,(function(t){return n("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"客户来源："}},[n("a-select",{model:{value:e.screenData.addWay,callback:function(t){e.$set(e.screenData,"addWay",t)},expression:"screenData.addWay"}},e._l(e.customersSourceList,(function(t){return n("a-select-option",{key:t.addWay},[e._v(" "+e._s(t.addWayText)+" ")])})),1)],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"选择群聊："}},[n("a-input",{attrs:{placeholder:"选择群聊"},on:{click:function(){t.groupChatModal=!0}},model:{value:e.screenData.roomId,callback:function(t){e.$set(e.screenData,"roomId",t)},expression:"screenData.roomId"}})],1)],1)],1),n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"客户持群数："}},[n("a-select",{model:{value:e.groupNum,callback:function(t){e.groupNum=t},expression:"groupNum"}},e._l(e.holdingGroupList,(function(t){return n("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"部门成员："}},[n("a-input",{attrs:{placeholder:"部门成员"},on:{click:function(){t.choosePeopleShow=!0}}})],1)],1),n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"客户编码："}},[n("a-input",{model:{value:e.screenData.businessNo,callback:function(t){e.$set(e.screenData,"businessNo",t)},expression:"screenData.businessNo"}})],1)],1)],1),n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{lg:8}},[n("a-form-item",{attrs:{label:"添加时间："}},[n("a-range-picker",{attrs:{"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["开始时间","结束时间"]},on:{change:e.onTimeChange,ok:e.onOk},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1)],1)],1)],1),n("div",{ref:"tbox",staticClass:"tbox"},[n("a-modal",{attrs:{getContainer:function(){return e.$refs.tbox},visible:e.groupChatModal,title:"选择群聊"},on:{cancel:function(){t.groupChatModal=!1,t.roomIdList=[],t.groupSearch="",t.getGroupChatList()}}},[n("a-input-search",{attrs:{placeholder:"输入群名称"},on:{search:e.onSearch},model:{value:e.groupSearch,callback:function(t){e.groupSearch=t},expression:"groupSearch"}}),n("p",[e._v("全部群聊（"+e._s(e.groupNumber)+"）")]),n("a-table",{attrs:{rowKey:function(t){return t.roomId},columns:e.groupColumns,"data-source":e.groupChatList,"row-selection":{selectedRowKeys:e.roomIdList,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"roomName",fn:function(t,a){return n("div",{},[n("div",{staticClass:"group"},[n("a-icon",{attrs:{type:"user"}}),n("div",[n("span",[e._v(e._s(a.roomName))]),n("span",[e._v(e._s(a.currentNum)+"/"+e._s(a.roomMax))])])],1)])}}])}),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.groupChatModal=!1,t.roomIdList=[],t.groupSearch="",t.getGroupChatList()}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:function(){t.groupChatModal=!1,t.groupSearch="",t.getGroupChatList()}}},[e._v("确定")])],1)],2)],1),n("a-modal",{attrs:{title:"选择企业成员",maskClosable:!1,width:700,visible:e.choosePeopleShow},on:{cancel:function(){t.choosePeopleShow=!1,t.employeeIdList="",t.employees=[],t.searchKey=""}}},[e.choosePeopleShow?n("department",{attrs:{checkedKey:e.employees,memberKey:e.employees},on:{change:e.peopleChange,search:e.searchEmp}}):e._e(),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.choosePeopleShow=!1,t.employeeIdList="",t.employees=[],t.searchKey=""}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:function(){t.choosePeopleShow=!1}}},[e._v("确定")])],1)],2),n("div",{staticClass:"footer"},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/index@search",expression:"'/workContact/index@search'"}],staticStyle:{marginRight:"10px"},attrs:{type:"primary"},on:{click:function(){t.pagination.current=1,t.getTableData()}}},[e._v("查询")]),n("a-button",{on:{click:e.reset}},[e._v("重置")])],1),n("div",{staticClass:"table-wrapper"},[n("div",{staticClass:"btn"},[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/index@sync",expression:"'/workContact/index@sync'"}],attrs:{type:"primary"},on:{click:function(){t.getSynContact()}}},[e._v("同步客户")])],1),n("a-table",{attrs:{columns:e.columns,"data-source":e.tableData,rowKey:function(t){return t.id},pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"news",fn:function(t,a){return n("div",{},[n("div",{staticClass:"news"},[n("img",{attrs:{src:a.avatar}}),n("sapn",{staticClass:"name"},[e._v(" "+e._s(a.name)+" ")])],1)])}},{key:"businessNo",fn:function(t,a){return n("div",{},[""!==a.businessNo?n("span",[e._v(e._s(a.businessNo))]):n("span",[e._v("--")])])}},{key:"roomName",fn:function(t,a){return n("div",{},[0!==a.roomName.length?n("span",[e._v(e._s(a.roomName.join(",")))]):n("span",[e._v("--")])])}},{key:"tag",fn:function(t,a){return n("div",{},[0!==a.tag.length?n("span",[e._v(e._s(a.tag.join(",")))]):n("span",[e._v("--")])])}},{key:"action",fn:function(t,a){return n("div",{},[[n("router-link",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot",expression:"'/workContact/contactFieldPivot'"}],attrs:{to:{path:"/workContact/contactFieldPivot?contactId="+a.contactId+"&employeeId="+a.employeeId+"&isContact="+a.isContact}}},[n("a-button",{attrs:{type:"link"}},[e._v("查看详情")])],1)]],2)}}])})],1)],1)],1)},o=[],i=(a("a9e3"),a("a15b"),a("d81d"),a("d68b")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"people-wrapper"},[a("div",{staticClass:"people-left"},[a("a-input-search",{staticClass:"add-input",attrs:{maxLength:15},on:{search:t.getDepartmentList},model:{value:t.searchKeyWords,callback:function(e){t.searchKeyWords="string"===typeof e?e.trim():e},expression:"searchKeyWords"}}),a("a-tree",{attrs:{"show-icon":"",checkable:"",replaceFields:t.replaceFields,checkStrictly:!1,"expanded-keys":t.expandedKeys,"selected-keys":t.selectedKeys,"tree-data":t.treeData},on:{check:t.onCheck,expand:t.onExpand},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}},[a("a-icon",{attrs:{slot:"folder",type:"folder-open"},slot:"folder"})],1)],1),a("div",{staticClass:"people-right"},[a("div",{staticClass:"total"},[t._v("已选择成员")]),a("ul",t._l(t.choosePeopleKey,(function(e,n){return a("li",{key:n,staticClass:"number"},[a("span",{staticClass:"title"},[t._v(t._s(e.employeeName))]),a("a-icon",{staticClass:"close",attrs:{type:"close"},on:{click:function(a){return t.deletePeople(e,n)}}})],1)})),0)])])},s=[],c=a("2909"),l=a("1da1"),d=a("5530"),u=(a("4de4"),a("d3b7"),a("caad"),a("2532"),a("a434"),a("0481"),a("4069"),a("159b"),a("99af"),a("96cf"),a("59e4")),p=a("5880"),m={name:"Department",props:{memberKey:{type:Array,default:function(){return[]}},checkedKey:{type:Array,default:function(){return[]}},searchKeyEmpty:{type:String,default:""}},data:function(){return{searchKeyWords:this.searchKeyEmpty,checkedKeys:[],replaceFields:{title:"name",key:"id",children:"son"},expandedKeys:[],selectedKeys:[],treeData:[],lastCheckdKeys:[],choosePeopleKey:[],departmentIds:[],flatAry:[],unchecked:[]}},watch:{memberKey:function(t){this.choosePeopleKey=t},choosePeopleKey:function(t){this.$emit("change",t)},checkedKey:function(t){this.checkedKeys=t}},computed:Object(d["a"])({},Object(p["mapGetters"])(["corpName"])),created:function(){var t=this;this.choosePeopleKey=this.memberKey,this.checkedKeys=this.checkedKey;var e=this.corpName?0:2e3;setTimeout((function(){t.getDepartmentList()}),e)},methods:{getDepartmentList:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n,o,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={searchKeyWords:t.searchKeyWords},e.prev=1,e.next=4,Object(u["l"])(a);case 4:n=e.sent,o=n.data,i=o.department,r=o.employee,""!==t.searchKeyWords&&t.$emit("search",r),t.department=i||[],t.employee=r||[],t.treeData=[{name:t.corpName,nameEn:"company",id:"company",slots:{icon:"folder"},son:i}],e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](1);case 16:case"end":return e.stop()}}),e,null,[[1,14]])})))()},onCheck:function(t){var e=this,a=t.length,n=this.lastCheckdKeys.length,o=[],i=[];a>n?(o=t.filter((function(t){return-1==e.lastCheckdKeys.indexOf(t)&&"company"!==t})),this.getWorkDepartmentList(o.join(","))):(i=this.lastCheckdKeys.filter((function(e){return-1==t.indexOf(e)&&"company"!==e})),this.choosePeopleKey=this.choosePeopleKey.filter((function(t){return!i.includes(t.departmentId)}))),this.lastCheckdKeys=t},onExpand:function(t){this.expandedKeys=t},deletePeople:function(t,e){var a=this;this.choosePeopleKey.splice(e,1);var n=this.departmentIds[t.employeeId];n.map((function(t){var e=a.choosePeopleKey.filter((function(e){return e.departmentId==t}));if(0==e.length){var n=a.checkedKeys.indexOf("company");n>-1&&a.checkedKeys.splice(n,1),a.dealDeleteData(t),a.unchecked.map((function(t){var e=a.checkedKeys.indexOf(t);e>-1&&a.checkedKeys.splice(e,1)}))}})),0==this.choosePeopleKey.length&&(this.checkedKeys=[])},dealDeleteData:function(t){var e=this.treeData[0];this.flatAry=[],this.unchecked=[],this.flat(e.son,t);var a=this.unchecked.length;a>1&&this.filterId(this.unchecked[a-1])},filterId:function(t){var e=this;this.flatAry.filter((function(a){if(a.id==t)return e.unchecked.push(t),0!=a.parentId&&e.filterId(a.parentId),!0}))},flat:function(t,e){var a=this;t.forEach((function(t){a.flatAry.push(t),t.id==e&&(0!=t.parentId?a.unchecked=[t.id,t.parentId]:a.unchecked=[t.id]),t.son&&a.flat(t.son,e)}))},getWorkDepartmentList:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,o,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.departmentIds={},a.prev=1,a.next=4,Object(u["A"])({departmentIds:t});case 4:n=a.sent,o=n.data,o=o||[],e.choosePeopleKey=[].concat(Object(c["a"])(e.choosePeopleKey),Object(c["a"])(o)),i=[],r=[],e.choosePeopleKey.forEach((function(t){var a=r.indexOf(t.employeeId);a>-1?e.departmentIds[t.employeeId].push(t.departmentId):(e.departmentIds[t.employeeId]=[t.departmentId],r.push(t.employeeId),i.push(t))})),e.choosePeopleKey=i,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](1);case 16:case"end":return a.stop()}}),a,null,[[1,14]])})))()}}},h=m,f=(a("c012"),a("2877")),g=Object(f["a"])(h,r,s,!1,null,"6d89d351",null),b=g.exports,v={components:{department:b},data:function(){return{groupChatModal:!1,screenData:{gender:3,addWay:"全部",fieldId:0},columns:[{title:"客户信息",dataIndex:"news",align:"left",width:"250px",scopedSlots:{customRender:"news"}},{title:"所属客服",dataIndex:"employeeName",align:"center"},{title:"所在群",dataIndex:"roomName",align:"center",scopedSlots:{customRender:"roomName"}},{title:"来源",dataIndex:"addWayText",align:"center"},{title:"标签",dataIndex:"tag",align:"center",scopedSlots:{customRender:"tag"}},{title:"添加时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],tableData:[],pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},groupColumns:[{title:"",dataIndex:"roomName",key:"roomName",align:"center",scopedSlots:{customRender:"roomName"}}],genderList:[{label:"未知",value:0},{label:"男",value:1},{label:"女",value:2},{label:"全部",value:3}],groupChatList:[],groupNumber:"",groupSearch:"",roomIdList:[],customersSourceList:[],holdingGroupList:[{label:"无群",value:0},{label:"一个",value:1},{label:"多个",value:2},{label:"全部",value:3}],UserPortraitList:[],choosePeopleShow:!1,department:[],employeeIdList:"",groupNum:3,selectedRowKeys:[],timeValue:[],fieldType:"",fieldTypeText:null,fieldSelect:[],optionsSelect:"",employees:[],searchKey:""}},created:function(){this.getTableData(),this.getGroupChatList(),this.getCustomersSource(),this.getUserPortraitList()},methods:{getTableData:function(){var t=this,e={keyWords:this.screenData.keyWords,remark:this.screenData.remark,fieldId:this.screenData.fieldId,fieldType:Number(this.fieldType),fieldValue:this.fieldTypeText?this.screenData.fieldValue:this.optionsSelect,gender:this.screenData.gender,addWay:this.screenData.addWay,roomId:this.roomIdList.join(","),groupNum:this.groupNum,employeeId:this.employeeIdList,startTime:this.screenData.startTime,endTime:this.screenData.endTime,businessNo:this.screenData.businessNo,page:this.pagination.current,perPage:this.pagination.pageSize};Object(i["k"])(e).then((function(e){t.roomIdList=[],t.employeeIdList="",t.employees=[],t.tableData=e.data.list,t.pagination.total=e.data.page.total}))},getGroupChatList:function(){var t=this;Object(i["h"])({name:this.groupSearch}).then((function(e){t.groupChatList=e.data.list,t.groupNumber=e.data.total}))},getCustomersSource:function(){var t=this;Object(i["c"])().then((function(e){t.customersSourceList=e.data;var a={addWay:"全部",addWayText:"全部"};return t.customersSourceList.unshift(a)}))},getUserPortraitList:function(){var t=this;Object(i["a"])().then((function(e){t.UserPortraitList=e.data}))},portraitChange:function(t){var e=this;this.UserPortraitList.map((function(a){a.fieldId===t&&(e.fieldType=a.type,e.fieldSelect=a,"文本"===a.typeText||"手机号"===a.typeText||"邮箱"===a.typeText||"日期"===a.typeText||"数字"===a.typeText?(e.fieldTypeText=!0,e.screenData.fieldValue=""):(e.fieldTypeText=!1,e.optionsSelect=""))}))},handleTableChange:function(t){var e=t.current,a=t.pageSize;this.pagination.current=e,this.pagination.pageSize=a,this.getTableData()},onSearch:function(t){this.groupSearch=t,this.getGroupChatList()},onSelectChange:function(t){this.roomIdList=t},onTimeChange:function(t,e){this.timeValue=t,this.screenData.startTime=e[0],this.screenData.endTime=e[1]},onOk:function(t){},peopleChange:function(t){var e=[];t.map((function(t){e.push(t.employeeId)})),this.employeeIdList=e.join(",")},getSynContact:function(){var t=this;Object(i["i"])().then((function(e){t.getTableData(),t.$message.info("后台同步中,请稍等")}))},reset:function(){this.screenData={gender:3,addWay:"全部",fieldId:0},this.timeValue=[],this.groupNum=3,this.employeeIdList="",this.optionsSelect="",this.employees=[],this.searchKey="",this.roomIdList=[],this.groupSearch=""},searchEmp:function(t){0===t.length?this.employeeIdList="空":this.employeeIdList=t[0].id}}},y=v,k=(a("9f4c"),Object(f["a"])(y,n,o,!1,null,"44aca957",null));e["default"]=k.exports},"3d06":function(t,e,a){"use strict";a("a8eb")},"459d":function(t,e,a){"use strict";a("a8b8")},4814:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"information-card"},[n("a-tabs",{attrs:{type:"card"}},[n("a-tab-pane",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@advanced",expression:"'/contactField/index@advanced'"}],key:"1",attrs:{tab:"高级属性"}},[n("a-card",[n("a-alert",{attrs:{"show-icon":!1,message:"SCRM系统提供手机号、姓名、公司、年龄、性别、行业、爱好、生日及所在区域等15个通用属性字段，属性类型包括文本、单选、多选、日期等。系统通用字段只可修改使用状态和排序顺序（数值越大，在手机端展示越靠前）。",banner:""}}),n("div",{staticClass:"search"},[e.editModal?n("div"):n("a-select",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@all",expression:"'/contactField/index@all'"}],on:{change:e.changeStatus},model:{value:e.screenData.status,callback:function(t){e.$set(e.screenData,"status",t)},expression:"screenData.status"}},e._l(e.statusSelect,(function(t){return n("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1),n("div",{staticClass:"btn"},[e.editModal?e._e():n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@add",expression:"'/contactField/index@add'"}],on:{click:function(){t.visible=!0}}},[e._v("新增属性")]),e.editModal?e._e():n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@batch",expression:"'/contactField/index@batch'"}],attrs:{disabled:0===e.tableData.length,type:"primary"},on:{click:e.batchEdit}},[e._v("批量修改")]),e.editModal?n("a-button",{staticStyle:{marginRight:"10px"},on:{click:e.reset}},[e._v("取消")]):e._e(),e.editModal?n("a-button",{attrs:{type:"primary"},on:{click:e.editDefine}},[e._v("提交")]):e._e()],1)],1),n("div",{staticClass:"table-wrapper"},[n("a-table",{attrs:{rowKey:function(t){return t.id},columns:e.columns,"data-source":e.editData,pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"label",fn:function(t,a,o){return n("div",{},[e.editModal&&1!==a.isSys?e._e():n("span",[e._v(e._s(a.label))]),e.editModal&&0===a.isSys?n("a-input",{attrs:{maxLength:8},model:{value:e.editData[o].label,callback:function(t){e.$set(e.editData[o],"label",t)},expression:"editData[index].label"}}):e._e()],1)}},{key:"order",fn:function(t,a,o){return n("div",{},[e.editModal?e._e():n("span",[e._v(e._s(a.order))]),e.editModal?n("a-input",{attrs:{maxLength:8},model:{value:e.editData[o].order,callback:function(t){e.$set(e.editData[o],"order",t)},expression:"editData[index].order"}}):e._e()],1)}},{key:"options",fn:function(t,a){return n("div",{},[0!==a.options.length?n("a-tooltip",[n("template",{slot:"title"},[n("div",[e._v(e._s(a.options.join(",")))])]),n("div",{staticClass:"text-box"},[e._v(e._s(a.options.join(",")))])],2):n("div",[e._v("--")])],1)}},{key:"status",fn:function(t,a,o){return n("div",{},[e.editModal&&"gender"!==a.name?e._e():n("div",[1===a.status?n("span",[e._v(" 开启 ")]):e._e(),0===a.status?n("span",[e._v(" 关闭 ")]):e._e()]),e.editModal&&"gender"!==a.name?n("a-radio-group",{model:{value:e.editData[o].status,callback:function(t){e.$set(e.editData[o],"status",t)},expression:"editData[index].status"}},[n("a-radio",{attrs:{value:1}},[e._v(" 开启 ")]),n("a-radio",{attrs:{value:0}},[e._v(" 关闭 ")])],1):e._e()],1)}},{key:"action",fn:function(t,a,o){return n("div",{},[e.editModal?e._e():[n("div",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@close",expression:"'/contactField/index@close'"}]},["gender"!==a.name&&0===a.status?n("a-button",{attrs:{type:"link"},on:{click:function(t){return e.editStatus(a.id,1)}}},[e._v("开启")]):e._e(),"gender"!==a.name&&1===a.status?n("a-button",{attrs:{type:"link"},on:{click:function(t){return e.editStatus(a.id,0)}}},[e._v("关闭")]):e._e()],1),e.editModal?e._e():n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/contactField/index@edit",expression:"'/contactField/index@edit'"}],attrs:{type:"link"},on:{click:function(t){return e.editDialog(a)}}},[e._v("编辑")]),n("a-popconfirm",{attrs:{title:"是否确认删除","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(t){return e.deleteAttribute(a.id)}}},[0===a.isSys?n("a-button",{attrs:{type:"link"}},[e._v("删除")]):e._e()],1)],e.editModal&&0===a.isSys?n("a-button",{attrs:{type:"link"},on:{click:function(t){return e.deleteAttr(a.id,o)}}},[e._v("删除")]):e._e()],2)}}])})],1)],1)],1)],1),n("a-modal",{attrs:{visible:e.visible,title:"新增属性"},on:{cancel:e.resetDefine}},[n("a-form-model",{ref:"ruleForm",attrs:{model:e.addAttribute,rules:e.rules,"label-col":{span:5},"wrapper-col":{span:17}}},[n("a-form-model-item",{attrs:{label:"字段名称：",prop:"label"}},[n("a-input",{attrs:{maxLength:8,placeholder:"请填写字段名称"},model:{value:e.addAttribute.label,callback:function(t){e.$set(e.addAttribute,"label",t)},expression:"addAttribute.label"}})],1),n("a-form-model-item",{attrs:{label:"字段类型：",prop:"type"}},[n("a-select",{on:{change:e.selectChange},model:{value:e.addAttribute.type,callback:function(t){e.$set(e.addAttribute,"type",t)},expression:"addAttribute.type"}},e._l(e.fieldType,(function(t){return n("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),1===e.addAttribute.type||2===e.addAttribute.type?n("a-form-model-item",{attrs:{label:"选项内容：",prop:"options"}},[n("a-textarea",{model:{value:e.addAttribute.options,callback:function(t){e.$set(e.addAttribute,"options",t)},expression:"addAttribute.options"}}),n("span",[e._v("用中文逗号“，”新增选项内容,每个选项内容不超过12个字")])],1):e._e(),n("a-form-model-item",{attrs:{label:"排序展示："}},[n("a-input",{model:{value:e.addAttribute.order,callback:function(t){e.$set(e.addAttribute,"order",t)},expression:"addAttribute.order"}})],1),n("a-form-model-item",{attrs:{label:"使用状态："}},[n("a-radio-group",{model:{value:e.addAttribute.status,callback:function(t){e.$set(e.addAttribute,"status",t)},expression:"addAttribute.status"}},[n("a-radio",{attrs:{value:1}},[e._v(" 开启 ")]),n("a-radio",{attrs:{value:0}},[e._v(" 关闭 ")])],1)],1)],1),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:e.resetDefine}},[e._v(" 取消 ")]),n("a-button",{key:"submit",attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.submit}},[e._v(" 确定 ")])],1)],2),n("a-modal",{attrs:{visible:e.editDis,title:"编辑属性"},on:{cancel:function(){t.editDis=!1}}},[n("a-form",{attrs:{"label-col":{span:5},"wrapper-col":{span:17}}},[n("a-form-item",{attrs:{label:"字段名称："}},[n("span",[e._v(e._s(e.editDetail.label))])]),n("a-form-item",{attrs:{label:"字段类型："}},[n("span",[e._v(e._s(e.editDetail.typeText))])]),1===e.editDetail.type||2===e.editDetail.type?n("a-form-item",{attrs:{label:"选项内容："}},[0===e.editDetail.isSys?n("div",[e._l(e.editDetail.options,(function(t,a){return n("a-tag",{key:a+"a",attrs:{closable:""},on:{close:function(t){return e.log(t,a)}}},[e._v(e._s(t))])})),n("a-textarea",{model:{value:e.options,callback:function(t){e.options=t},expression:"options"}}),n("span",[e._v("用“,”新增选项内容,每个选项内容不超过12个字")])],2):n("div",e._l(e.editDetail.options,(function(t,a){return n("a-tag",{key:a+"a"},[e._v(e._s(t))])})),1)]):e._e(),n("a-form-item",{attrs:{label:"排序展示："}},[n("a-input",{model:{value:e.editDetail.order,callback:function(t){e.$set(e.editDetail,"order",t)},expression:"editDetail.order"}}),n("span",{staticStyle:{color:"red"}},[e._v("数值越大,在手机端展示越靠前")])],1),n("a-form-item",{attrs:{label:"使用状态："}},["gender"===e.editDetail.name?n("div",[1===e.editDetail.status?n("span",[e._v("开启")]):e._e(),0===e.editDetail.status?n("span",[e._v("关闭")]):e._e()]):n("a-radio-group",{model:{value:e.editDetail.status,callback:function(t){e.$set(e.editDetail,"status",t)},expression:"editDetail.status"}},[n("a-radio",{attrs:{value:1}},[e._v(" 开启 ")]),n("a-radio",{attrs:{value:0}},[e._v(" 关闭 ")])],1)],1)],1),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.editDis=!1}}},[e._v(" 取消 ")]),n("a-button",{key:"submit",attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.editAttribute}},[e._v(" 确定 ")])],1)],2)],1)},o=[],i=a("2909"),r=(a("a434"),a("ac1f"),a("1276"),a("99af"),a("b775"));function s(t){return Object(r["b"])({url:"/contactField/index",method:"get",params:t})}function c(t){return Object(r["b"])({url:"/contactField/store",method:"post",data:t})}function l(t){return Object(r["b"])({url:"/contactField/update",method:"put",data:t})}function d(t){return Object(r["b"])({url:"/contactField/destroy",method:"delete",data:t})}function u(t){return Object(r["b"])({url:"/contactField/statusUpdate",method:"put",data:t})}function p(t){return Object(r["b"])({url:"/contactField/batchUpdate",method:"put",data:t})}var m={data:function(){return{btnLoading:!1,screenData:{status:2},visible:!1,editDis:!1,editModal:!1,columns:[{align:"center",title:"字段名称",dataIndex:"label",scopedSlots:{customRender:"label"}},{align:"center",title:"填写格式",dataIndex:"typeText"},{align:"center",title:"选项内容",dataIndex:"options",width:"120px",scopedSlots:{customRender:"options"}},{align:"center",title:"排序展示",dataIndex:"order",scopedSlots:{customRender:"order"}},{align:"center",title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"200px",scopedSlots:{customRender:"action"}}],rules:{label:[{required:!0,message:"请填写字段名称",trigger:"blur"}],type:[{required:!0,message:"请选择字段类型",trigger:"change"}],options:[{required:!0,message:"请填写选项内容",trigger:"blur"}]},statusSelect:[{label:"关闭",value:0},{label:"开启",value:1},{label:"全部状态",value:2}],tableData:[],addAttribute:{status:1},fieldType:[{label:"文本",value:0},{label:"单选",value:1},{label:"多选",value:2},{label:"日期",value:6},{label:"手机号",value:9},{label:"邮箱",value:10},{label:"区域",value:5},{label:"图片",value:11}],editDetail:{},options:"",pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},editData:[],editOptions:[],destroy:[]}},created:function(){this.getTableData()},methods:{getTableData:function(){var t=this,e={status:this.screenData.status,page:this.pagination.current,perPage:this.pagination.pageSize};s(e).then((function(e){t.editData=e.data.list,t.tableData=JSON.parse(JSON.stringify(e.data.list)),t.pagination.total=e.data.page.total}))},selectChange:function(t){this.addAttribute.type=t},log:function(t,e){t.preventDefault(),this.editDetail.options.splice(e,1)},editDialog:function(t){this.editDetail=JSON.parse(JSON.stringify(t)),this.editDis=!0},editAttribute:function(){var t=this,e=[];""!==this.options&&(e=this.options.split("，"));var a={id:this.editDetail.id,label:this.editDetail.label,type:this.editDetail.type,options:this.editDetail.options.concat(e),order:this.editDetail.order,status:this.editDetail.status};this.btnLoading=!0,l(a).then((function(e){t.editDis=!1,t.btnLoading=!1,t.getTableData(),t.options=""}))},submit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a={label:t.addAttribute.label,type:t.addAttribute.type,options:1===t.addAttribute.type||2===t.addAttribute.type?t.addAttribute.options.split("，"):"",order:t.addAttribute.order,status:t.addAttribute.status};t.btnLoading=!0,c(a).then((function(e){t.btnLoading=!1,t.visible=!1,t.getTableData(),t.addAttribute={status:1}})).catch((function(){t.visible=!0,t.btnLoading=!1}))}))},resetDefine:function(){this.visible=!1,this.addAttribute={status:1}},deleteAttribute:function(t){var e=this;d({id:t}).then((function(t){e.getTableData()}))},deleteAttr:function(t,e){var a=this;this.$confirm({title:"提示",content:"是否批量删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){a.editData.splice(e,1),a.destroy.push(t)}})},editStatus:function(t,e){var a=this;u({id:t,status:e}).then((function(t){a.getTableData()}))},handleTableChange:function(t){var e=t.current,a=t.pageSize;this.pagination.current=e,this.pagination.pageSize=a,this.getTableData()},changeStatus:function(t){this.screenData.status=t,this.getTableData()},batchEdit:function(){this.editModal=!0,this.editData=Object(i["a"])(this.tableData)},onChange:function(t,e,a){},editDefine:function(){var t=this;p({update:this.editData,destroy:this.destroy}).then((function(e){t.getTableData(),t.editModal=!1}))},reset:function(){this.editModal=!1,this.getTableData()}}},h=m,f=(a("3d06"),a("2877")),g=Object(f["a"])(h,n,o,!1,null,"1cae37b5",null);e["default"]=g.exports},4873:function(t,e,a){},"4b65":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-upload",{class:t.btnType?"avatar-uploader":"btn-type",attrs:{name:"file","list-type":"picture-card",headers:t.headers,method:"post","show-upload-list":!1,action:t.uploadApi,"before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.btnType?a("div",[t.imageUrl?a("div",{staticClass:"img-wrapper"},[a("img",{staticClass:"img",attrs:{src:t.imageUrl,alt:"avatar"}})]):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}})],1)]):a("a-button",{attrs:{type:"link"}},[t._v("重新上传")])],1)},o=[],i=(a("a9e3"),a("b0c0"),a("ac1f"),a("1276"),a("d81d"),a("99af"),a("caad"),a("2532"),a("a15b"),a("8ded")),r=a.n(i),s={props:{imageUrl:{type:String,default:""},fileType:{type:Number||Array,default:1},btnType:{type:Boolean,default:!0}},data:function(){return{loading:!1,FileTypeArr:["",["jpg","png","jpeg"],["mp3","amr"],["mp4"],["doc","docx","xls","xlsx","csv","ppt","pptx","txt","pdf","Xmind","zip","rar"],["zip","rar","tar"]],uploadApi:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL+"/dashboard/common/upload"}},computed:{headers:function(){var t=r.a.get("ACCESS_TOKEN");return{Accept:"application/json",Authorization:t}}},created:function(){},methods:{handleChange:function(t){if("uploading"!==t.file.status){if("done"===t.file.status){var e=t.file.response.data;this.$emit("success",e),this.loading=!1}if("error"===t.file.status&&t.file.response){var a=t.file.response;this.$message.error(a.msg)}}else this.loading=!0},beforeUpload:function(t){var e=this,a=this._getFileSuffix(t.name).toLowerCase(),n=t.type.split("/")[0],o=t.size/1024/1024<2,i=t.size/1024/1024<10,r=t.size/1024/1024<20,s=[];this.fileType instanceof Array?this.fileType.map((function(t){s.concat(e.FileTypeArr[t])})):s=this.FileTypeArr[this.fileType];var c=s.includes(a);return c?4===this.fileType?(r||this.$message.error("上传文件过大"),c&&r):"video"===n?(i||this.$message.error("上传文件过大"),c&&i):(o||this.$message.error("上传文件过大"),c&&o):(this.$message.error("您只能上传以下类型： ".concat(s.join(","))),!1)},_getFileSuffix:function(t){return t.substring(t.lastIndexOf(".")+1)}}},c=s,l=(a("132d"),a("2877")),d=Object(l["a"])(c,n,o,!1,null,null,null);e["a"]=d.exports},"4f1c":function(t,e,a){"use strict";a("4873")},"59e4":function(t,e,a){"use strict";a.d(e,"C",(function(){return o})),a.d(e,"k",(function(){return i})),a.d(e,"i",(function(){return r})),a.d(e,"x",(function(){return s})),a.d(e,"D",(function(){return c})),a.d(e,"u",(function(){return l})),a.d(e,"f",(function(){return d})),a.d(e,"y",(function(){return u})),a.d(e,"A",(function(){return p})),a.d(e,"l",(function(){return m})),a.d(e,"t",(function(){return h})),a.d(e,"s",(function(){return f})),a.d(e,"B",(function(){return g})),a.d(e,"e",(function(){return b})),a.d(e,"c",(function(){return v})),a.d(e,"d",(function(){return y})),a.d(e,"z",(function(){return k})),a.d(e,"b",(function(){return x})),a.d(e,"w",(function(){return _})),a.d(e,"q",(function(){return D})),a.d(e,"o",(function(){return T})),a.d(e,"v",(function(){return I})),a.d(e,"a",(function(){return w})),a.d(e,"n",(function(){return C})),a.d(e,"j",(function(){return O})),a.d(e,"p",(function(){return N})),a.d(e,"g",(function(){return S})),a.d(e,"h",(function(){return j})),a.d(e,"m",(function(){return L})),a.d(e,"r",(function(){return P}));var n=a("b775");function o(t){return Object(n["b"])({url:"/workRoomGroup/index",method:"get",params:t})}function i(t){return Object(n["b"])({url:"/workRoomGroup/destroy",method:"delete",data:t})}function r(t){return Object(n["b"])({url:"/workRoomGroup/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/workRoomGroup/update",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/workRoom/index",method:"get",params:t})}function l(t){return Object(n["b"])({url:"/workRoom/syn",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/workRoom/batchUpdate",method:"put",data:t})}function u(t){return Object(n["b"])({url:"/workContactRoom/index",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/workEmployeeDepartment/memberIndex",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/workDepartment/index",method:"get",params:t})}function h(t){return Object(n["b"])({url:"/workRoom/statisticsIndex",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/workRoom/statistics",method:"get",params:t})}function g(t){return Object(n["b"])({url:"/workRoomAutoPull/index",method:"get",params:t})}function b(t){return Object(n["b"])({url:"/workRoomAutoPull/update",method:"put",data:t})}function v(t){return Object(n["b"])({url:"/workRoomAutoPull/store",method:"post",data:t})}function y(t){return Object(n["b"])({url:"/workRoomAutoPull/show",method:"get",params:t})}function k(t){return Object(n["b"])({url:"/workContactTagGroup/index",method:"get",params:t})}function x(t){return Object(n["b"])({url:"/workContactTag/store",method:"post",data:t})}function _(t){return Object(n["b"])({url:"/workContactTag/allTag",method:"get",params:t})}function D(t){return Object(n["b"])({url:"/workRoom/roomIndex",method:"get",params:t})}function T(t){return Object(n["b"])({url:"/roomTagPull/roomList",method:"get",params:t})}function I(t){return Object(n["b"])({url:"/roomTagPull/index",method:"get",params:t})}function w(t){return Object(n["b"])({url:"/roomTagPull/store",method:"POST",data:t})}function C(t){return Object(n["b"])({url:"/roomTagPull/show",method:"GET",params:t})}function O(t){return Object(n["b"])({url:"/roomTagPull/destroy",method:"DELETE",data:t})}function N(t){return Object(n["b"])({url:"/roomTagPull/remindSend",method:"GET",params:t})}function S(t){return Object(n["b"])({url:"/roomTagPull/chooseContact",method:"GET",params:t})}function j(t){return Object(n["b"])({url:"/roomTagPull/filterContact",method:"POST",data:t})}function L(t){return Object(n["b"])({url:"/roomTagPull/showContact",method:"GET",params:t})}function P(t){return Object(n["b"])({url:"/contactMessageBatchSend/showRoom",method:"GET",params:t})}},6849:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"loss-customers"},[n("a-card",[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/lossContact/index@choose",expression:"'/lossContact/index@choose'"}],on:{click:function(){t.choosePeopleShow=!0}}},[e._v("选择部门成员")]),n("a-modal",{attrs:{title:"选择企业成员",maskClosable:!1,width:700,visible:e.choosePeopleShow},on:{cancel:function(){t.choosePeopleShow=!1,t.employees=[],t.employeeIdList=""}}},[e.choosePeopleShow?n("Department",{attrs:{isChecked:e.employees,memberKey:e.employees},on:{change:e.peopleChange}}):e._e(),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.choosePeopleShow=!1,t.employees=[],t.employeeIdList=""}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:function(){t.choosePeopleShow=!1,t.getTableData(),t.employeeIdList="",t.employees=[]}}},[e._v("确定")])],1)],2),n("div",{staticClass:"table-wrapper"},[n("a-table",{attrs:{columns:e.columns,"data-source":e.tableData,rowKey:function(t){return t.id},pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"detail",fn:function(t,a){return n("div",{},[n("div",{staticClass:"detail-box"},[n("img",{attrs:{src:a.avatar}}),n("span",[e._v(e._s(a.name))]),n("span",{staticStyle:{color:"#3CD389"}},[e._v("@微信")])])])}},{key:"tag",fn:function(t,a){return n("div",{},[0!==a.tag.length?n("span",[e._v(e._s(a.tag.join(",")))]):n("span",[e._v("--")])])}}])})],1)],1)],1)},o=[],i=(a("d81d"),a("a15b"),a("b775"));function r(t){return Object(i["b"])({url:"/workContact/lossContact",method:"get",params:t})}var s=a("c297"),c={components:{Department:s["a"]},data:function(){return{columns:[{title:"客户信息",dataIndex:"detail",align:"center",scopedSlots:{customRender:"detail"}},{title:"标签",dataIndex:"tag",align:"center",scopedSlots:{customRender:"tag"}},{title:"归属成员",dataIndex:"employeeName",align:"center",scopedSlots:{customRender:"employeeName"}},{title:"备注",dataIndex:"remark",align:"center"},{title:"删除时间",dataIndex:"deletedAt",align:"center"}],tableData:[],choosePeopleShow:!1,employeeIdList:"",pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},employees:[]}},created:function(){this.getTableData()},methods:{getTableData:function(){var t=this,e={employeeId:this.employeeIdList,page:this.pagination.current,perPage:this.pagination.pageSize};r(e).then((function(e){t.tableData=e.data.list,t.pagination.total=e.data.page.total}))},handleTableChange:function(t){var e=t.current,a=t.pageSize;this.pagination.current=e,this.pagination.pageSize=a,this.getTableData()},peopleChange:function(t){var e=[];t.map((function(t){e.push(t.employeeId)})),this.employeeIdList=e.join(",")}}},l=c,d=(a("beae"),a("2877")),u=Object(d["a"])(l,n,o,!1,null,"767d5df2",null);e["default"]=u.exports},"6b75":function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},"6c6c":function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"e",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"j",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"i",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"h",(function(){return p})),a.d(e,"f",(function(){return m})),a.d(e,"k",(function(){return h}));var n=a("b775");function o(t){return Object(n["b"])({url:"/workContactTag/index",method:"get",params:t})}function i(t){return Object(n["b"])({url:"/workContactTag/destroy",method:"delete",data:t})}function r(t){return Object(n["b"])({url:"/workContactTag/store",method:"post",data:t})}function s(t){return Object(n["b"])({url:"/workContactTag/detail",method:"get",params:t})}function c(t){return Object(n["b"])({url:"/workContactTag/move",method:"put",data:t})}function l(t){return Object(n["b"])({url:"/workContactTag/update",method:"put",data:t})}function d(t){return Object(n["b"])({url:"/workContactTagGroup/index",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/workContactTagGroup/store",method:"post",data:t})}function p(t){return Object(n["b"])({url:"/workContactTagGroup/update",method:"put",data:t})}function m(t){return Object(n["b"])({url:"/workContactTagGroup/destroy",method:"delete",data:t})}function h(t){return Object(n["b"])({url:"/workContactTag/synContactTag",method:"put",data:t})}},"989f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"customer-detail"},[n("a-card",[n("a-row",[n("a-col",{attrs:{span:3}},[n("div",{staticClass:"img"},[n("img",{attrs:{src:e.infoDetail.avatar,alt:""}})])]),n("a-col",{attrs:{span:16}},[n("div",{staticClass:"data-box"},[n("div",{staticClass:"name"},[n("p",[e._v(e._s(e.infoDetail.name))]),n("span",[e._v("@微信")]),1===e.infoDetail.gender?n("a-icon",{attrs:{type:"man"}}):n("a-icon",{attrs:{type:"woman"}})],1),n("ul",{staticClass:"customer-data"},[n("li",[n("p",[e._v("备注名称：")]),""!==e.infoDetail.remark?n("span",[e._v(e._s(e.infoDetail.remark))]):n("span",[e._v("暂无")]),e.isContact?n("a-icon",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@update",expression:"'/workContact/contactFieldPivot@update'"}],attrs:{type:"form"},on:{click:function(){t.remarkModal=!0}}}):e._e()],1),n("li",{staticClass:"tag"},[n("p",[e._v("标签：")]),e.infoDetail.tag&&0!==e.infoDetail.tag.length?n("div",e._l(e.infoDetail.tag,(function(t){return n("span",{key:t.tagId,staticStyle:{marginRight:"10px",color:"#37AFD8"}},[e._v(" "+e._s(t.tagName)+" ")])})),0):n("span",[e._v("暂无")]),e.isContact?n("a-icon",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@update",expression:"'/workContact/contactFieldPivot@update'"}],attrs:{type:"form"},on:{click:function(){t.allTagModal=!0,t.getAllTag()}}}):e._e()],1),n("li",[n("p",[e._v("描述：")]),""!==e.infoDetail.description?n("span",[e._v(e._s(e.infoDetail.description))]):n("span",[e._v("暂无")]),e.isContact?n("a-icon",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@update",expression:"'/workContact/contactFieldPivot@update'"}],attrs:{type:"form"},on:{click:function(){t.descriptionModal=!0}}}):e._e()],1),n("li",[n("p",[e._v("客户编号：")]),""!==e.infoDetail.businessNo?n("span",[e._v(e._s(e.infoDetail.businessNo))]):n("span",[e._v("暂无")]),e.isContact?n("a-icon",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@update",expression:"'/workContact/contactFieldPivot@update'"}],attrs:{type:"form"},on:{click:function(){t.businessNoModal=!0}}}):e._e()],1)])]),n("a-modal",{attrs:{visible:e.remarkModal,title:"修改备注"},on:{cancel:function(){t.remarkModal=!1}}},[n("a-input",{attrs:{maxLength:10},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.remarkModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.editRemark}},[e._v("确定")])],1)],2),n("a-modal",{attrs:{visible:e.descriptionModal,title:"修改描述"},on:{cancel:function(){t.descriptionModal=!1}}},[n("a-textarea",{attrs:{maxLength:150},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.descriptionModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.editDescription}},[e._v("确定")])],1)],2),n("a-modal",{attrs:{visible:e.businessNoModal,title:"客户编号"},on:{cancel:function(){t.businessNoModal=!1}}},[n("a-input",{model:{value:e.businessNo,callback:function(t){e.businessNo=t},expression:"businessNo"}}),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.businessNoModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.editBusinessNo}},[e._v("确定")])],1)],2),n("a-modal",{attrs:{visible:e.allTagModal,title:"为筛选的客户增加标签"},on:{cancel:function(){t.allTagModal=!1}}},[n("a-form",{attrs:{"label-col":{span:4},"wrapper-col":{span:17}}},[n("a-form-item",{attrs:{label:"选择分组"}},[n("a-select",{on:{change:e.selectChange},model:{value:e.groupId,callback:function(t){e.groupId=t},expression:"groupId"}},[n("a-select-option",{attrs:{value:""}},[e._v(" 所有分组 ")]),e._l(e.groupList,(function(t){return n("a-select-option",{key:t.groupId},[e._v(" "+e._s(t.groupName)+" ")])}))],2)],1)],1),n("a-checkbox-group",{on:{change:e.onTagChange},model:{value:e.changeTagList,callback:function(t){e.changeTagList=t},expression:"changeTagList"}},e._l(e.tagData,(function(t){return n("a-checkbox",{key:t.id,attrs:{disabled:-1!==e.tagCheckboxList.indexOf(t.id),value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.allTagModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.addTag}},[e._v("确定")])],1)],2)],1)],1),n("div",{staticClass:"customer"},[n("div",{staticClass:"two"},[n("h3",[e._v("所在群")]),e.infoDetail.roomName&&0!==e.infoDetail.roomName.length?n("p",e._l(e.infoDetail.roomName,(function(t,a){return n("span",{key:a},[e._v(e._s(t))])})),0):n("span",[e._v("暂无")])]),n("div",[n("h3",[e._v("归属企业成员")]),n("p",e._l(e.infoDetail.employeeName,(function(t,a){return n("span",{key:a},[e._v(e._s(t))])})),0)])]),n("a-tabs",{staticStyle:{marginTop:"20px"},attrs:{type:"card"}},[n("a-tab-pane",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@track",expression:"'/workContact/contactFieldPivot@track'"}],key:"1",attrs:{tab:"互动轨迹"}},[e._l(e.trackList,(function(t){return n("a-timeline",{key:t.id},[n("a-timeline-item",{attrs:{color:"blue"}},[e._v(" "+e._s(t.createdAt)+" "),n("p",{staticStyle:{background:"#eee",padding:"10px"}},[e._v(" "+e._s(t.content)+" ")])])],1)}))],2),n("a-tab-pane",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@detail",expression:"'/workContact/contactFieldPivot@detail'"}],key:"2",attrs:{tab:"用户画像"}},[n("div",{directives:[{name:"permission",rawName:"v-permission",value:"/workContact/contactFieldPivot@edit",expression:"'/workContact/contactFieldPivot@edit'"}],staticClass:"btn-box"},[e.editPivotDis?n("div",[n("a-button",{staticStyle:{marginRight:"10px"},on:{click:e.reset}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.editPivot}},[e._v("提交")])],1):n("a-button",{attrs:{type:"primary"},on:{click:function(){t.editPivotDis=!0}}},[e._v("编辑")])],1),n("div",{staticClass:"portrait"},e._l(e.portraitList,(function(t,a){return n("div",{key:t.contactFieldId,staticClass:"box-list"},[n("a-tag",{attrs:{color:"#108ee9"}},[e._v(" "+e._s(t.name)+" ")]),e.editPivotDis&&"下拉"===t.typeText?n("a-select",{staticStyle:{width:"200px"},on:{change:e.changePortrait},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.options,(function(t,a){return n("a-select-option",{key:a+"e",staticStyle:{width:"100%"},attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),e.editPivotDis&&"单选"===t.typeText?n("a-radio-group",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.options,(function(t,a){return n("a-radio",{key:a+"aw",attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),e.editPivotDis&&"文本"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"手机号"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"日期"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"邮箱"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"数字"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"生日"===t.typeText?n("a-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),e.editPivotDis&&"多选"===t.typeText?n("a-checkbox-group",{on:{change:function(t){return e.changeItem(a)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(t.options,(function(t,a){return n("a-checkbox",{key:a+t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),e.editPivotDis&&"图片"===t.typeText?n("div",{on:{click:function(t){return e.indexImg(a)}}},[n("upload",{attrs:{imageUrl:t.pictureFlag,"file-type":1},on:{success:e.uploadSuccess}})],1):e._e(),e.editPivotDis||"图片"===t.typeText||"多选"===t.typeText?e._e():n("span",[e._v(e._s(t.value))]),e.editPivotDis||"多选"!==t.typeText||0===t.value.length?e._e():n("span",[e._v(" "+e._s(t.value.join(",")))]),e.editPivotDis||"多选"!==t.typeText||0!==t.value.length?e._e():n("span",[e._v("暂无")]),e.editPivotDis||""!==t.value?e._e():n("span",[e._v("暂无")]),e.editPivotDis||"图片"!==t.typeText||""===t.value?e._e():n("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.pictureFlag}})],1)})),0)])],1)],1)],1)},o=[],i=(a("a4d3"),a("e01a"),a("d81d"),a("a630"),a("3ca3"),a("d3b7"),a("6062"),a("ddb0"),a("99af"),a("d68b")),r=a("6c6c"),s=a("4b65"),c={components:{upload:s["a"]},data:function(){return{isContact:!1,contactId:"",employeeId:"",infoDetail:{},remarkModal:!1,tagModal:!1,descriptionModal:!1,businessNoModal:!1,groupList:[],portraitList:[],remark:"",description:"",businessNo:"",editPivotDis:!1,allTagModal:!1,groupId:"",tagData:[],tagCheckboxList:[],changeTagList:[],allTagList:[],imgUrl:"",checklist:[],imgIndex:null,trackList:[]}},created:function(){this.contactId=this.$route.query.contactId,this.employeeId=this.$route.query.employeeId,1==this.$route.query.isContact?this.isContact=!0:this.isContact=!1,this.getInfoDetail(),this.getPortrait(),this.getTagGroup(),this.getTrack()},methods:{getInfoDetail:function(){var t=this;Object(i["g"])({contactId:this.contactId,employeeId:this.employeeId}).then((function(e){t.infoDetail=e.data,t.remark=e.data.remark,t.businessNo=e.data.businessNo,t.description=e.data.description,e.data.tag.map((function(e){t.tagCheckboxList.push(e.tagId)}))}))},getTagGroup:function(){var t=this;Object(r["i"])().then((function(e){t.groupList=e.data}))},getPortrait:function(){var t=this;Object(i["f"])({contactId:this.contactId}).then((function(e){t.portraitList=e.data,t.editPortraitList=JSON.parse(JSON.stringify(e.data))}))},editRemark:function(){var t=this;Object(i["e"])({contactId:this.contactId,employeeId:this.employeeId,remark:this.remark}).then((function(e){t.remarkModal=!1,t.getInfoDetail(),t.getTrack()}))},editDescription:function(){var t=this;Object(i["e"])({contactId:this.contactId,employeeId:this.employeeId,description:this.description}).then((function(e){t.descriptionModal=!1,t.getInfoDetail(),t.getTrack()}))},editBusinessNo:function(){var t=this;Object(i["e"])({contactId:this.contactId,employeeId:this.employeeId,businessNo:this.businessNo}).then((function(e){t.businessNoModal=!1,t.getInfoDetail(),t.getTrack()}))},editPivot:function(){var t=this;Object(i["d"])({contactId:this.contactId,userPortrait:JSON.stringify(this.portraitList)}).then((function(e){t.editPivotDis=!1,t.getPortrait(),t.getTrack()}))},getAllTag:function(){var t=this;Object(i["b"])({groupId:this.groupId}).then((function(e){t.tagData=e.data}))},onTagChange:function(t){},selectChange:function(t){var e=this;this.changeTagList.map((function(t){e.allTagList.push(t)})),this.groupId=t,this.getAllTag()},addTag:function(){var t=this,e=[];if(e=Array.from(new Set(this.tagCheckboxList.concat(this.allTagList,this.changeTagList))),e.length>20)return this.$message.error("只能添加20个标签");Object(i["e"])({contactId:this.contactId,employeeId:this.employeeId,tag:e}).then((function(e){t.allTagModal=!1,t.getInfoDetail(),t.groupId="",t.allTagList=[],t.changeTagList=[],t.getTrack()}))},changePortrait:function(t){},uploadSuccess:function(t){this.portraitList[this.imgIndex].value=t.path,this.portraitList[this.imgIndex].pictureFlag=t.fullPath},indexImg:function(t){this.imgIndex=t},changeItem:function(t){},reset:function(){this.editPivotDis=!1,this.portraitList=this.editPortraitList,this.imgUrl=""},getTrack:function(){var t=this;Object(i["j"])({contactId:this.contactId}).then((function(e){t.trackList=e.data}))}}},l=c,d=(a("459d"),a("2877")),u=Object(d["a"])(l,n,o,!1,null,"5dd21cd6",null);e["default"]=u.exports},"9f4c":function(t,e,a){"use strict";a("a670")},a670:function(t,e,a){},a8b8:function(t,e,a){},a8eb:function(t,e,a){},beae:function(t,e,a){"use strict";a("0ac89")},c012:function(t,e,a){"use strict";a("0daa")},c297:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"people-wrapper"},[a("div",{staticClass:"people-left"},[a("a-input-search",{staticClass:"add-input",attrs:{maxLength:15},on:{search:t.getDepartmentList},model:{value:t.searchKeyWords,callback:function(e){t.searchKeyWords="string"===typeof e?e.trim():e},expression:"searchKeyWords"}}),a("a-tree",{attrs:{"show-icon":"",checkable:"",replaceFields:t.replaceFields,checkStrictly:!1,"expanded-keys":t.expandedKeys,"selected-keys":t.selectedKeys,"tree-data":t.treeData},on:{check:t.onCheck,expand:t.onExpand},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}},[a("a-icon",{attrs:{slot:"folder",type:"folder-open"},slot:"folder"})],1)],1),a("div",{staticClass:"people-right"},[a("div",{staticClass:"total"},[t._v("已选择成员")]),a("ul",t._l(t.choosePeopleKey,(function(e,n){return a("li",{key:n,staticClass:"number"},[a("span",{staticClass:"title"},[t._v(t._s(e.employeeName))]),a("a-icon",{staticClass:"close",attrs:{type:"close"},on:{click:function(a){return t.deletePeople(e,n)}}})],1)})),0)])])},o=[],i=a("2909"),r=a("1da1"),s=a("5530"),c=(a("4de4"),a("d3b7"),a("a15b"),a("caad"),a("2532"),a("a434"),a("d81d"),a("0481"),a("4069"),a("159b"),a("99af"),a("96cf"),a("59e4")),l=a("5880"),d={name:"Department",props:{memberKey:{type:Array,default:function(){return[]}},isChecked:{type:Array,default:function(){return[]}}},data:function(){return{searchKeyWords:"",checkedKeys:[],replaceFields:{title:"name",key:"id",children:"son"},expandedKeys:[],selectedKeys:[],treeData:[],lastCheckdKeys:[],choosePeopleKey:[],departmentIds:[],flatAry:[],unchecked:[]}},watch:{memberKey:function(t){this.choosePeopleKey=t},choosePeopleKey:function(t){this.$emit("change",t)},isChecked:function(t){this.checkedKeys=t}},computed:Object(s["a"])({},Object(l["mapGetters"])(["corpName"])),created:function(){var t=this;this.choosePeopleKey=this.memberKey,this.checkedKeys=this.isChecked;var e=this.corpName?0:2e3;setTimeout((function(){t.getDepartmentList()}),e)},methods:{getDepartmentList:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,o,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={searchKeyWords:t.searchKeyWords},e.prev=1,e.next=4,Object(c["l"])(a);case 4:n=e.sent,o=n.data,i=o.department,r=o.employee,""!==t.searchKeyWords&&t.$emit("search",r),t.department=i||[],t.employee=r||[],t.treeData=[{name:t.corpName,nameEn:"company",id:"company",slots:{icon:"folder"},son:i}],e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](1);case 16:case"end":return e.stop()}}),e,null,[[1,14]])})))()},onCheck:function(t){var e=this,a=t.length,n=this.lastCheckdKeys.length,o=[],i=[];a>n?(o=t.filter((function(t){return-1==e.lastCheckdKeys.indexOf(t)&&"company"!==t})),this.getWorkDepartmentList(o.join(","))):(i=this.lastCheckdKeys.filter((function(e){return-1==t.indexOf(e)&&"company"!==e})),this.choosePeopleKey=this.choosePeopleKey.filter((function(t){return!i.includes(t.departmentId)}))),this.lastCheckdKeys=t},onExpand:function(t){this.expandedKeys=t},deletePeople:function(t,e){var a=this;this.choosePeopleKey.splice(e,1);var n=this.departmentIds[t.employeeId];n.map((function(t){var e=a.choosePeopleKey.filter((function(e){return e.departmentId==t}));if(0==e.length){var n=a.checkedKeys.indexOf("company");n>-1&&a.checkedKeys.splice(n,1),a.dealDeleteData(t),a.unchecked.map((function(t){var e=a.checkedKeys.indexOf(t);e>-1&&a.checkedKeys.splice(e,1)}))}})),0==this.choosePeopleKey.length&&(this.checkedKeys=[])},dealDeleteData:function(t){var e=this.treeData[0];this.flatAry=[],this.unchecked=[],this.flat(e.son,t);var a=this.unchecked.length;a>1&&this.filterId(this.unchecked[a-1])},filterId:function(t){var e=this;this.flatAry.filter((function(a){if(a.id==t)return e.unchecked.push(t),0!=a.parentId&&e.filterId(a.parentId),!0}))},flat:function(t,e){var a=this;t.forEach((function(t){a.flatAry.push(t),t.id==e&&(0!=t.parentId?a.unchecked=[t.id,t.parentId]:a.unchecked=[t.id]),t.son&&a.flat(t.son,e)}))},getWorkDepartmentList:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,o,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.departmentIds={},a.prev=1,a.next=4,Object(c["A"])({departmentIds:t});case 4:n=a.sent,o=n.data,o=o||[],e.choosePeopleKey=[].concat(Object(i["a"])(e.choosePeopleKey),Object(i["a"])(o)),r=[],s=[],e.choosePeopleKey.forEach((function(t){var a=s.indexOf(t.employeeId);a>-1?e.departmentIds[t.employeeId].push(t.departmentId):(e.departmentIds[t.employeeId]=[t.departmentId],s.push(t.employeeId),r.push(t))})),e.choosePeopleKey=r,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](1);case 16:case"end":return a.stop()}}),a,null,[[1,14]])})))()}}},u=d,p=(a("4f1c"),a("2877")),m=Object(p["a"])(u,n,o,!1,null,"393e889a",null);e["a"]=m.exports},c7d8:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"label-wrapper"},[n("a-row",[n("a-col",[n("div",{staticClass:"lists",attrs:{split:!1}},[n("a-alert",{attrs:{"show-icon":!1,message:"1、标签分组名称不能重复。",banner:""}}),n("a-alert",{attrs:{"show-icon":!1,message:"2、标签总数量不限制，但给每个客户打标签最多为20个。",banner:""}}),n("a-alert",{attrs:{"show-icon":!1,message:"3、标签分组一旦被删除，归属于该分组的标签均将被删除。",banner:""}}),n("a-alert",{attrs:{"show-icon":!1,message:"4、【未分组】为固定存在，不可修改名称，亦不可删除。",banner:""}})],1),n("a-modal",{attrs:{title:"新增分组",visible:e.visible},on:{cancel:function(){t.visible=!1}}},[n("a-input",{attrs:{maxLength:15,placeholder:"请输入分组名（不得超过15个字符）"},model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}}),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.visible=!1}}},[e._v(" 取消 ")]),n("a-button",{key:"submit",attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.addGroup}},[e._v(" 确定 ")])],1)],2),n("a-modal",{attrs:{title:"修改分组",visible:e.editGroupModal},on:{cancel:function(){t.editGroupModal=!1,t.editGroupId="",t.editGroupName=""}}},[n("a-form-model",{attrs:{"label-col":{span:5},"wrapper-col":{span:14}}},[n("a-form-model-item",{attrs:{label:"选择分组"}},[n("a-select",{model:{value:e.editGroupId,callback:function(t){e.editGroupId=t},expression:"editGroupId"}},e._l(e.groupData,(function(t){return n("a-select-option",{key:t.groupId,attrs:{disabled:0==t.groupId}},[e._v(" "+e._s(t.groupName)+" ")])})),1)],1),n("a-form-model-item",{attrs:{label:"修改分组名称"}},[n("a-input",{attrs:{maxLength:15,placeholder:"请输入分组名（不得超过15个字符）"},model:{value:e.editGroupName,callback:function(t){e.editGroupName=t},expression:"editGroupName"}})],1)],1),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.editGroupModal=!1,t.editGroupId="",t.editGroupName=""}}},[e._v(" 取消 ")]),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.editGroupDefine}},[e._v(" 确定 ")])],1)],2),n("a-card",[n("a-form-model",{attrs:{"label-col":{span:2},"wrapper-col":{span:5}}},[n("a-form-model-item",{attrs:{label:"选择分组"}},[n("a-select",{on:{change:e.clickGroup},model:{value:e.changeGroupId,callback:function(t){e.changeGroupId=t},expression:"changeGroupId"}},e._l(e.groupData,(function(t){return n("a-select-option",{key:t.groupId},[e._v(" "+e._s(t.groupName)+" ")])})),1)],1)],1),n("div",{staticClass:"btn-box"},[n("p",[e._v("最后一次同步时间："+e._s(e.lastTime))]),n("div",[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@sync",expression:"'/workContactTag/index@sync'"}],on:{click:e.synContactTag}},[e._v("同步企业微信标签")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@editGroup",expression:"'/workContactTag/index@editGroup'"}],staticStyle:{marginRight:"10px"},attrs:{type:"primary"},on:{click:function(){t.editGroupModal=!0}}},[e._v("修改分组")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@addGroup",expression:"'/workContactTag/index@addGroup'"}],attrs:{type:"primary"},on:{click:function(){t.visible=!0}}},[e._v("新增分组")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@deleteTag",expression:"'/workContactTag/index@deleteTag'"}],attrs:{type:"primary"},on:{click:e.deleteTagModal}},[e._v("删除标签")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@move",expression:"'/workContactTag/index@move'"}],attrs:{type:"primary"},on:{click:e.moveTagModal}},[e._v("移动标签")]),n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@add",expression:"'/workContactTag/index@add'"}],attrs:{type:"primary"},on:{click:function(){t.modalVisible=!0}}},[e._v("新建标签")])],1)]),n("a-table",{attrs:{bordered:"",columns:e.columns,"data-source":e.tableData,rowKey:function(t){return t.id},"row-selection":{selectedRowKeys:e.deleteList,onChange:e.onSelectChange},pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"action",fn:function(t,a){return n("div",{},[[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@edit",expression:"'/workContactTag/index@edit'"}],attrs:{type:"link"},on:{click:function(t){return e.editContactTag(a.id)}}},[e._v("编辑")]),n("a-popconfirm",{directives:[{name:"permission",rawName:"v-permission",value:"/workContactTag/index@delete",expression:"'/workContactTag/index@delete'"}],attrs:{title:a.name+"标签删除后，则相应的用户失去了该标签属性。确定删除吗？","ok-text":"确认","cancel-text":"取消"},on:{confirm:function(t){return e.delTag(a.id)}}},[n("a-button",{attrs:{type:"link"}},[e._v("删除")])],1)]],2)}}])}),n("a-modal",{attrs:{width:"300px",visible:e.deleteModal},on:{cancel:function(){t.deleteModal=!1}}},[n("span",[e._v("确定删除选中的标签?")]),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.deleteModal=!1}}},[e._v(" 取消 ")]),n("a-button",{attrs:{type:"primary"},on:{click:e.deleteTag}},[e._v(" 确定 ")])],1)],2),n("a-modal",{attrs:{width:"600px",visible:e.modalVisible,title:"新增标签"},on:{cancel:function(){t.modalVisible=!1}}},[n("a-form",{attrs:{"label-col":{span:5},"wrapper-col":{span:18}}},[n("a-form-item",{attrs:{label:"选择分组："}},[n("a-select",{model:{value:e.addTagData.groupId,callback:function(t){e.$set(e.addTagData,"groupId",t)},expression:"addTagData.groupId"}},e._l(e.groupData,(function(t){return n("a-select-option",{key:t.groupId},[e._v(" "+e._s(t.groupName)+" ")])})),1)],1),n("a-form-item",{attrs:{label:"标签名称"}},[n("span",[e._v("每个标签名称最多15个字。同时新建多个标签时，请用“空格隔开”")]),n("a-input",{model:{value:e.addTagData.tagName,callback:function(t){e.$set(e.addTagData,"tagName",t)},expression:"addTagData.tagName"}})],1)],1),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.modalVisible=!1}}},[e._v(" 取消 ")]),n("a-button",{attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.saveTag}},[e._v(" 确定 ")])],1)],2),n("a-modal",{attrs:{visible:e.editVisible,title:"修改标签名称"},on:{cancel:function(){t.editVisible=!1}}},[n("a-form",{attrs:{"label-col":{span:5},"wrapper-col":{span:17}}},[n("a-form-item",{attrs:{label:"选择分组："}},[n("a-select",{model:{value:e.editTagData.groupId,callback:function(t){e.$set(e.editTagData,"groupId",t)},expression:"editTagData.groupId"}},e._l(e.groupData,(function(t){return n("a-select-option",{key:t.groupId},[e._v(" "+e._s(t.groupName)+" ")])})),1)],1),n("a-form-item",{attrs:{label:"标签名称"}},[n("a-input",{attrs:{maxLength:15},model:{value:e.editTagData.tagName,callback:function(t){e.$set(e.editTagData,"tagName",t)},expression:"editTagData.tagName"}})],1)],1),n("template",{slot:"footer"},[n("a-button",{key:"back",on:{click:function(){t.editVisible=!1}}},[e._v(" 取消 ")]),n("a-button",{attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.saveTag}},[e._v(" 确定 ")])],1)],2),n("div",{ref:"bbox",staticClass:"bbox"},[n("a-modal",{staticClass:"modal",attrs:{getContainer:function(){return e.$refs.bbox},visible:e.moveModal,title:"选择分组"},on:{cancel:function(){t.moveModal=!1}}},[n("a-select",{staticStyle:{width:"200px",marginBottom:"20px"},on:{change:e.changeGroupMove},model:{value:e.moveTagId,callback:function(t){e.moveTagId=t},expression:"moveTagId"}},e._l(e.groupData,(function(t){return n("a-select-option",{key:t.groupId},[e._v(" "+e._s(t.groupName)+" ")])})),1),n("div",{staticClass:"tag-box"},e._l(e.groupData,(function(t){return n("span",{key:t.groupId,class:e.classActive===t.groupId?"active":"box",on:{click:function(a){return e.moveTag(t.groupId)}}},[e._v(e._s(t.groupName))])})),0),n("template",{slot:"footer"},[n("a-button",{on:{click:function(){t.moveModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.moveDefine}},[e._v("确定")])],1)],2)],1)],1)],1)],1)],1)},o=[],i=(a("498a"),a("ac1f"),a("a15b"),a("1276"),a("5319"),a("a630"),a("3ca3"),a("d3b7"),a("6062"),a("ddb0"),a("d81d"),a("6c6c")),r={data:function(){return{btnLoading:!1,visible:!1,modalVisible:!1,editVisible:!1,deleteModal:!1,moveModal:!1,editGroupModal:!1,columns:[{title:"标签名称",dataIndex:"name",align:"center"},{title:"客户数",dataIndex:"contactNum",align:"center"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],tableData:[],groupData:[],addTagData:{},editTagData:{},deleteList:[],newGroupName:"",groupId:"",changeGroupId:"",moveTagData:{},lastTime:"",moveTagId:null,classActive:0,pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},editTagUpdateData:{},editGroupUpdateData:{},editGroupName:"",editGroupId:""}},created:function(){this.getTableData(),this.getGroup()},methods:{getTableData:function(){var t=this,e={groupId:this.changeGroupId,page:this.pagination.current,perPage:this.pagination.pageSize};Object(i["d"])(e).then((function(e){t.tableData=e.data.list,t.lastTime=e.data.syncTagTime,t.pagination.total=e.data.page.total,t.deleteList=[]}))},getGroup:function(){var t=this;Object(i["i"])().then((function(e){t.groupData=e.data,t.changeGroupId=0}))},clickGroup:function(t){this.changeGroupId=t,this.getTableData()},addGroup:function(){var t=this;""!=this.newGroupName.trim()?(this.btnLoading=!0,Object(i["b"])({groupName:this.newGroupName}).then((function(e){t.newGroupName="",t.btnLoading=!1,t.visible=!1,t.getGroup()})).catch((function(e){t.btnLoading=!1}))):this.$message.error("请输入分组名称")},editGroup:function(t){this.editGroupModal=!0,this.groupId=t.groupId,this.newGroupName=t.groupName,this.editGroupUpdateData=t},editGroupDefine:function(){var t=this;if(""!=this.editGroupId)if(""!=this.editGroupName.trim()){var e=/\s+/g;e.test(this.editGroupName)?this.$message.error("请输入正确分组名称"):(this.btnLoading=!0,Object(i["h"])({groupId:this.editGroupId,groupName:this.editGroupName,isUpdate:2}).then((function(e){t.btnLoading=!1,t.editGroupModal=!1,t.newGroupName="",t.editGroupId="",t.editGroupName="",t.getGroup()})).catch((function(e){t.btnLoading=!1})))}else this.$message.error("请输入分组名称");else this.$message.error("请选择分组")},deleteGroup:function(t){var e=this;Object(i["f"])({groupId:t}).then((function(t){e.getGroup()}))},moveTagModal:function(){0!==this.deleteList.length?(this.moveModal=!0,this.moveTagId=this.changeGroupId,this.classActive=this.changeGroupId):this.$message.error("请选择要移动的标签")},moveTag:function(t){this.classActive=t,this.moveTagId=t,this.moveTagData.groupId=t},changeGroupMove:function(t){this.moveTagId=t,this.moveTagData.groupId=t,this.classActive=t},moveDefine:function(){var t=this;this.btnLoading=!0,this.moveTagData.tagId=this.deleteList.join(","),Object(i["j"])(this.moveTagData).then((function(e){t.moveModal=!1,t.getTableData(),t.deleteList=[],t.btnLoading=!1}))},onSelectChange:function(t){this.deleteList=t},saveTag:function(){var t=this;if(this.editVisible)if(""==this.editTagData.tagName.trim())this.btnLoading=!1,this.$message.error("请输入标签名称");else{var e=null;e=this.editTagUpdateData.groupId===this.editTagData.groupId&&this.editTagUpdateData.tagName===this.editTagData.tagName?2:1,this.btnLoading=!0,Object(i["g"])({tagId:this.editTagData.tagId,groupId:this.editTagData.groupId,tagName:this.editTagData.tagName,isUpdate:e}).then((function(e){t.getTableData(),t.btnLoading=!1,t.editVisible=!1})).catch((function(e){t.btnLoading=!1}))}else if(void 0==this.addTagData.tagName)this.btnLoading=!1,this.$message.error("请输入标签名称");else{var a=!1,n=!1,o=/\s+/g,r=this.addTagData.tagName.replace(o," ").split(" "),s=Array.from(new Set(r));if(r.length>1&&s.length!==r.length)return this.btnLoading=!1,void this.$message.error("标签名称不可重复");if(r.map((function(t){""==t&&(n=!0),t.length>15&&(a=!0)})),a)return void this.$message.error("每个标签名称最多15个字");if(n)return void this.$message.error("请输入正确的分组名称");this.btnLoading=!0,Object(i["a"])({groupId:this.addTagData.groupId,tagName:r}).then((function(e){t.getTableData(),t.addTagData={},t.btnLoading=!1,t.modalVisible=!1})).catch((function(e){t.btnLoading=!1}))}},editContactTag:function(t){var e=this;this.editVisible=!0,Object(i["c"])({tagId:t}).then((function(t){e.editTagData=t.data,e.editTagUpdateData=JSON.parse(JSON.stringify(t.data))}))},delTag:function(t){var e=this;Object(i["e"])({tagId:t+""}).then((function(t){e.getTableData()}))},deleteTagModal:function(){0===this.deleteList.length?this.$message.error("请选择要删除的标签"):this.deleteModal=!0},deleteTag:function(){var t=this,e=this.deleteList.join(",");Object(i["e"])({tagId:e}).then((function(e){t.deleteModal=!1,t.getTableData()}))},synContactTag:function(){var t=this;Object(i["k"])().then((function(e){t.getTableData(),t.$message.info("同步成功")}))},handleTableChange:function(t){var e=t.current,a=t.pageSize;this.pagination.current=e,this.pagination.pageSize=a,this.getTableData()}}},s=r,c=(a("10b3"),a("2877")),l=Object(c["a"])(s,n,o,!1,null,"e3311302",null);e["default"]=l.exports},d68b:function(t,e,a){"use strict";a.d(e,"f",(function(){return o})),a.d(e,"d",(function(){return i})),a.d(e,"g",(function(){return r})),a.d(e,"e",(function(){return s})),a.d(e,"k",(function(){return c})),a.d(e,"b",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"c",(function(){return u})),a.d(e,"a",(function(){return p})),a.d(e,"i",(function(){return m})),a.d(e,"j",(function(){return h}));var n=a("b775");function o(t){return Object(n["b"])({url:"/contactFieldPivot/index",method:"get",params:t})}function i(t){return Object(n["b"])({url:"/contactFieldPivot/update",method:"put",data:t})}function r(t){return Object(n["b"])({url:"/workContact/show",method:"get",params:t})}function s(t){return Object(n["b"])({url:"/workContact/update",method:"put",data:t})}function c(t){return Object(n["b"])({url:"/workContact/index",method:"get",params:t})}function l(t){return Object(n["b"])({url:"/workContactTag/allTag",method:"get",params:t})}function d(t){return Object(n["b"])({url:"/workRoom/roomIndex",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/workContact/source",method:"get",params:t})}function p(t){return Object(n["b"])({url:"/contactField/portrait",method:"get",params:t})}function m(t){return Object(n["b"])({url:"/workContact/synContact",method:"put",data:t})}function h(t){return Object(n["b"])({url:"/workContact/track",method:"get",params:t})}},e541:function(t,e,a){},f68e:function(t,e,a){}}]);