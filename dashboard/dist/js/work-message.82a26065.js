(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["work-message"],{1195:function(t,a){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAzCAYAAADsBOpPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAQrSURBVGhD7ZjbK21RFMbPP+l+SeRW7hS5veCFeEJur0S5xZN4EEUkIUpKvCCXouQaxum3m3M119pr7zPX2nsrHV+NdmuNMb7vs8295pjrj/ww/BpONf5vw09PT7KzsyPLy8syNTUV+eSa+8lCwobv7+9la2tLuru7JScnR9LS0qKC++Spoz4RJGR4fX1dmpubJTc319eoN6ijnr6wCGWYf/HCwoKvKSIrK0vy8/Mjn355gv4wSyWU4ZGRkSgzeXl50tnZKXNzc5FvkLXLJ9fcJ2/W0w9PUAQ2PD8/7xLWsbGxIZ+fn6rKDe6T9+uDLwgCGT45OYkSZE2enp6qivigjnovB7y2sDb8/v4ug4ODLqGKigq5urpSFXagnj6TB174bWBt+ObmRqqrqx0RflRHR0cqGwz00a+54IXfBtaG9/b2JDs72xGZmJhQmXCgX3PBC78NrA0PDQ05ApmZmXJ2dqYy4UA/PJoTfhtYG25vb3fIy8vLA69dL+iHR3PCbwNrw0VFRQ55XV2d3N3dqUw40A+P5oTfBtaGCwoKHPLa2lq5vb1VmXCgHx7NCb8NrA03NjY65CUlJXJxcaEy4UA/PJoTfhtYG+7t7XXIicPDQ5UJB/pNPvhtYG14ZWVF0tPTHYGxsTGVCQf6NRe88NvA2vD19bVUVVU5IoyKYb9l+syRFF74bWBt+O3tTfr7+x0RIllbM7zw28DaMDg/P5fi4mKXWKLDD3zw2iKQYbC5uekS1BF2vIQvCAIbBjMzM1EDOddtbW0yOjoayXMA5ZNr7vvVkw+KUIZZb0tLSy4DQYN+23VrIpRhRsHFxUUpLCz0NWMTAwMDoeaRQIYxOj09LTU1NZKRkeFrJEiUlZXJ5OSk9SwMrA0/PDxIS0uLrzDBw58nQF9fX2RT4EUKn1xz39x0vAEv/DawMsxw3dTUFCXEqaGnp0dWV1f/OQyRp45687ShA36bIf6fhnd3d33XakdHR0Tg+flZVdqBevro93Kig148xDXMzOrdldhSx8fH5eXlRVWFA/3weN8aoRdv1o5pmL29oaHBRVZfXy/b29sxN4iggAc+eE0ddGPNFjEN81A3SRiwDw4OVDa5gNc8IBCxNhVfw/xLvH81j7Ovry9VkVzAC7+ph77f0vA1zKZgnmi7urrk9fVVZVMD+NHRmujjw4sow7yBqaysdBo5HB4fH6tsaoGOedjFh/eNUJRh1pNuIILMqonCb+b2/m6iDA8PD7samLq+E+iZ+vgx4TL8+PjoOnoTib7hCQr0TH384EvDZZjJv7S01ClmC/34+FDZ7wF65taNH/NE4jK8v7/veh62traqzPcCXe0BP/jScBleW1tzPc686+e7YP6O8IMvDZfhy8tLmZ2djYyGhO3Il2ygqz0Q5iHXZfgn4NdwqvFrONX4YYZF/gKB6bB2CTcbPgAAAABJRU5ErkJggg=="},"1c81":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=this,e=a.$createElement,s=a._self._c||e;return s("div",[s("a-card",[s("div",{staticClass:"table-page-search-wrapper"},[s("a-form",[s("a-row",{attrs:{gutter:48}},[s("a-col",{attrs:{sm:6,xm:24}},[s("a-form-item",[s("a-input",{attrs:{placeholder:"搜索企业微信名称"},model:{value:a.searchName,callback:function(t){a.searchName=t},expression:"searchName"}})],1)],1),s("a-col",{attrs:{sm:8,xm:24}},[s("span",{staticClass:"table-page-search-submitButtons"},[s("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workMessageConfig/corpShow@search",expression:"'/workMessageConfig/corpShow@search'"}],attrs:{type:"primary"},on:{click:function(){t.pagination.current=1,t.getTableData()}}},[a._v("查找")]),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){t.searchName=""}}},[a._v("清空")])],1)])],1)],1)],1),s("div",{staticClass:"table-wrapper"},[s("a-table",{attrs:{columns:a.columns,"data-source":a.tableData,rowKey:function(t){return t.corpId},pagination:a.pagination},on:{change:a.handleTableChange},scopedSlots:a._u([{key:"action",fn:function(t,e){return[s("a-button",{directives:[{name:"permission",rawName:"v-permission",value:"/workMessageConfig/corpShow@check",expression:"'/workMessageConfig/corpShow@check'"}],staticStyle:{marginRight:"10px"},on:{click:function(t){return a.getInformationData(e.corpId)}}},[a._v("查看")]),e.chatApplyStatus<=1?s("a-button",{on:{click:function(t){return a.opending(e)}}},[a._v("开通")]):a._e()]}},{key:"chatStatus",fn:function(t,e){return[e.chatApplyStatus>1?s("span",[a._v("已开通")]):a._e(),e.chatApplyStatus<=1?s("span",[a._v("未开通")]):a._e()]}}])})],1),s("a-modal",{attrs:{width:640,visible:a.visible},on:{cancel:function(){t.visible=!1}}},[s("a-form-model",{ref:"ruleForm",attrs:{model:a.informationData,rules:a.rules,"label-col":{span:6},"wrapper-col":{span:14}}},[s("a-form-model-item",{attrs:{label:"企业名称："}},[s("a-input",{attrs:{disabled:"",placeholder:"输入企业微信企业名称"},model:{value:a.informationData.corpName,callback:function(t){a.$set(a.informationData,"corpName",t)},expression:"informationData.corpName"}})],1),s("a-form-model-item",{attrs:{label:"企业ID："}},[s("a-input",{attrs:{disabled:"",placeholder:"输入企业微信ID"},model:{value:a.informationData.wxCorpid,callback:function(t){a.$set(a.informationData,"wxCorpid",t)},expression:"informationData.wxCorpid"}})],1),s("a-form-model-item",{attrs:{label:"企业代码：",prop:"socialCode"}},[s("a-input",{attrs:{maxLength:18,placeholder:""},model:{value:a.informationData.socialCode,callback:function(t){a.$set(a.informationData,"socialCode",t)},expression:"informationData.socialCode"}})],1),s("a-form-model-item",{attrs:{label:"企业负责人：",prop:"chatAdmin"}},[s("a-input",{attrs:{placeholder:""},model:{value:a.informationData.chatAdmin,callback:function(t){a.$set(a.informationData,"chatAdmin",t)},expression:"informationData.chatAdmin"}})],1),s("a-form-model-item",{attrs:{label:"企业负责人电话：",prop:"chatAdminPhone"}},[s("a-input",{attrs:{placeholder:""},model:{value:a.informationData.chatAdminPhone,callback:function(t){a.$set(a.informationData,"chatAdminPhone",t)},expression:"informationData.chatAdminPhone"}})],1),s("a-form-model-item",{attrs:{label:"企业负责人身份证：",prop:"chatAdminIdcard"}},[s("a-input",{attrs:{placeholder:""},model:{value:a.informationData.chatAdminIdcard,callback:function(t){a.$set(a.informationData,"chatAdminIdcard",t)},expression:"informationData.chatAdminIdcard"}})],1),s("a-form-model-item",{attrs:{label:"是否开通：",prop:"chatApplyStatus"}},[s("a-radio-group",{model:{value:a.informationData.chatApplyStatus,callback:function(t){a.$set(a.informationData,"chatApplyStatus",t)},expression:"informationData.chatApplyStatus"}},[s("a-radio",{attrs:{value:1}},[a._v(" 已开通 ")]),s("a-radio",{attrs:{value:2}},[a._v(" 未开通 ")])],1)],1)],1),s("template",{slot:"footer"},[s("a-button",{key:"submit",attrs:{loading:a.btnLoading,type:"primary"},on:{click:a.defineInformation}},[a._v(" 确认 ")]),s("a-button",{key:"back",on:{click:function(){t.visible=!1}}},[a._v(" 取消 ")])],1)],2),s("a-modal",{attrs:{width:640,visible:a.lookModal},on:{cancel:function(){t.lookModal=!1}}},[s("a-form",{attrs:{"label-col":{span:6},"wrapper-col":{span:14}}},[s("a-form-item",{attrs:{label:"企业名称："}},[s("a-input",{model:{value:a.lookData.name,callback:function(t){a.$set(a.lookData,"name",t)},expression:"lookData.name"}})],1),s("a-form-item",{attrs:{label:"企业ID："}},[s("a-input",{model:{value:a.lookData.wxCorpid,callback:function(t){a.$set(a.lookData,"wxCorpid",t)},expression:"lookData.wxCorpid"}})],1),s("a-form-item",{attrs:{label:"企业代码："}},[s("a-input",{model:{value:a.lookData.socialCode,callback:function(t){a.$set(a.lookData,"socialCode",t)},expression:"lookData.socialCode"}})],1),s("a-form-item",{attrs:{label:"企业负责人："}},[s("a-input",{model:{value:a.lookData.chatAdmin,callback:function(t){a.$set(a.lookData,"chatAdmin",t)},expression:"lookData.chatAdmin"}})],1),s("a-form-item",{attrs:{label:"企业负责人电话："}},[s("a-input",{model:{value:a.lookData.chatAdminPhone,callback:function(t){a.$set(a.lookData,"chatAdminPhone",t)},expression:"lookData.chatAdminPhone"}})],1),s("a-form-item",{attrs:{label:"企业负责人身份证："}},[s("a-input",{model:{value:a.lookData.chatAdminIdcard,callback:function(t){a.$set(a.lookData,"chatAdminIdcard",t)},expression:"lookData.chatAdminIdcard"}})],1)],1),s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:function(){t.lookModal=!1}}},[a._v(" 关闭 ")])],1)],2)],1)],1)},r=[],i=(e("ac1f"),e("b775"));function n(t){return Object(i["b"])({url:"/workMessageConfig/corpStore",method:"post",data:t})}function o(t){return Object(i["b"])({url:"/workMessageConfig/corpShow",method:"get",params:t})}function c(t){return Object(i["b"])({url:"/workMessageConfig/corpIndex",method:"get",params:t})}var l={data:function(){return{btnLoading:!1,visible:!1,lookModal:!1,searchName:"",columns:[{title:"企业名称",dataIndex:"corpName",align:"center"},{title:"企业ID",dataIndex:"wxCorpid",align:"center"},{title:"申请时间",dataIndex:"createdAt",align:"center"},{title:"状态",dataIndex:"chatApplyStatus",align:"center",scopedSlots:{customRender:"chatStatus"}},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],tableData:[],informationData:{},lookData:{},pagination:{total:0,current:1,pageSize:10,showSizeChanger:!0},rules:{socialCode:[{required:!0,message:"请输入企业代码",trigger:"blur"}],chatAdmin:[{required:!0,message:"请输入企业负责人",trigger:"blur"}],chatAdminPhone:[{required:!0,message:"请输入企业负责人电话",trigger:"blur"}],chatAdminIdcard:[{required:!0,message:"请输入企业负责人身份证",trigger:"blur"}],chatApplyStatus:[{required:!0,message:"请选择是否开通",trigger:"change"}]}}},created:function(){this.getTableData()},methods:{getTableData:function(){var t=this,a={corpName:this.searchName,page:this.pagination.current,perPage:this.pagination.pageSize};c(a).then((function(a){t.tableData=a.data.list,t.pagination.total=a.data.page.total}))},opending:function(t){this.visible=!0,this.informationData.wxCorpid=t.wxCorpid,this.informationData.corpName=t.corpName},getInformationData:function(t){var a=this;o({corpId:t}).then((function(t){a.lookModal=!0,a.lookData=t.data}))},defineInformation:function(){var t=this;this.$refs.ruleForm.validate((function(a){if(!a)return!1;var e=/^1[3|4|5|7|8][0-9]\d{8}$/,s=/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}$)/;return e.test(t.informationData.chatAdminPhone)?s.test(t.informationData.chatAdminIdcard)?(t.btnLoading=!0,void n(t.informationData).then((function(a){t.btnLoading=!1,t.getTableData(),t.visible=!1,t.informationData={}}))):(t.btnLoading=!1,t.$message.error("请输入正确的证件号码")):(t.btnLoading=!1,t.$message.error("请输入正确的手机号"))}))},handleTableChange:function(t){var a=t.current,e=t.pageSize;this.pagination.current=a,this.pagination.pageSize=e,this.getTableData()}}},p=l,u=e("2877"),d=Object(u["a"])(p,s,r,!1,null,"598b1446",null);a["default"]=d.exports},"1fc8a":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"wrapper"},[e("a-row",[e("a-col",{attrs:{span:6}},[e("div",{staticClass:"left-wrapper"},[e("div",{staticClass:"left"},[e("div",{staticClass:"top"},[e("div",{staticClass:"avatar-wrapper"},[t.thumbAvatar?e("img",{staticClass:"avatar",attrs:{src:t.thumbAvatar,onerror:t.errorImg,alt:""}}):e("a-icon",{staticClass:"icon",attrs:{type:"user"}})],1),e("a-select",{staticClass:"avatar-select",attrs:{"show-search":""},on:{change:t.selectChange,search:t.workEmployeeSearch},model:{value:t.workEmployeeName,callback:function(a){t.workEmployeeName=a},expression:"workEmployeeName"}},t._l(t.workEmployees,(function(a,s){return e("a-select-option",{key:s,attrs:{value:a.name}},[t._v(" "+t._s(a.name)+" ")])})),1)],1),e("div",{staticClass:"type-wrapper"},[e("span",{staticClass:"type",class:0==t.type?"active":"",on:{click:function(a){return t.choose(0)}}},[t._v("内部")]),e("span",{staticClass:"type",class:1==t.type?"active":"",on:{click:function(a){return t.choose(1)}}},[t._v("外部")]),e("span",{staticClass:"type",class:2==t.type?"active":"",on:{click:function(a){return t.choose(2)}}},[t._v("群聊")])]),e("div",[e("a-input-search",{attrs:{placeholder:"按名称搜索"},on:{search:t.getNameList},model:{value:t.searchName,callback:function(a){t.searchName=a},expression:"searchName"}}),e("ul",{staticClass:"msg-wrapper"},t._l(t.msgList,(function(a,s){return e("li",{key:s,staticClass:"msg-item",class:s==t.msgIndex?"active":"",on:{click:function(e){return t.changePeople(a,s)}}},[e("div",{staticClass:"left"},[a.avatar?e("img",{staticClass:"img",attrs:{src:a.avatar,onerror:t.errorImg,alt:""}}):e("a-icon",{staticClass:"icon",attrs:{type:"user"}})],1),e("div",{staticClass:"right"},[e("div",{staticClass:"right-name"},[e("span",{staticClass:"text name"},[t._v(t._s(a.name))]),e("span",{staticClass:"text"},[t._v(t._s(a.msgDataTime.slice(5)))])]),e("div",{staticClass:"right-massage"},[t._v(" "+t._s(a.content)+" ")])])])})),0)],1)])]),e("div",{staticClass:"left-pagination"},[e("a-pagination",{attrs:{"page-size-options":t.pageSizeOptions,total:t.leftTotal,"show-size-changer":"","page-size":t.leftPageSize},on:{showSizeChange:t.onShowSizeChange},model:{value:t.leftCurrent,callback:function(a){t.leftCurrent=a},expression:"leftCurrent"}})],1)]),e("a-col",{attrs:{span:18}},[e("div",{staticClass:"card"},[e("ul",{staticClass:"info-wrapper"},t._l(t.typeList,(function(a,s){return e("li",{key:s,staticClass:"info-item",class:a.type==t.magType?"info-active":"",on:{click:function(e){return t.changeType(a.type)}}},[t._v(" "+t._s(a.text)+" ")])})),0),e("div",{staticClass:"message-wrapper"},[e("div",{staticClass:"top-search"},[e("span",{staticClass:"name"},[t._v(t._s(t.toUserName))]),e("div",{staticClass:"time-wrapper"},[e("div",{staticClass:"search-left"},[e("a-input",{staticClass:"search-key",attrs:{placeholder:"请输入搜索内容"},model:{value:t.searchMsgKey,callback:function(a){t.searchMsgKey=a},expression:"searchMsgKey"}}),e("a-range-picker",{staticClass:"search-time",attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},on:{change:t.dateChange},model:{value:t.searchTime,callback:function(a){t.searchTime=a},expression:"searchTime"}})],1),e("div",{staticClass:"search-right"},[e("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.getMessageList}},[t._v("搜索")]),e("a-button",{staticClass:"btn",on:{click:t.clearKey}},[t._v("清空")])],1)])]),e("ul",{staticClass:"message-content"},t._l(t.messageData,(function(a,s){return e("li",{key:s,staticClass:"message-item"},[e("div",{staticClass:"people-wrapper",class:1==a.isCurrentUser?"people-self":""},[e("div",{staticClass:"people-avatar"},[a.avatar?e("img",{staticClass:"img",attrs:{src:a.avatar,onerror:t.errorImg,alt:""}}):e("a-icon",{staticClass:"icon",attrs:{type:"user"}})],1),e("div",{staticClass:"people-info"},[e("div",{staticClass:"name-wrapper",class:1==a.isCurrentUser?"self-name-wrapper":""},[e("span",{staticClass:"name"},[t._v(t._s(a.name))]),e("span",{staticClass:"message-time"},[t._v(t._s(a.msgDataTime))])]),1==a.type||a.type>7?e("div",{class:["info",1==a.isCurrentUser?"self-info":""]},[t._v(" "+t._s(a.content.content)+" "),a.content.item?e("div",{staticClass:"info-item"},t._l(a.content.item,(function(a,s){return e("div",{key:s},[e("div",[t._v(" "+t._s(a.content)+" ")])])})),0):t._e()]):e("div",{class:["info","white",1==a.isCurrentUser?"self-info":""]},[2==a.type?e("a",{attrs:{href:a.content.fullPath,target:"blank"}},[e("img",{staticClass:"img",attrs:{src:a.content.fullPath,onerror:t.errorImg,alt:""}})]):t._e(),4==a.type?e("audio",{staticClass:"audio",attrs:{controls:""}},[e("source",{attrs:{src:a.content.fullPath,type:"audio/mpeg"}}),e("source",{attrs:{src:a.content.fullPath,type:"audio/ogg"}})]):t._e(),5==a.type?e("video",{staticClass:"video",attrs:{poster:"",controls:"","data-setup":"{}",preload:"auto"}},[e("source",{attrs:{src:a.content.fullPath}})]):t._e(),6==a.type?e("div",{staticClass:"little"},[e("div",{staticClass:"wrpper"},[t._v("小程序")]),e("div",{staticClass:"title-wrapper"},[e("div",{staticClass:"name"},[t._v(t._s(a.content.displayname))]),e("div",{staticClass:"title"},[t._v(t._s(a.content.title))]),e("div",{staticClass:"description"},[t._v(" "+t._s(a.content.description)+" ")])])]):t._e(),7==a.type?e("a",{attrs:{href:a.content.fullPath,target:"blank"}},[e("div",{staticClass:"other"},[e("a-icon",{staticClass:"file",attrs:{type:"file"}}),e("span",{staticClass:"file-name"},[t._v("文件")])],1)]):t._e()])])])])})),0)])]),e("div",{staticClass:"right-pagination"},[e("a-pagination",{attrs:{"page-size-options":t.rightPageSizeOptions,total:t.rightTotal,"show-size-changer":"","page-size":t.rightPageSize},on:{showSizeChange:t.rightShowSizeChange},model:{value:t.rightCurrent,callback:function(a){t.rightCurrent=a},expression:"rightCurrent"}})],1)])],1)],1)},r=[],i=e("1da1"),n=e("5530"),o=(e("96cf"),e("b0c0"),e("7db0"),e("d3b7"),e("2985")),c=e("c1df"),l=e.n(c),p=e("5880"),u={data:function(){return{workEmployeeId:"",workEmployeeName:"",thumbAvatar:"",workEmployees:[],type:0,searchName:"",msgList:[],msgIndex:0,typeList:[{type:0,text:"所有"},{type:1,text:"文本"},{type:2,text:"图片"},{type:3,text:"图文"},{type:4,text:"音频"},{type:5,text:"视频"},{type:6,text:"小程序"},{type:7,text:"文件"}],magType:0,roomId:"",toUserId:"",toUserName:"",messageData:[],timer:null,searchTime:null,searchMsgKey:"",dateTimeStart:"",dateTimeEnd:"",leftCurrent:1,pageSizeOptions:["20","30","50","100"],leftTotal:0,leftPageSize:20,rightCurrent:1,rightPageSizeOptions:["50","100","150","200"],rightTotal:0,rightPageSize:50,errorImg:'this.src="'+e("1195")+'"'}},computed:Object(n["a"])({},Object(p["mapGetters"])(["corpId"])),created:function(){var t=this,a=this.corpId?0:2e3;setTimeout((function(){t.getEmployeeList()}),a)},methods:{getEmployeeList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var e,s,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(o["f"])({corpId:t.corpId});case 3:e=a.sent,s=e.data,t.workEmployees=s,r=s[0],r&&(t.workEmployeeId=r.id,t.workEmployeeName=r.name,t.thumbAvatar=r.avatar||"",t.getNameList()),a.next=12;break;case 10:a.prev=10,a.t0=a["catch"](0);case 12:case"end":return a.stop()}}),a,null,[[0,10]])})))()},selectChange:function(t){var a=this,e=this.workEmployees.find((function(t){return t.name==a.workEmployeeName})),s=e.avatar,r=e.id;this.thumbAvatar=s||"",this.workEmployeeId=r||"",this.getNameList()},choose:function(t){this.type=t,this.getNameList()},workEmployeeSearch:function(t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(o["f"])({corpId:a.corpId,name:t});case 3:s=e.sent,r=s.data,a.workEmployees=r,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})))()},getNameList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var e,s,r,i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.workEmployeeId){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,e={workEmployeeId:t.workEmployeeId,toUsertype:t.type,name:t.searchName,page:t.leftCurrent,perPage:t.leftPageSize},a.next=6,Object(o["e"])(e);case 6:s=a.sent,r=s.data,i=r.page.total,n=r.list,t.msgList=n,t.leftTotal=i,n[0]?t.changePeople(n[0],0):(t.messageData=[],t.rightTotal=0),a.next=17;break;case 15:a.prev=15,a.t0=a["catch"](2);case 17:case"end":return a.stop()}}),a,null,[[2,15]])})))()},changePeople:function(t,a){this.msgIndex=a;var e=t.toUserId;this.toUserId=e,this.getMessageList()},changeType:function(t){this.magType=t,this.getMessageList()},getMessageList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var e,s,r,i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.workEmployeeId&&t.toUserId){a.next=2;break}return a.abrupt("return");case 2:return e={corpId:t.corpId,workEmployeeId:t.workEmployeeId,type:t.magType,toUserId:t.toUserId,toUserType:t.type,content:t.searchMsgKey,dateTimeStart:t.dateTimeStart,dateTimeEnd:t.dateTimeEnd,page:t.rightCurrent,perPage:t.rightPageSize},a.prev=3,a.next=6,Object(o["b"])(e);case 6:s=a.sent,r=s.data,i=r.page.total,n=r.list,t.messageData=n,t.rightTotal=i,a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](3);case 16:case"end":return a.stop()}}),a,null,[[3,14]])})))()},dateChange:function(t,a){this.dateTimeStart=a[0],this.dateTimeEnd=a[1],a[0]&&a[1]?this.searchTime=[l()(this.dateTimeStart,"YYYY-MM-DD HH:mm:ss"),l()(this.dateTimeEnd,"YYYY-MM-DD HH:mm:ss")]:this.searchTime=null},clearKey:function(){this.searchMsgKey="",this.dateTimeStart="",this.dateTimeEnd="",this.searchTime=null},onShowSizeChange:function(t,a){this.leftCurrent=t,this.leftPageSize=a,this.getNameList()},rightShowSizeChange:function(t,a){this.rightCurrent=t,this.rightPageSize=a,this.getMessageList()}}},d=u,m=(e("21de"),e("2877")),h=Object(m["a"])(d,s,r,!1,null,"526d839b",null);a["default"]=h.exports},"21de":function(t,a,e){"use strict";e("5700")},2985:function(t,a,e){"use strict";e.d(a,"a",(function(){return r})),e.d(a,"d",(function(){return i})),e.d(a,"c",(function(){return n})),e.d(a,"f",(function(){return o})),e.d(a,"e",(function(){return c})),e.d(a,"b",(function(){return l}));var s=e("b775");function r(t){return Object(s["b"])({url:"/workMessageConfig/corpStore",method:"post",data:t})}function i(t){return Object(s["b"])({url:"/workMessageConfig/stepUpdate",method:"put",data:t})}function n(t){return Object(s["b"])({url:"/workMessageConfig/stepCreate",method:"get",params:t})}function o(t){return Object(s["b"])({url:"/workMessage/fromUsers",method:"get",params:t})}function c(t){return Object(s["b"])({url:"/workMessage/toUsers",method:"get",params:t})}function l(t){return Object(s["b"])({url:"/workMessage/index",method:"get",params:t})}},5700:function(t,a,e){},"602b":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"chat-record"},[t.loading?e("div",{staticClass:"loading"},[e("a-spin",{attrs:{size:"large"}})],1):e("a-card",{attrs:{bordered:!1}},[e("h2",[t._v("完成以下步骤就可以成功开通啦！")]),e("a-steps",{staticClass:"steps",attrs:{current:t.currentStep}},[e("a-step",{attrs:{title:"填写企业信息"}}),e("a-step",{attrs:{title:"添加客服提交资料"}}),e("a-step",{attrs:{title:"配置后台"}})],1),0===t.currentStep?e("a-form-model",{ref:"ruleForm",staticClass:"information",attrs:{"label-col":{span:7},"wrapper-col":{span:10},model:t.formData,rules:t.rules}},[e("a-form-model-item",{attrs:{label:"企业名称:"}},[e("a-input",{attrs:{disabled:""},model:{value:t.info.corpName,callback:function(a){t.$set(t.info,"corpName",a)},expression:"info.corpName"}})],1),e("a-form-model-item",{attrs:{label:"企业ID:"}},[e("a-input",{attrs:{disabled:""},model:{value:t.info.wxCorpId,callback:function(a){t.$set(t.info,"wxCorpId",a)},expression:"info.wxCorpId"}})],1),e("a-form-model-item",{attrs:{label:"企业代码:",prop:"socialCode"}},[e("a-input",{attrs:{maxLength:18,placeholder:"请输入统一社会信用代码"},model:{value:t.info.socialCode,callback:function(a){t.$set(t.info,"socialCode",a)},expression:"info.socialCode"}})],1),e("a-form-model-item",{attrs:{label:"企业负责人:",prop:"chatAdmin"}},[e("a-input",{attrs:{placeholder:"请输入企业负责人姓名"},model:{value:t.info.chatAdmin,callback:function(a){t.$set(t.info,"chatAdmin",a)},expression:"info.chatAdmin"}})],1),e("a-form-model-item",{attrs:{label:"企业负责人身份证:",prop:"chatAdminIdcard"}},[e("a-input",{attrs:{maxLength:18,placeholder:"请输入企业负责人身份证号"},model:{value:t.info.chatAdminIdcard,callback:function(a){t.$set(t.info,"chatAdminIdcard",a)},expression:"info.chatAdminIdcard"}})],1),e("a-form-model-item",{attrs:{label:"企业负责人电话:",prop:"chatAdminPhone"}},[e("a-input",{attrs:{placeholder:"请输入企业负责人电话"},model:{value:t.info.chatAdminPhone,callback:function(a){t.$set(t.info,"chatAdminPhone",a)},expression:"info.chatAdminPhone"}})],1),e("a-form-model-item",{attrs:{"wrapper-col":{span:12,offset:10}}},[e("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(" 保存 ")])],1)],1):t._e(),1==t.currentStep?e("div",[e("div",{staticClass:"qr-wrapper"},[e("img",{staticClass:"img",attrs:{src:t.serviceContactUrl,alt:""}})]),e("div",{staticClass:"btn-wrapper"},[e("a-button",{staticClass:"next",attrs:{type:"primary"},on:{click:t.next}},[t._v("下一步")])],1)]):t._e(),2==t.currentStep?e("div",{staticClass:"configuration"},[e("div",{staticClass:"label-wrapper"},[e("span",{staticClass:"text"},[t._v("可信IP地址:")]),e("div",{staticClass:"containt"},t._l(t.chatWhitelistIp,(function(a,s){return e("div",{key:s,staticClass:"ip"},[t._v(" "+t._s(a)+" ")])})),0)]),e("div",{staticClass:"label-wrapper"},[e("span",{staticClass:"text"},[t._v("信息机密公钥:")]),e("ul",{staticClass:"containt"},[e("li",{staticClass:"key"},[e("span",{staticClass:"key-name"},[t._v("公钥")]),e("a-textarea",{staticClass:"input",attrs:{disabled:""},model:{value:t.chatRsaKey.publicKey,callback:function(a){t.$set(t.chatRsaKey,"publicKey",a)},expression:"chatRsaKey.publicKey"}}),e("a-button",{staticClass:"copy",attrs:{type:"primary",size:"small"},on:{click:function(a){return t.copy(t.chatRsaKey.publicKey)}}},[t._v("复制")])],1),e("li",{staticClass:"key"},[e("span",{staticClass:"key-name"},[t._v("私钥")]),e("a-textarea",{staticClass:"input",attrs:{disabled:""},model:{value:t.chatRsaKey.privateKey,callback:function(a){t.$set(t.chatRsaKey,"privateKey",a)},expression:"chatRsaKey.privateKey"}}),e("a-button",{staticClass:"copy",attrs:{type:"primary",size:"small"},on:{click:function(a){return t.copy(t.chatRsaKey.privateKey)}}},[t._v("复制")])],1)])]),e("div",{staticClass:"label-wrapper"},[e("span",{staticClass:"text"},[t._v("会话存档Secret:")]),e("div",{staticClass:"containt"},[e("a-input",{staticClass:"input",model:{value:t.chatSecret,callback:function(a){t.chatSecret=a},expression:"chatSecret"}})],1)]),e("div",{staticClass:"label-wrapper"},[e("span",{staticClass:"text"},[t._v("公钥版本号:")]),e("div",{staticClass:"containt"},[e("a-input",{staticClass:"input",model:{value:t.chatRsaKey.version,callback:function(a){t.$set(t.chatRsaKey,"version",a)},expression:"chatRsaKey.version"}})],1)]),e("div",{staticClass:"label-wrapper"},[e("span",{staticClass:"text"},[t._v("会话存档状态:")]),e("div",{staticClass:"containt"},[e("a-switch",{on:{change:t.statusChange},model:{value:t.chatStatus,callback:function(a){t.chatStatus=a},expression:"chatStatus"}})],1)]),e("div",{staticClass:"btn-wrapper"},[e("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.save}},[t._v(" 保存 ")])],1)]):t._e()],1)],1)},r=[],i=e("1da1"),n=e("5530"),o=(e("96cf"),e("ac1f"),e("5880")),c=e("2985"),l={data:function(){var t=this,a=function(t,a,e){if(!a)return t(new Error(e));t()},e=function(t,a){return{validator:t,trigger:a||"blur"}},s=function(e,s,r){var i=/^[A-Za-z0-9]{18}$/;s=i.test(t.info.socialCode),a(r,s,"请输入企业代码")},r=function(e,s,r){s=t.info.chatAdmin,a(r,s,"请输入企业负责人姓名")},i=function(e,s,r){var i=/^\d{17}(\d|X|x)$/;s=i.test(t.info.chatAdminIdcard),a(r,s,"请输入企业负责人身份证")},n=function(e,s,r){var i=/^1[3-9][0-9]\d{8}$/;s=i.test(t.info.chatAdminPhone),a(r,s,"请输入企业负责人电话")};return{loading:!0,currentStep:0,chatApplyStatus:0,info:{id:"",wxCorpId:"",socialCode:"",chatAdmin:"",chatAdminPhone:"",chatAdminIdcard:""},formData:{},rules:{socialCode:e(s),chatAdmin:e(r),chatAdminPhone:e(n),chatAdminIdcard:e(i)},serviceContactUrl:"",id:"",chatWhitelistIp:[],chatRsaKey:{},chatSecret:"",chatStatus:!1}},computed:Object(n["a"])({},Object(o["mapGetters"])(["corpId","corpName"])),created:function(){this.getwxData()},methods:{handleSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(a){if(!a)return!1;delete t.info.id;var e=Object(n["a"])(Object(n["a"])({},t.info),{},{chatApplyStatus:1});Object(c["a"])(e).then((function(a){t.currentStep=1}))}))},statusChange:function(t){this.chatStatus=t},getwxData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var e,s,r,i,n,o,l,p,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(c["c"])();case 3:if(e=a.sent,s=e.data,r=s.id,i=s.corpName,n=s.chatApplyStatus,o=s.wxCorpId,l=s.serviceContactUrl,p=s.chatWhitelistIp,u=s.rsaPublicKey,d=s.rsaPrivateKey,t.info.corpName=i,t.info.wxCorpId=o,t.id=r,t.serviceContactUrl=l,t.chatWhitelistIp=p,t.chatRsaKey={publicKey:u,privateKey:d,version:""},t.chatApplyStatus=n,0==n){a.next=25;break}if(4!=n){a.next=24;break}return t.$router.push({path:"/workMessage/toUsers"}),a.abrupt("return");case 24:t.currentStep=n-1;case 25:t.loading=!1,a.next=30;break;case 28:a.prev=28,a.t0=a["catch"](0);case 30:case"end":return a.stop()}}),a,null,[[0,28]])})))()},next:function(){this.currentStep=2;var t={chatApplyStatus:2};Object(c["d"])(t)},copy:function(t){var a=this;this.$copyText(t).then((function(t){a.$message.success("复制完毕")})).catch((function(t){a.$message.error("复制失败")}))},save:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var e;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e={chatApplyStatus:3,chatWhitelistIp:t.chatWhitelistIp,chatRsaKey:t.chatRsaKey,chatSecret:t.chatSecret,chatStatus:t.chatStatus?1:0},a.prev=1,a.next=4,Object(c["d"])(e);case 4:t.$router.push({path:"/workMessage/toUsers"}),a.next=9;break;case 7:a.prev=7,a.t0=a["catch"](1);case 9:case"end":return a.stop()}}),a,null,[[1,7]])})))()}}},p=l,u=(e("84b9"),e("2877")),d=Object(u["a"])(p,s,r,!1,null,"28110f03",null);a["default"]=d.exports},"84b9":function(t,a,e){"use strict";e("eb00")},eb00:function(t,a,e){}}]);