(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["lottery"],{"00ef":function(t,e,a){},"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f");var s=a("6b75");function i(t,e){if(t){if("string"===typeof t)return Object(s["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(s["a"])(t,e):void 0}}},1184:function(t,e,a){"use strict";a.d(e,"f",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"e",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"i",(function(){return c})),a.d(e,"j",(function(){return d})),a.d(e,"g",(function(){return u})),a.d(e,"k",(function(){return m})),a.d(e,"b",(function(){return p})),a.d(e,"h",(function(){return f}));var s=a("b775");function i(t){return Object(s["b"])({url:"/lottery/index",method:"GET",params:t})}function n(t){return Object(s["b"])({url:"lottery/store",method:"POST",data:t})}function r(t){return Object(s["b"])({url:"lottery/showContact",method:"GET",params:t})}function o(t){return Object(s["b"])({url:"/lottery/show",method:"GET",params:t})}function l(t){return Object(s["b"])({url:"/lottery/destroy",method:"DELETE",data:t})}function c(t){return Object(s["b"])({url:"/lottery/share",method:"GET",params:t})}function d(t){return Object(s["b"])({url:"/lottery/update",method:"PUT",data:t})}function u(t){return Object(s["b"])({url:"/lottery/info",method:"GET",params:t})}function m(t){return Object(s["b"])({url:"/lottery/writeOff",method:"GET",params:t})}function p(t){return Object(s["b"])({url:"/lottery/batchContactTags",method:"put",data:t})}function f(t){return Object(s["b"])({url:"/officialAccount/index",method:"GET",params:t})}},"1b86":function(t,e,a){},"219e":function(t,e,a){"use strict";a("bd07")},2645:function(t,e,a){"use strict";a("00ef")},2722:function(t,e,a){"use strict";a("c465")},3235:function(t,e,a){},"32bd":function(t,e,a){},"5bb1":function(t,e,a){},6010:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tagsModal"},[a("a-modal",{staticClass:"modelCard",attrs:{title:"选择标签",maskClosable:!1},on:{ok:t.handleOk},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[t._l(t.lableArr,(function(e,s){return a("div",{key:s,staticClass:"labelRow"},[a("div",{staticClass:"labelTitle"},[t._v(t._s(e.groupName))]),a("div",{staticClass:"labelContent"},[a("div",{staticClass:"labeladdBtn",on:{click:function(a){t.showInput=e.id}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加 ")],1),t.showInput==e.id?a("a-input",{staticClass:"lable_input",attrs:{placeholder:"输入后回车"},on:{blur:t.closeInput,pressEnter:function(a){return t.inputLable(e.id,s)}},model:{value:t.addlableCont,callback:function(e){t.addlableCont=e},expression:"addlableCont"}}):t._e(),t._l(e.tags,(function(e,s){return a("div",{key:s,ref:"hello",refInFor:!0,staticClass:"labelSub",class:[-1!=t.choiceTagsArr.indexOf(e)?"lableSelect":""],on:{click:function(a){return t.selectTags(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)])})),a("span",{staticClass:"add_tags",on:{click:t.addNametags}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 新建标签组 ")],1)],2),a("a-modal",{attrs:{title:"新建标签组"},on:{ok:t.handleNewTags},model:{value:t.addNewTags,callback:function(e){t.addNewTags=e},expression:"addNewTags"}},[a("div",{staticClass:"add_tigs"},[a("a-icon",{attrs:{type:"bell",theme:"filled"}}),t._v(" 管理员可根据不同部门选择展示不同的标签组，部门管理员可创建部门可见的标签 ")],1),a("a-form-model",{attrs:{model:t.tagsform,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{attrs:{label:"标签组名称"}},[a("a-input",{attrs:{placeholder:"请输入标签组名称"},model:{value:t.tagsform.name,callback:function(e){t.$set(t.tagsform,"name",e)},expression:"tagsform.name"}})],1)],1)],1)],1)},i=[],n=a("1da1"),r=(a("96cf"),a("a434"),a("d3b7"),a("159b"),a("b0c0"),a("7728")),o={data:function(){return{modalShow:!1,addNewTags:!1,showInput:0,addlableCont:"",lableArr:[],labelCol:{span:5},wrapperCol:{span:18},tagsform:{name:"",resource:1,selectSection:[]},tipsWarn:!0,choiceTagsArr:[]}},created:function(){this.getClientTags()},methods:{getClientTags:function(){var t=this;Object(r["d"])({page:1,perPage:10}).then((function(e){t.lableArr=e.data}))},selectTags:function(t){var e=this.choiceTagsArr.indexOf(t);-1==e?this.choiceTagsArr.push(t):this.choiceTagsArr.splice(e,1)},memberSelectChange:function(t){this.tagsform.selectSection=t},show:function(t){var e=this;this.choiceTagsArr=[],void 0!=t&&t.forEach((function(t,a){e.choiceTagsArr[a]=t})),this.modalShow=!0},delSelect:function(t){this.tagsform.selectSection.splice(t,1)},handleOk:function(t){this.modalShow=!1,this.$emit("choiceTagsArr",this.choiceTagsArr)},handleNewTags:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=t.tagsform.name){e.next=3;break}return t.$message.warning("标签组名称不能为空"),e.abrupt("return");case 3:Object(r["j"])({groupName:t.tagsform.name}).then((function(e){t.getClientTags(),t.tagsform.name="",t.$message.success("创建成功"),t.addNewTags=!1}));case 4:case"end":return e.stop()}}),e)})))()},closeInput:function(){this.showInput=!1},inputLable:function(t,e){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var i,n,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=[],i.push(a.addlableCont),n={groupId:t,tagName:i},s.next=5,Object(r["l"])(n).then((function(t){}));case 5:o={name:a.addlableCont},a.lableArr[e].tags.push(o),a.showInput=!1,a.addlableCont="";case 9:case"end":return s.stop()}}),s)})))()},addNametags:function(){this.addNewTags=!0}}},l=o,c=(a("981e"),a("2877")),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},"6b75":function(t,e,a){"use strict";function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}a.d(e,"a",(function(){return s}))},7728:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"m",(function(){return n})),a.d(e,"f",(function(){return r})),a.d(e,"h",(function(){return o})),a.d(e,"g",(function(){return l})),a.d(e,"c",(function(){return c})),a.d(e,"i",(function(){return d})),a.d(e,"l",(function(){return u})),a.d(e,"d",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"j",(function(){return f})),a.d(e,"b",(function(){return _})),a.d(e,"k",(function(){return v}));var s=a("b775");function i(t){return Object(s["b"])({url:"/roomClockIn/store",method:"post",data:t})}function n(t){return Object(s["b"])({url:"/roomClockIn/update",method:"put",data:t})}function r(t){return Object(s["b"])({url:"/roomClockIn/destroy",method:"delete",data:t})}function o(t){return Object(s["b"])({url:"/roomClockIn/index",method:"get",params:t})}function l(t){return Object(s["b"])({url:"/roomClockIn/show",method:"get",params:t})}function c(t){return Object(s["b"])({url:"/roomClockIn/showContact",method:"get",params:t})}function d(t){return Object(s["b"])({url:"/roomClockIn/info",method:"get",params:t})}function u(t){return Object(s["b"])({url:"/workContactTag/store",method:"post",data:t})}function m(t){return Object(s["b"])({url:"/workContactTag/contactTagList",method:"get",params:t})}function p(t){return Object(s["b"])({url:"/roomClockIn/dayDetail",method:"get",params:t})}function f(t){return Object(s["b"])({url:"/workContactTagGroup/store",method:"post",data:t})}function _(t){return Object(s["b"])({url:"/roomClockIn/batchContactTags",method:"put",data:t})}function v(t){return Object(s["b"])({url:"/officialAccount/index",method:"GET",params:t})}},"78f4":function(t,e,a){},"7b3b":function(t,e,a){"use strict";a("da7d")},9095:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box"},[s("div",{staticClass:"switch_account"},[t._v(" 公众号："),s("a-select",{staticStyle:{width:"150px"},model:{value:t.officialAccount,callback:function(e){t.officialAccount=e},expression:"officialAccount"}},t._l(t.publiclist,(function(e,a){return s("a-select-option",{key:a,attrs:{value:e.nickname}},[t._v(" "+t._s(e.nickname)+" ")])})),1)],1),s("a-card",[s("a-tabs",{attrs:{type:"card"},on:{change:t.analysis},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[s("a-tab-pane",{key:"1",attrs:{tab:"任务列表"}},[s("div",{staticClass:"search"},[s("div",{staticClass:"create mt8"},[s("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/lottery/create")}}},[t._v(" 创建抽奖活动 ")])],1)]),s("div",{staticClass:"screen mt16 mb14"},[s("span",[t._v(" 筛选： ")]),s("a-radio-group",{attrs:{name:"radioGroup","default-value":0},on:{change:t.listChange}},[s("a-radio",{attrs:{value:0}},[t._v(" 全部 ")]),s("a-radio",{attrs:{value:1}},[t._v(" 进行中 ")]),s("a-radio",{attrs:{value:2}},[t._v(" 未开始 ")]),s("a-radio",{attrs:{value:3}},[t._v(" 已结束 ")])],1)],1),s("div",{staticClass:"task-list"},[s("a-table",{attrs:{columns:t.listData.table.col,"data-source":t.listData.table.data},scopedSlots:t._u([{key:"contact_clock_tags",fn:function(e){return s("div",{},t._l(e.contact_clock_tags,(function(e){return s("a-tag",{key:e.tagid},[t._v(" "+t._s(e[0])+" ")])})),1)}},{key:"nickname",fn:function(e){return s("div",{},[s("a-tag",[s("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(e.nickname)+" ")],1)],1)}},{key:"operation",fn:function(e){return s("div",{},[s("a",{on:{click:function(a){return t.details(e)}}},[t._v("详情")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{on:{click:function(a){return t.$refs.share.show(e.id)}}},[t._v("分享")]),s("a-divider",{attrs:{type:"vertical"}}),s("a-dropdown",[s("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v(" 编辑 "),s("a-icon",{attrs:{type:"down"}})],1),s("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[s("a-menu-item",[s("a",{on:{click:function(a){return t.modifyData(e.id)}}},[t._v("修改")])]),s("a-menu-item",[s("a",{on:{click:function(a){return t.delData(e.id)}}},[t._v(" 删除 ")])])],1)],1)],1)}}])})],1)]),s("a-tab-pane",{key:"2",attrs:{tab:"数据分析"}},[s("div",{staticClass:"current"},[s("span",[t._v(" 当前活动： ")]),s("div",[s("a-input-group",{attrs:{compact:""}},[s("a-select",{staticStyle:{width:"140px"},on:{change:t.detailsDataChange},model:{value:t.dataAnalysis.lotteryCurrent,callback:function(e){t.$set(t.dataAnalysis,"lotteryCurrent",e)},expression:"dataAnalysis.lotteryCurrent"}},t._l(t.listData.table.data,(function(e){return s("a-select-option",{key:e.id},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),s("span",{staticClass:"activity-status"},[t._v(" 活动进行中 ")])])])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.dataShow,expression:"dataShow"}],staticClass:"big-content"},[s("div",{staticClass:"content-top mt16"},[s("a-card",[s("div",{staticClass:"details-box"},[s("div",{staticClass:"title"},[t._v(" 抽奖活动详情 ")]),s("div",{staticClass:"details-content"},[s("div",{staticClass:"details-left"},[s("div",{staticClass:"preview elastic"},[s("span",[t._v(" 预览： ")]),s("div",{staticClass:"preview-box"},[s("span",[t._v(" "+t._s(t.data.lottery.name)+" ")]),s("div",{staticClass:"preview-bottom mt16"},[s("div",{staticStyle:{"font-size":"10px",color:"#8d8d8d"}},[t._v(" "+t._s(t.data.lottery.description)+" ")]),s("img",{staticStyle:{position:"absolute",width:"40px",height:"40px",right:"10px",bottom:"10px"},attrs:{src:a("9973")}})])])]),s("div",{staticClass:"activity mt20 elastic"},[s("span",[t._v(" 活动名称： ")]),s("div",{staticClass:"activity-name"},[s("span",[t._v(" "+t._s(t.data.lottery.name)+" ")]),s("span",{staticClass:"activity-status"},[t._v(" "+t._s(t.data.lottery.status)+" ")])])]),s("div",{staticClass:"founder mt16 elastic"},[s("span",[t._v(" 创建人： ")]),s("a-tag",[s("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(t.data.lottery.nickname)+" ")],1)],1),s("div",{staticClass:"creation-time mt16 elastic"},[s("span",[t._v(" 创建时间: ")]),s("div",{staticClass:"time ml8"},[s("span",[t._v(" "+t._s(t.data.lottery.createdAt)+" ")])])]),s("div",{staticClass:"end-date mt16 elastic"},[s("span",[t._v(" 截止时间： ")]),s("div",{staticClass:"end"},[t._v(" "+t._s(t.data.lottery.time)+" ")])])]),s("div",{staticClass:"details-right"},[s("div",{staticClass:"rule elastic"},[s("span",[t._v(" 抽奖规则： ")]),s("div",{staticClass:"rule-box"},[s("div",{staticClass:"lottery-restrictions"},[s("span",{staticClass:"small-title"},[t._v(" 抽奖限制 ")]),s("div",{staticClass:"text"},[t.data.lottery.draw_set.max_total_num?s("span",[t._v(" 每人总抽奖次数： "),s("span",[t._v(" "+t._s(t.data.lottery.draw_set.max_total_num)+" ")]),t._v(" 次 ")]):t._e(),t.data.lottery.draw_set.max_every_day_num?s("span",[t._v(" 每人每日抽奖次数： "),s("span",[t._v(" "+t._s(t.data.lottery.draw_set.max_every_day_num)+" ")]),t._v(" 次 ")]):t._e(),t.data.lottery.draw_set.point_deplete?s("span",[t._v(" 每人每次抽奖消耗积分： "),s("span",[t._v(" "+t._s(t.data.lottery.draw_set.point_deplete)+" ")]),t._v(" 分 ")]):t._e()])]),s("div",{staticClass:"lottery-restrictions mt12"},[s("span",{staticClass:"small-title"},[t._v(" 中奖限制 ")]),s("div",{staticClass:"text"},[t.data.lottery.win_set.max_total_num?s("span",[t._v(" 每人总中奖次数： "),s("span",[t._v(" "+t._s(t.data.lottery.win_set.max_total_num)+" ")]),t._v(" 次 ")]):t._e(),t.data.lottery.win_set.max_every_day_num?s("span",[t._v(" 每人每日中奖次数： "),s("span",[t._v(" "+t._s(t.data.lottery.win_set.max_every_day_num)+" ")]),t._v(" 次 ")]):t._e()])])])])])])])])],1),s("div",{staticClass:"content-middle"},[s("div",{staticClass:"middle-left"},[s("a-card",{staticStyle:{height:"390px"}},[s("div",{staticClass:"title"},[t._v(" 数据总览 ")]),s("div",{staticClass:"data-box mb20"},[s("div",{staticClass:"data"},[s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.total_browse_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 总浏览人数 ")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.total_draw_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 总参与人数 ")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.total_win_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 总获奖人数 ")])])]),s("div",{staticClass:"data mt15"},[s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.today_browse_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 今日浏览人数 ")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.today_draw_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 今日参与人数 ")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"count"},[t._v(" "+t._s(t.data.data_statistics.today_win_user)+" ")]),s("div",{staticClass:"desc"},[t._v(" 今日获奖人数 ")])])])])])],1),s("div",{staticClass:"middle-right"},[s("a-card",{staticStyle:{height:"390px"}},[s("div",{staticClass:"title"},[t._v(" 奖励明细 ")]),s("div",{staticClass:"award-details"},[s("a-table",{attrs:{columns:t.dataAnalysis.detailed.col,"data-source":t.dataAnalysis.detailed.data,scroll:{y:240},pagination:!1}})],1)])],1)]),s("div",{staticClass:"content-bottom mt16"},[s("a-card",[s("div",{staticClass:"title"},[t._v(" 客户数据详情 ")]),s("div",{staticClass:"details-select"},[s("div",{staticClass:"screen mt16 mb14"},[s("div",{staticClass:"screen-box",staticStyle:{flex:"1"}},[s("span",[t._v(" 筛选： ")]),s("a-radio-group",{attrs:{name:"radioGroup","default-value":0},on:{change:t.detailsChange}},[s("a-radio",{attrs:{value:0}},[t._v(" 全部 ")]),s("a-radio",{attrs:{value:1}},[t._v(" 已获奖 ")]),s("a-radio",{attrs:{value:2}},[t._v(" 已参与 ")]),s("a-radio",{attrs:{value:3}},[t._v(" 已浏览未参与 ")])],1)],1),s("div",{staticClass:"button"},[s("a-button",{attrs:{type:"primary",ghost:""},on:{click:t.batchTag}},[t._v("批量打标签")])],1),s("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1),s("div",{staticClass:"common"},[s("span",{staticStyle:{"font-weight":"bold"}},[t._v(" 共"+t._s(t.dataAnalysis.details.data.length)+"个客户 ")])]),s("div",{staticClass:"search mt18 mb16"},[s("span",[t._v(" 搜索用户： ")]),s("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索用户名称"},on:{search:t.detailsSearchChange}})],1),s("div",{staticClass:"table-details"},[s("a-table",{attrs:{columns:t.dataAnalysis.details.col,"data-source":t.dataAnalysis.details.data,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},scopedSlots:t._u([{key:"nickname",fn:function(e){return s("div",{},[s("img",{staticStyle:{"max-width":"30px"},attrs:{src:t.data.lottery.avatar}}),t._v(" "+t._s(e.nickname)+" ")])}},{key:"employee",fn:function(e){return s("div",{},t._l(e,(function(e,a){return s("a-tag",{key:a},[s("a-icon",{attrs:{type:"user"}}),t._v(" "+t._s(e.name))],1)})),1)}},{key:"grade",fn:function(e){return s("div",{},[t._v(" "+t._s(e.grade)+" ")])}},{key:"contact_tags",fn:function(e){return s("div",{},t._l(e.contact_tags,(function(e){return s("a-tag",{key:e.tagid},[t._v(" "+t._s(e.tagname)+" ")])})),1)}},{key:"win_record",fn:function(e){return s("div",{},t._l(e.win_record,(function(e,a){return s("a-tag",{key:a},[t._v(" "+t._s(e.prizeName)+" ")])})),1)}},{key:"write_off",fn:function(e,a){return s("div",{},[0==e?s("a",{on:{click:function(e){return t.writeOff(a)}}},[t._v("核销")]):s("span",{staticStyle:{color:"gray"}},[t._v("已核销")])])}}])})],1)])])],1)]),s("share",{ref:"share"}),s("warrantTip",{ref:"warrantTip"})],1)},i=[],n=(a("d3b7"),a("159b"),a("b0c0"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"details"},[s("a-modal",{attrs:{width:680,footer:!1,centered:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[s("template",{slot:"title"},[t._v(" 分享 ")]),s("div",{staticClass:"mode-one"},[s("div",{staticStyle:{width:"80px"}},[t._v(" 方式一： ")]),s("div",{staticClass:"content"},[s("p",{staticStyle:{color:"#000000"}},[t._v(" 通过「客户群发」、「客户群群发」、「欢迎语」、「渠道码欢迎语」，选择发送抽奖活动链接发送至客户 ")]),s("div",{staticClass:"preview-box"},[s("span",[t._v(" "+t._s(t.data.info.name)+" ")]),s("div",{staticClass:"preview-bottom mt16"},[s("div",[t._v(" "+t._s(t.data.info.description)+" ")]),s("img",{staticStyle:{position:"absolute",width:"40px",height:"40px",right:"10px",bottom:"10px"},attrs:{src:a("9973")}})])])])]),s("div",{staticClass:"mode-two mt30"},[s("div",{staticStyle:{width:"80px"}},[t._v(" 方式二： ")]),s("div",{staticClass:"content"},[s("p",{staticStyle:{color:"#000"}},[t._v(" 下载抽奖活动二维码或复制链接 ")]),s("p",{staticStyle:{color:"#8d8d8d","font-size":"10px"}},[t._v(" 可以将二维码或链接放置在海报、宣传单、朋友圈、线下等方式发送给客户 ")]),s("div",{staticClass:"mode-bottom"},[s("div",{staticClass:"qr-code"},[s("div",{ref:"qrCode"}),s("a",{staticClass:"download",on:{click:t.downQrcode}},[t._v("下载二维码")])]),s("div",{staticClass:"link-box ml20"},[s("div",{staticClass:"link"},[t._v(" "+t._s(t.data.link)+" ")]),s("a",{staticClass:"copy",on:{click:t.copyLink}},[t._v("复制链接")])])])])])],2),s("input",{ref:"copyInput",staticClass:"copy-input",attrs:{type:"text"}})],1)}),r=[],o=(a("9911"),a("1184")),l=a("d044"),c=a.n(l),d={data:function(){return{modalShow:!1,data:{info:{name:"",description:""}}}},methods:{getData:function(t){var e=this;Object(o["i"])({id:t}).then((function(t){e.modalShow=!0,e.data=t.data,e.initQrcode()}))},copyLink:function(){var t=this.$refs.copyInput;t.value=this.data.link,t.select(),document.execCommand("Copy"),this.$message.success("复制成功")},downQrcode:function(){var t=this.$refs.qrCode.childNodes[1],e=document.createElement("a"),a=new MouseEvent("click");e.download="qrcode",e.href=t.src,e.dispatchEvent(a)},initQrcode:function(){this.$refs.qrCode.innerHTML="",new c.a(this.$refs.qrCode,{text:this.data.link,width:100,height:100})},show:function(t){this.modalShow=!0,this.getData(t)},hide:function(){this.modalShow=!1}}},u=d,m=(a("7b3b"),a("2877")),p=Object(m["a"])(u,n,r,!1,null,"5010e78e",null),f=p.exports,_=a("6010"),v=a("b30d"),h={components:{share:f,addlableIndex:_["a"],warrantTip:v["a"]},data:function(){return{listData:{table:{col:[{title:"抽奖活动名称",dataIndex:"name"},{title:"创建人",scopedSlots:{customRender:"nickname"}},{title:"总参与人数",dataIndex:"total_user"},{title:"创建时间",dataIndex:"created_at"},{title:"活动时间",dataIndex:"time"},{title:"状态",dataIndex:"status"},{title:"操作",scopedSlots:{customRender:"operation"}}],data:[]}},dataAnalysis:{detailed:{col:[{title:"奖项名称",dataIndex:"name"},{title:"奖项数量",dataIndex:"num"},{title:"抽中数量",dataIndex:"win_num"},{title:"剩余数量",dataIndex:"differ_num"},{title:"兑换方式",dataIndex:"type"}],data:[]},details:{col:[{title:"全部客户",scopedSlots:{customRender:"nickname"}},{title:"客户类型",dataIndex:"type"},{title:"来源",dataIndex:"source"},{title:"城市",dataIndex:"city"},{title:"所属员工",dataIndex:"employee",scopedSlots:{customRender:"employee"}},{title:"客户评分",scopedSlots:{customRender:"grade"}},{title:"标签",scopedSlots:{customRender:"contact_tags"}},{title:"已抽奖次数",dataIndex:"draw_num"},{title:"参与程度",dataIndex:"status"},{title:"获奖记录",scopedSlots:{customRender:"win_record"}},{title:"操作",dataIndex:"write_off",scopedSlots:{customRender:"write_off"}}],data:[]},fileterCurrent:0,lotteryCurrent:""},dataShow:!1,data:{lottery:{name:"",draw_set:{max_total_num:"",max_every_day_num:"",point_deplete:""},contactTags:[{tags:[],grade:0}],win_set:{max_total_num:"",max_every_day_num:""}},data_statistics:{total_browse_user:"",total_draw_user:"",total_win_user:"",today_browse_user:"",today_draw_user:"",today_win_user:""}},form:{id:""},currentTab:"1",selectedRowKeys:[],askClientIds:[],publiclist:[],officialAccount:""}},mounted:function(){this.getData()},created:function(){this.setUpPublicName(),this.getPublicList()},methods:{setUpPublicName:function(){var t=this;Object(o["h"])({type:2}).then((function(e){t.officialAccount=e.data.nickname}))},getPublicList:function(){var t=this;Object(o["h"])().then((function(e){t.publiclist=e.data,0==t.publiclist.length&&t.$refs.warrantTip.show()}))},onSelectChange:function(t){this.selectedRowKeys=t},acceptArray:function(t){var e=this;if(0==t.length)return this.$message.error("请至少选择一个标签"),!1;var a=[];t.forEach((function(t,e){var s={};s.tagid=t.id,s.tagname=t.name,a.push(s)})),Object(o["b"])({ids:this.askClientIds,tags:a}).then((function(t){e.detailsData(e.dataAnalysis.lotteryCurrent,e.dataAnalysis.fileterCurrent,e.dataAnalysis.nickname),e.selectedRowKeys=[],e.$message.success("操作成功")}))},batchTag:function(){var t=this;if(0==this.selectedRowKeys.length)return this.$message.warning("请先选中一个客户"),!1;this.askClientIds=[],this.selectedRowKeys.forEach((function(e,a){t.askClientIds[a]=t.dataAnalysis.details.data[e].id})),this.$refs.childRef.show()},writeOff:function(t){var e=this;this.$confirm({title:"提示",content:"是否核销",okText:"核销",okType:"danger",cancelText:"取消",onOk:function(){Object(o["k"])({id:t.id}).then((function(t){e.detailsData(e.dataAnalysis.lotteryCurrent,e.dataAnalysis.fileterCurrent,e.dataAnalysis.nickname),e.$message.success("核销成功")}))}})},delData:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){Object(o["d"])({id:t}).then((function(t){e.$message.success("删除成功"),e.getData()}))}})},details:function(t){this.dataAnalysis.lotteryCurrent=t.name,this.dataShow=!0,this.currentTab="2",this.getPrize(t.id),this.detailsData(t.id)},modifyData:function(t){this.$router.push({path:"/lottery/modify",query:{id:t}})},detailsSearchChange:function(t){this.dataAnalysis.nickname=t,this.detailsData(this.dataAnalysis.lotteryCurrent,this.dataAnalysis.fileterCurrent,t)},detailsChange:function(t){this.dataAnalysis.fileterCurrent=t.target.value,this.detailsData(this.dataAnalysis.lotteryCurrent,t.target.value)},listChange:function(t){this.getData(t.target.value)},analysis:function(t){this.dataShow="1"!==t},getData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(o["f"])({status:e}).then((function(e){t.listData.table.data=e.data.list,e.data.list.length&&(t.detailsData(e.data.list[0].id),t.getPrize(e.data.list[0].id),t.dataAnalysis.lotteryCurrent=e.data.list[0].id)}))},detailsDataChange:function(t){this.detailsData(t),this.getPrize(t)},detailsData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(o["c"])({status:a,nickname:s,id:e}).then((function(e){t.dataAnalysis.details.data=e.data.list}))},getPrize:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(o["e"])({id:e}).then((function(e){t.data=e.data,t.dataAnalysis.detailed.data=e.data.lottery.prize_set}))}}},y=h,g=(a("9855"),Object(m["a"])(y,s,i,!1,null,"376940d1",null));e["default"]=g.exports},"946d":function(t,e,a){"use strict";a("3235")},"981e":function(t,e,a){"use strict";a("78f4")},9855:function(t,e,a){"use strict";a("32bd")},9973:function(t,e,a){t.exports=a.p+"img/lottery-default-cover.4dda877c.png"},a752:function(t,e,a){"use strict";a("1b86")},b30d:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:"设置公众号",footer:null,maskClosable:!1,closable:!1},model:{value:t.warrantTip,callback:function(e){t.warrantTip=e},expression:"warrantTip"}},[a("p",[t._v("设置授权公众号后可完整使用功能，可通过公众号授权收集客户信息和客户行为记录")]),a("div",{staticClass:"warrant_row"},[a("h3",[t._v("提示：")]),a("p",[t._v("1.公众号类型必须为认证服务号")]),a("p",[t._v("2.公众号需绑定在企业的微信开放平台")])]),a("div",{staticStyle:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.empowerAccount}},[t._v("授权公众号")])],1)])],1)},i=[],n={data:function(){return{warrantTip:!1}},methods:{show:function(){this.warrantTip=!0},empowerAccount:function(){this.$router.push({path:"/officialAccount/index"})}}},r=n,o=(a("a752"),a("2877")),l=Object(o["a"])(r,s,i,!1,null,"92020822",null);e["a"]=l.exports},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var s=a("06c5");function i(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(s["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,l=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){l=!0,r=t},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(l)throw r}}}}},bd07:function(t,e,a){},c465:function(t,e,a){},c6d0:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("a-card",{staticClass:"mb16"},[a("div",{staticClass:"steps"},[a("a-steps",{attrs:{current:t.step}},[a("a-step",{attrs:{title:"抽奖活动设置"}}),a("a-step",{attrs:{title:"奖品设置"}})],1)],1)]),a("a-card",[a("step3",{directives:[{name:"show",rawName:"v-show",value:0===t.step,expression:"step === 0"}],ref:"step3"}),a("step4",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],ref:"step4"}),0!==t.step?a("a-button",{staticClass:"mt20 mr20",attrs:{size:"large"},on:{click:function(e){t.step--}}},[t._v(" 上一步 ")]):t._e(),1!==t.step?a("a-button",{staticClass:"mt20",attrs:{type:"primary",size:"large"},on:{click:function(e){t.step++}}},[t._v(" 下一步 ")]):t._e(),1===t.step?a("a-button",{staticClass:"mt20",attrs:{type:"primary",size:"large"},on:{click:t.editClick}},[t._v(" 完成 ")]):t._e()],1)],1)},i=[],n=a("5530"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"set"},[a("div",{staticClass:"title"},[t._v(" 抽奖活动设置 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"template required"},[a("span",[t._v(" 活动模板： ")]),a("a-radio",{staticClass:"ml27",attrs:{defaultChecked:!0}},[t._v("转盘")])],1),a("div",{staticClass:"activity-name mt16 required"},[a("span",[t._v(" 抽奖活动名称： ")]),a("a-input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("div",{staticClass:"explain mt16 required"},[a("span",[t._v(" 抽奖活动说明： ")]),a("a-textarea",{staticStyle:{width:"360px"},attrs:{placeholder:"请输入活动说明",rows:6},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),a("div",{staticClass:"end"},[a("span",[t._v(" 活动结束时间： ")]),a("div",[a("a-radio-group",{attrs:{disabled:"",name:"radioGroup","default-value":1},model:{value:t.form.time_type,callback:function(e){t.$set(t.form,"time_type",e)},expression:"form.time_type"}},[a("a-radio",{attrs:{value:1}},[t._v(" 永久有效 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 自定义活动时间 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.form.time_type,expression:"form.time_type === 2"}],staticClass:"mt10 ml98"},[a("a-range-picker",{model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1)],1)],1)])]),a("div",{staticClass:"customer-label"},[a("div",{staticClass:"title mt30"},[a("span",[t._v(" 客户标签设置 ")]),a("a-switch",{staticClass:"ml4",attrs:{size:"small",checked:0!=t.form.tagList[0].tags.length}}),a("span",{staticClass:"tips ml10"},[t._v(" 最多可设置2个标签规则，已设置的标签规则不能进行修改 ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.form.tagList[0].tags.length,expression:"form.tagList[0].tags.length!=0"}]},[a("div",{staticClass:"warning"},[a("a-alert",{staticClass:"warning",attrs:{message:"企业微信接口限制，仅支持为已添加企业员工的客户打标签",type:"info","show-icon":""}})],1),a("div",{staticClass:"label"},[t._m(0),a("div",{staticClass:"label-rule"},[a("div",{staticClass:"label-box"},[a("span",[t._v(" 规则： ")]),a("div",{staticClass:"label-top mt8"},t._l(t.form.tagList,(function(e,s){return a("div",{key:s,staticClass:"mb8 label-tag"},[a("div",{staticClass:"tag"},[t._v(" 为 "),a("a-select",{staticStyle:{width:"140px"},attrs:{disabled:"","default-value":"请选择用户行为"},model:{value:e.action,callback:function(a){t.$set(e,"action",a)},expression:"v.action"}},[a("a-select-option",{attrs:{value:"1"}},[t._v(" 已参与活动 ")]),a("a-select-option",{attrs:{value:"2"}},[t._v(" 已抽中商品 ")])],1),t._v(" 的客户,打上 "),a("div",{staticClass:"choiceAdmin"},[0==e.clientTagArr.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(e.clientTagArr,(function(e,s){return a("a-tag",{key:s},[t._v(" "+t._s(e.name)+" ")])}))],2),t._v(" 标签 ")],1)])})),0)])])])])]),a("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("span",[t._v(" 客户标签： ")])])}],l=(a("b0c0"),a("a4d3"),a("e01a"),a("d3b7"),a("159b"),a("a434"),a("6010")),c=a("c1df"),d=a.n(c),u={components:{addlableIndex:l["a"]},data:function(){return{visible:!1,data:[],tagSet:!1,form:{name:"",description:"",type:"roulette",time_type:1,tagList:[{action:"1",tags:[],type:"2",grade:"",scoreShow:!0,clientTagArr:[]}],time:[]},selectInputIndex:0,delSelectlable:0,reset:!0}},methods:{getErrMsg:function(){return this.form.name?this.form.description&&(2!==this.form.time_type||this.form.time)?void 0:"活动说明未填写":"活动名称未填写"},getParams:function(){return{name:this.form.name,description:this.form.description,type:this.form.type,time_type:this.form.time_type,contact_tags:this.form.tagList,start_time:d()(this.form.time[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:d()(this.form.time[1]).format("YYYY-MM-DD HH:mm:ss")}},setParams:function(t){this.form={name:t.info.name,description:t.info.description,type:t.info.type,time_type:t.info.timeType,time:[d()(t.info.startTime),d()(t.info.endTime)],tagList:t.info.contactTags}},acceptArray:function(t){var e=this;if(t){var a=[];t.forEach((function(t,s){var i={tagid:"",tagname:""};i.tagid=t.id,i.tagname=t.name,e.form.tagList[e.selectInputIndex].tags.push(i),a[s]=t.name})),this.form.tagList[this.selectInputIndex].clientTagArr=a}else this.form.tagList[this.selectInputIndex].clientTagArr=[],this.form.tagList[this.selectInputIndex].tags=[];this.reset=!1,this.reset=!0},lableCutto:function(t){var e=this;this.form.tagList[this.selectInputIndex].clientTagArr.forEach((function(a,s){a.tagname===t&&e.form.tagList[e.selectInputIndex].clientTagArr.splice(s,1)})),this.reset=!1,this.reset=!0},handchange:function(t){this.selectInputIndex=t}}},m=u,p=(a("f6c5"),a("2877")),f=Object(p["a"])(m,r,o,!1,null,"5db7eb66",null),_=f.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"prize-setting"},[t._m(0),a("div",{staticClass:"middle"},[a("div",{staticClass:"prize-table"},[a("a-table",{staticStyle:{width:"800px"},attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"name",fn:function(e){return a("div",{},[t._v(" "+t._s(e.name)+" ")])}},{key:"total",fn:function(e){return a("div",{},[1===e.id?a("div",[t._v(" - ")]):a("div",[a("a-input",{staticStyle:{width:"85px"},attrs:{"default-value":"0"},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"row.num"}})],1)])}},{key:"probability",fn:function(e){return a("div",{},[t._v(" "+t._s(e.rate)+" % ")])}},{key:"img",fn:function(t){return a("div",{staticClass:"prize-img"},[a("img",{attrs:{src:t.image}})])}}])})],1),a("div",{staticClass:"phone-box"})]),a("div",{staticClass:"limit"},[a("div",{staticClass:"title mt30"},[t._v(" 抽奖限制设置 ")]),a("div",{staticClass:"limit-set"},[a("div",{staticClass:"sum required"},[a("span",[t._v(" 总抽奖机会： ")]),a("div",{staticClass:"sum-radio ml42"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1,disabled:""},model:{value:t.form.draw_set.type_total_num,callback:function(e){t.$set(t.form.draw_set,"type_total_num",e)},expression:"form.draw_set.type_total_num"}},[a("a-radio",{attrs:{value:1}},[t._v(" 不限 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===t.form.draw_set.type_total_num,expression:"form.draw_set.type_total_num === 2"}]},[t._v(" 每人最多有 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:""},model:{value:t.form.draw_set.max_total_num,callback:function(e){t.$set(t.form.draw_set,"max_total_num",e)},expression:"form.draw_set.max_total_num"}}),t._v(" 次抽奖机会 ")],1)],1)],1)]),a("div",{staticClass:"sum required"},[a("span",[t._v(" 每日抽奖机会： ")]),a("div",{staticClass:"sum-radio ml28"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1,disabled:""}},[a("a-radio",{attrs:{value:1}},[t._v(" 限制 ")])],1)],1),a("span",[t._v(" 每人每天最多有 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:""},model:{value:t.form.draw_set.max_every_day_num,callback:function(e){t.$set(t.form.draw_set,"max_every_day_num",e)},expression:"form.draw_set.max_every_day_num"}}),t._v(" 次抽奖机会 ")],1)]),a("div",{staticClass:"sum required"},[a("span",[t._v(" 每次抽奖消耗积分： ")]),a("div",{staticClass:"sum-radio"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1,disabled:""},model:{value:t.form.type_point,callback:function(e){t.$set(t.form,"type_point",e)},expression:"form.type_point"}},[a("a-radio",{attrs:{value:1}},[t._v(" 不消耗 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 消耗 ")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:2===t.form.type_point,expression:"form.type_point === 2"}]},[t._v(" 每人每次抽奖消耗 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:""},model:{value:t.form.draw_set.point_deplete,callback:function(e){t.$set(t.form.draw_set,"point_deplete",e)},expression:"form.draw_set.point_deplete"}}),t._v(" 分 ")],1)],1)])])]),a("div",{staticClass:"select-limit"},[a("div",{staticClass:"title mt30"},[t._v(" 中奖限制设置 ")]),a("div",{staticClass:"select-limit-set mt24"},[a("div",{staticClass:"select-sum required"},[a("span",[t._v(" 每人总中奖次数： ")]),a("div",{staticClass:"sum-radio ml14"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":2,disabled:""},model:{value:t.form.win_set.type_total_num,callback:function(e){t.$set(t.form.win_set,"type_total_num",e)},expression:"form.win_set.type_total_num"}},[a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")])],1)],1),a("span",[t._v(" 用户每人最多中奖 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:""},model:{value:t.form.win_set.max_total_num,callback:function(e){t.$set(t.form.win_set,"max_total_num",e)},expression:"form.win_set.max_total_num"}}),t._v(" 次 ")],1)]),a("div",{staticClass:"sum required"},[a("span",[t._v(" 每人每天中奖次数： ")]),a("div",{staticClass:"sum-radio"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1,disabled:""},model:{value:t.form.win_set.type_every_day_num,callback:function(e){t.$set(t.form.win_set,"type_every_day_num",e)},expression:"form.win_set.type_every_day_num"}},[a("a-radio",{attrs:{value:1}},[t._v(" 不限 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===t.form.win_set.type_every_day_num,expression:"form.win_set.type_every_day_num === 2"}]},[t._v(" 每人每天最多中奖 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:""},model:{value:t.form.win_set.max_every_day_num,callback:function(e){t.$set(t.form.win_set,"max_every_day_num",e)},expression:"form.win_set.max_every_day_num"}}),t._v(" 次 ")],1)],1)],1)])])]),a("div",{staticClass:"business-card"},[a("div",{staticClass:"title mt30"},[t._v(" 企业名片 ")]),a("div",{staticClass:"information"},[a("div",{staticClass:"portrait interval"},[a("div",{staticClass:"corporate-avatar"},[t._v("企业头像：")]),a("div",{staticClass:"upload-two"},[a("m-upload",{ref:"logo",model:{value:t.form.corp_card.logo,callback:function(e){t.$set(t.form.corp_card,"logo",e)},expression:"form.corp_card.logo"}})],1)]),a("div",{staticClass:"corporate-name"},[a("span",{staticClass:"cr-name interval"},[t._v("企业名称： "),a("a-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入企业名称"},model:{value:t.form.corp_card.name,callback:function(e){t.$set(t.form.corp_card,"name",e)},expression:"form.corp_card.name"}})],1)]),a("div",{staticClass:"mb14"},[a("div",{staticClass:"profile-title"},[t._v(" 企业简介： "),a("div",{staticClass:"switch"},[a("a-switch",{attrs:{size:"small","default-checked":""},model:{value:t.tagSet,callback:function(e){t.tagSet=e},expression:"tagSet"}})],1)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tagSet,expression:"tagSet"}],staticClass:"profile"},[a("a-textarea",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入企业简介",rows:5},model:{value:t.form.corp_card.description,callback:function(e){t.$set(t.form.corp_card,"description",e)},expression:"form.corp_card.description"}})],1)])])])},h=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v(" 奖品设置 "),a("span",{staticClass:"ml10"},[t._v(" 设置的所有奖项中奖概率总和应等于100% ")])])}],y=a("b85c"),g=(a("d81d"),{data:function(){return{table:{col:[{title:"奖品名称",scopedSlots:{customRender:"name"}},{title:"奖品总数",scopedSlots:{customRender:"total"}},{title:"中奖概率",scopedSlots:{customRender:"probability"}},{title:"奖品图片",scopedSlots:{customRender:"img"}}],data:[]},form:{is_show:1,exchange_set:[{name:"",type:1,employee_qr:"",exchange_code:{description:""}}],draw_set:{type_total_num:1,max_total_num:"",type_every_day_num:2,max_every_day_num:"",type_point:1,point_deplete:""},win_set:{type_total_num:2,max_total_num:"",type_every_day_num:1,max_every_day_num:""},corp_card:{logo:"",name:"",description:""}},tagSet:!1}},methods:{getErrMsg:function(){var t,e=Object(y["a"])(this.table.data);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(1!==a.id){if(!a.name)return"请填写奖品名称";if(!a.num)return"请填写奖品数量";if(!a.rate)return"请填写中间概率";if(!a.type)return"请填写设置奖品兑换方式"}}}catch(s){e.e(s)}finally{e.f()}return 2!==this.form.draw_set.type_total_num||this.form.draw_set.max_total_num?this.form.draw_set.max_every_day_num?this.form.win_set.max_total_num?2!==this.form.win_set.type_every_day_num||this.form.win_set.max_every_day_num?void 0:"请填写每人每天中奖次数":"请填写每人总中奖次数":"请填写每日抽奖机会":"请填写总抽奖机会"},setParams:function(t){this.form.corp_card=t.prize.corpCard,this.form.win_set=t.prize.winSet,this.form.draw_set=t.prize.drawSet,this.form.exchange_set=t.prize.exchangeSet,this.table.data=t.prize.prizeSet,this.form.corp_card.logo=this.$refs.logo.setUrl(t.prize.corpCard.logo),this.form.corp_card.description&&(this.tagSet=!0)},getParams:function(){this.table.data.forEach((function(t,e){t.id=e+1}));var t=this.table.data.map((function(t){return{name:t.name,type:t.type,employee_qr:t.employee_qr,exchange_code:t.exchange_code,description:t.description}}));return t.splice(0,1),Object(n["a"])({prize_set:this.table.data,exchange_set:t},this.form)},delTag:function(t){if(1===this.pirzeList.length)return this.$message.error("不能删除最后一个"),!1;this.tagList.splice(t,1)}}}),b=g,w=(a("219e"),Object(p["a"])(b,v,h,!1,null,"47367778",null)),C=w.exports,x=a("1184"),k={data:function(){return{step:0}},mounted:function(){this.getData()},methods:{editClick:function(){var t=this,e=this.$refs.step4.getErrMsg();if(e)return this.$message.error(e),!1;Object(x["j"])({lottery:Object(n["a"])({id:this.$route.query.id},this.$refs.step3.getParams()),prize:this.$refs.step4.getParams()}).then((function(e){t.$message.success("修改成功"),t.$router.push("/lottery/index")}))},getData:function(){var t=this;Object(x["g"])({id:this.$route.query.id}).then((function(e){t.$refs.step3.setParams(e.data),t.$refs.step4.setParams(e.data)}))}},components:{step3:_,step4:C}},S=k,$=Object(p["a"])(S,s,i,!1,null,"612b9e3c",null);e["default"]=$.exports},c86e:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("a-card",{staticClass:"mb16"},[a("div",{staticClass:"steps"},[a("a-steps",{attrs:{current:t.step}},[a("a-step",{attrs:{title:"抽奖活动设置"}}),a("a-step",{attrs:{title:"奖品设置"}})],1)],1)]),a("a-card",[a("step1",{directives:[{name:"show",rawName:"v-show",value:0===t.step,expression:"step === 0"}],ref:"step1"}),a("step2",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],ref:"step2"}),0!==t.step?a("a-button",{staticClass:"mt20 mr20",attrs:{size:"large"},on:{click:function(e){t.step--}}},[t._v(" 上一步 ")]):t._e(),1!==t.step?a("a-button",{staticClass:"mt20",attrs:{type:"primary",size:"large"},on:{click:t.next}},[t._v(" 下一步 ")]):t._e(),1===t.step?a("a-button",{staticClass:"mt20",attrs:{type:"primary",size:"large",loading:t.loading},on:{click:t.addClick}},[t._v(" 完成 ")]):t._e()],1)],1)},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"set"},[a("div",{staticClass:"title"},[t._v(" 抽奖活动设置 ")]),a("div",{staticClass:"content"},[a("div",{staticClass:"template required"},[a("span",[t._v(" 活动模板： ")]),a("a-radio",{staticClass:"ml27",attrs:{defaultChecked:!0}},[t._v("转盘")])],1),a("div",{staticClass:"activity-name mt16 required"},[a("span",[t._v(" 抽奖活动名称： ")]),a("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入活动名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("div",{staticClass:"explain mt16 required"},[a("span",[t._v(" 抽奖活动说明： ")]),a("a-textarea",{staticStyle:{width:"360px"},attrs:{placeholder:"请输入活动说明",rows:6},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),a("div",{staticClass:"end"},[a("span",[t._v(" 活动结束时间： ")]),a("div",[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1},model:{value:t.form.time_type,callback:function(e){t.$set(t.form,"time_type",e)},expression:"form.time_type"}},[a("a-radio",{attrs:{value:1}},[t._v(" 永久有效 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 自定义活动时间 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.form.time_type,expression:"form.time_type === 2"}],staticClass:"mt10 ml98"},[a("a-range-picker",{model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1)],1)],1)])]),a("div",{staticClass:"customer-label"},[a("div",{staticClass:"title mt30"},[a("span",[t._v(" 客户标签设置 ")]),a("a-switch",{staticClass:"ml4",attrs:{size:"small","default-checked":""},model:{value:t.tagSet,callback:function(e){t.tagSet=e},expression:"tagSet"}}),a("span",{staticClass:"tips ml10"},[t._v(" 最多可设置2个标签规则，已设置的标签规则不能进行修改 ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tagSet,expression:"tagSet"}]},[a("div",{staticClass:"warning"},[a("a-alert",{staticClass:"warning",attrs:{message:"企业微信接口限制，仅支持为已添加企业员工的客户打标签",type:"info","show-icon":""}})],1),a("div",{staticClass:"label"},[t._m(0),a("div",{staticClass:"label-rule"},[a("div",{staticClass:"label-box"},[a("span",[t._v(" 规则： ")]),a("div",{staticClass:"label-top mt8"},t._l(t.form.tagList,(function(e,s){return a("div",{key:s,staticClass:"mb8 mb16 label-tag"},[a("div",{staticClass:"tag"},[a("a-icon",{staticClass:"mr6",attrs:{type:"minus-circle"},on:{click:t.delTag}}),t._v(" 为 "),a("a-select",{staticStyle:{width:"140px"},attrs:{"default-value":"请选择用户行为",disabled:2==t.form.tagList.length},model:{value:e.action,callback:function(a){t.$set(e,"action",a)},expression:"v.action"}},[a("a-select-option",{attrs:{value:"1"}},[t._v(" 已参与活动 ")]),a("a-select-option",{attrs:{value:"2"}},[t._v(" 已抽中商品 ")])],1),t._v(" 的客户,打上 "),a("div",{staticClass:"choiceAdmin",on:{click:function(e){return t.showModal(s)}}},[0==e.clientTagArr.length?a("span",{staticClass:"operationTips"},[t._v("请选择标签")]):t._e(),t._l(e.clientTagArr,(function(e,i){return a("a-tag",{key:i},[t._v(" "+t._s(e.name)+" "),a("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.delTagsArr(s,i)}}})],1)}))],2),t._v(" 标签 ")],1)])})),0)]),a("div",{staticClass:"add"},[a("a",{on:{click:t.addTag}},[a("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加规则 ")],1)])])])])]),a("addlableIndex",{ref:"childRef",on:{choiceTagsArr:t.acceptArray}})],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("span",[t._v(" 客户标签： ")])])}],o=(a("b0c0"),a("a4d3"),a("e01a"),a("a434"),a("d3b7"),a("159b"),a("c1df")),l=a.n(o),c=a("6010"),d={data:function(){return{visible:!1,data:[],tagSet:!1,form:{name:"",description:"",type:"roulette",time_type:1,contact_tags:[],time:[],tagList:[{action:"1",tags:[],type:"2",grade:"",scoreShow:!0,clientTagArr:[]}]},selectInputIndex:0,delSelectlable:0,reset:!0}},methods:{getErrMsg:function(){return this.form.name?this.form.description&&(2!==this.form.time_type||this.form.time)?void 0:"活动说明未填写":"活动名称未填写"},delTagsArr:function(t,e){this.form.tagList[this.selectInputIndex].clientTagArr.splice(e,1),this.form.tagList[this.selectInputIndex].tags.splice(e,1)},getParams:function(){return{name:this.form.name,description:this.form.description,type:this.form.type,time_type:this.form.time_type,contact_tags:this.form.tagList,start_time:l()(this.form.time[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:l()(this.form.time[1]).format("YYYY-MM-DD HH:mm:ss")}},acceptArray:function(t){var e=this;if(t){var a=[];t.forEach((function(t,s){var i={tagid:"",tagname:""};i.tagid=t.id,i.tagname=t.name,e.form.tagList[e.selectInputIndex].tags.push(i),a[s]=t})),this.form.tagList[this.selectInputIndex].clientTagArr=a}else this.form.tagList[this.selectInputIndex].clientTagArr=[],this.form.tagList[this.selectInputIndex].tags=[]},handchange:function(t){this.delSelectlable=t},showModal:function(t){this.selectInputIndex=t,this.$refs.childRef.show(this.form.tagList[this.selectInputIndex].clientTagArr)},delTag:function(t){if(1===this.form.tagList.length)return this.$message.error("不能删除最后一个"),!1;this.form.tagList.splice(t,1)},addTag:function(){if(2===this.form.tagList.length)return this.$message.error("不能添加2个以上"),!1;this.form.tagList.push({action:"2",tags:[],type:"2",grade:"",scoreShow:!0,clientTagArr:[]})}},components:{addlableIndex:c["a"]}},u=d,m=(a("2722"),a("2877")),p=Object(m["a"])(u,n,r,!1,null,"3a6ddab8",null),f=p.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"prize-setting"},[t._m(0),a("div",{staticClass:"middle"},[a("div",{staticClass:"prize-table"},[a("a-table",{staticStyle:{width:"800px"},attrs:{columns:t.table.col,"data-source":t.table.data},scopedSlots:t._u([{key:"name",fn:function(e){return a("div",{},[a("a-input",{staticStyle:{width:"130px"},attrs:{disabled:1===e.id,placeholder:"请输入奖品名称"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"row.name"}})],1)}},{key:"total",fn:function(e){return a("div",{},[1!==e.id?a("a-input",{staticStyle:{width:"85px"},attrs:{"default-value":"0"},on:{input:function(t){e.num=e.num.replace(/[^\d.]/g,"")}},model:{value:e.num,callback:function(a){t.$set(e,"num",a)},expression:"row.num"}}):a("a-input",{staticStyle:{width:"85px"},attrs:{value:"-",disabled:""}})],1)}},{key:"probability",fn:function(e){return a("div",{},[a("a-input",{staticClass:"mr4",staticStyle:{width:"85px"},attrs:{"default-value":"0"},on:{input:function(t){e.rate=e.rate.replace(/[^\d.]/g,"")}},model:{value:e.rate,callback:function(a){t.$set(e,"rate",a)},expression:"row.rate"}}),t._v(" % ")],1)}},{key:"img",fn:function(e){return a("div",{staticClass:"prize-img"},[a("m-upload",{attrs:{def:!1,text:"上传奖品图片",type:"btn"},model:{value:e.image,callback:function(a){t.$set(e,"image",a)},expression:"row.image"}})],1)}},{key:"exchange",fn:function(e){return a("div",{},[1!==e.id?a("a",{on:{click:function(a){return t.$refs.exchange.show(e.id,e)}}},[t._v(" 设置 ")]):t._e(),t.reset?a("div",[e.type?a("span",[t._v(" "+t._s(1===e.type?"(客户二维码)":"(兑换码)")+" ")]):t._e()]):t._e()])}},{key:"operation",fn:function(e,s,i){return a("div",{},[1!==e.id?a("a",{on:{click:function(e){return t.delPrize(i)}}},[t._v("删除")]):t._e()])}}])}),a("div",{staticClass:"add"},[a("a",{on:{click:t.pushPrize}},[a("a-icon",{attrs:{type:"plus-circle"}}),a("span",[t._v(" 添加奖项 ")])],1)])],1),a("div",{staticClass:"phone-box"})]),a("div",{staticClass:"record mt18"},[a("a-switch",{staticClass:"mr6",attrs:{size:"small","default-checked":""},model:{value:t.form.is_show,callback:function(e){t.$set(t.form,"is_show",e)},expression:"form.is_show"}}),a("span",{staticStyle:{"font-size":"6px"}},[t._v(" 实时展示已中奖客户记录 ")])],1),a("div",{staticClass:"limit"},[a("div",{staticClass:"title mt30"},[t._v(" 抽奖限制设置 ")]),a("div",{staticClass:"limit-set"},[a("div",{staticClass:"sum required"},[a("span",[t._v(" 总抽奖机会： ")]),a("div",{staticClass:"sum-radio ml42"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1},model:{value:t.form.draw_set.type_total_num,callback:function(e){t.$set(t.form.draw_set,"type_total_num",e)},expression:"form.draw_set.type_total_num"}},[a("a-radio",{attrs:{value:1}},[t._v(" 不限 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===t.form.draw_set.type_total_num,expression:"form.draw_set.type_total_num === 2"}]},[t._v(" 每人最多有 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small"},model:{value:t.form.draw_set.max_total_num,callback:function(e){t.$set(t.form.draw_set,"max_total_num",e)},expression:"form.draw_set.max_total_num"}}),t._v(" 次抽奖机会 ")],1)],1)],1)]),a("div",{staticClass:"sum required"},[a("span",[t._v(" 每日抽奖机会： ")]),a("div",{staticClass:"sum-radio ml28"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1}},[a("a-radio",{attrs:{value:1}},[t._v(" 限制 ")])],1)],1),a("span",[t._v(" 每人每天最多有 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small"},model:{value:t.form.draw_set.max_every_day_num,callback:function(e){t.$set(t.form.draw_set,"max_every_day_num",e)},expression:"form.draw_set.max_every_day_num"}}),t._v(" 次抽奖机会 ")],1)])])]),a("div",{staticClass:"select-limit"},[a("div",{staticClass:"title mt30"},[t._v(" 中奖限制设置 ")]),a("div",{staticClass:"select-limit-set mt24"},[a("div",{staticClass:"select-sum required"},[a("span",[t._v(" 每人总中奖次数： ")]),a("div",{staticClass:"sum-radio ml14"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":2},model:{value:t.form.win_set.type_total_num,callback:function(e){t.$set(t.form.win_set,"type_total_num",e)},expression:"form.win_set.type_total_num"}},[a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")])],1)],1),a("span",[t._v(" 用户每人最多中奖 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small"},model:{value:t.form.win_set.max_total_num,callback:function(e){t.$set(t.form.win_set,"max_total_num",e)},expression:"form.win_set.max_total_num"}}),t._v(" 次 ")],1)]),a("div",{staticClass:"sum required"},[a("span",[t._v(" 每人每天中奖次数： ")]),a("div",{staticClass:"sum-radio"},[a("a-radio-group",{attrs:{name:"radioGroup","default-value":1},model:{value:t.form.win_set.type_every_day_num,callback:function(e){t.$set(t.form.win_set,"type_every_day_num",e)},expression:"form.win_set.type_every_day_num"}},[a("a-radio",{attrs:{value:1}},[t._v(" 不限 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 限制 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===t.form.win_set.type_every_day_num,expression:"form.win_set.type_every_day_num === 2"}]},[t._v(" 每人每天最多中奖 "),a("a-input",{staticStyle:{width:"60px"},attrs:{size:"small"},model:{value:t.form.win_set.max_every_day_num,callback:function(e){t.$set(t.form.win_set,"max_every_day_num",e)},expression:"form.win_set.max_every_day_num"}}),t._v(" 次 ")],1)],1)],1)])])]),a("div",{staticClass:"business-card"},[a("div",{staticClass:"title mt30"},[t._v(" 企业名片 ")]),a("div",{staticClass:"information"},[a("div",{staticClass:"portrait interval"},[a("div",{staticClass:"corporate-avatar"},[t._v("企业头像：")]),a("div",{staticClass:"upload-two"},[a("m-upload",{attrs:{def:!1,text:"请上传头像"},model:{value:t.form.corp_card.logo,callback:function(e){t.$set(t.form.corp_card,"logo",e)},expression:"form.corp_card.logo"}})],1)]),a("div",{staticClass:"corporate-name"},[a("span",{staticClass:"cr-name interval"},[t._v("企业名称： "),a("a-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入企业名称"},model:{value:t.form.corp_card.name,callback:function(e){t.$set(t.form.corp_card,"name",e)},expression:"form.corp_card.name"}})],1)]),a("div",{staticClass:"mb14"},[a("div",{staticClass:"profile-title"},[t._v(" 企业简介： "),a("div",{staticClass:"switch"},[a("a-switch",{attrs:{size:"small","default-checked":""},model:{value:t.tagSet,callback:function(e){t.tagSet=e},expression:"tagSet"}})],1)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tagSet,expression:"tagSet"}],staticClass:"profile"},[a("a-textarea",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入企业简介",rows:5},model:{value:t.form.corp_card.description,callback:function(e){t.$set(t.form.corp_card,"description",e)},expression:"form.corp_card.description"}})],1)])]),a("exchange",{ref:"exchange",on:{change:t.exchangeChange}})],1)},v=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[t._v(" 奖品设置 "),a("span",{staticClass:"ml10"},[t._v(" 设置的所有奖项中奖概率总和应等于100% ")])])}],h=a("5530"),y=a("b85c"),g=(a("a9e3"),a("d81d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"word-fission-details"},[a("a-modal",{attrs:{width:650,centered:""},on:{ok:t.ok},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("template",{slot:"title"},[t._v("兑换设置")]),a("div",{staticClass:"content"},[a("div",{staticClass:"mb16"},[a("span",[t._v("兑奖方式：")]),a("a-radio-group",{attrs:{name:"radioGroup","default-value":1},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("a-radio",{attrs:{value:1}},[t._v(" 客服二维码 ")]),a("a-radio",{attrs:{value:2}},[t._v(" 兑换码 ")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.type,expression:"type === 1"}],staticClass:"ml70"},[a("m-upload",{ref:"upload",attrs:{def:!1,text:"请上传二维码"},model:{value:t.qrCode,callback:function(e){t.qrCode=e},expression:"qrCode"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.type,expression:"type === 2"}],staticClass:"ml70"},[a("span",[t._v("请输入兑换码：")]),a("a-textarea",{staticClass:"mt6",attrs:{placeholder:"兑换码一行一个",rows:6},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("div",{staticClass:"mt16"},[a("span",[t._v("兑换须知：")]),a("a-textarea",{staticClass:"mt6",attrs:{placeholder:"请输入文字",rows:4},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)])],2)],1)}),b=[],w=(a("ac1f"),a("1276"),a("a630"),a("3ca3"),a("6062"),a("ddb0"),{data:function(){return{modalShow:!1,id:"",type:1,qrCode:"",code:"",description:""}},methods:{ok:function(){if(1===this.type&&!this.qrCode)return this.$message.error("请上传客服二维码"),!1;if(2===this.type&&!this.code)return this.$message.error("请填写兑换码"),!1;if(!this.description)return this.$message.error("请填写兑换须知"),!1;var t=this.code,e=JSON.parse(JSON.stringify(this.code)).split(/[(\r\n)\r\n]+/);e.forEach((function(t,a){t||e.splice(a,1)})),e=Array.from(new Set(e)),this.$emit("change",{id:this.id,type:this.type,qrCode:this.qrCode,code:e,description:this.description,exchange_code_old:t}),this.hide()},show:function(t,e){e.type&&(this.type=e.type,e.employee_qr&&this.$refs.upload.setUrl(e.employee_qr),e.description&&(this.description=e.description),e.exchange_code_old&&(this.code=e.exchange_code_old)),this.id=t,this.modalShow=!0},hide:function(){this.modalShow=!1,this.qrCode="",this.code="",this.id="",this.description="",this.type=1,this.$refs.upload.setUrl("")}}}),C=w,x=(a("2645"),Object(m["a"])(C,g,b,!1,null,"7f452ec4",null)),k=x.exports,S={data:function(){return{table:{col:[{title:"奖品名称",scopedSlots:{customRender:"name"}},{title:"奖品总数",scopedSlots:{customRender:"total"}},{title:"中奖概率",scopedSlots:{customRender:"probability"}},{title:"奖品图片",scopedSlots:{customRender:"img"}},{title:"兑奖方式",scopedSlots:{customRender:"exchange"}},{title:"操作",scopedSlots:{customRender:"operation"}}],data:[{name:"谢谢参与",num:1e7,rate:"50",image:"",id:1},{name:"奖项1",num:10,rate:"10",image:"",id:2},{name:"奖项2",num:10,rate:"10",image:"",id:3},{name:"奖项3",num:10,rate:"30",image:"",id:4}]},form:{is_show:!0,draw_set:{type_total_num:1,max_total_num:"",type_every_day_num:2,max_every_day_num:"",type_point:1,point_deplete:""},win_set:{type_total_num:2,max_total_num:"",type_every_day_num:1,max_every_day_num:""},corp_card:{logo:"",name:"",description:""}},tagSet:!1,reset:!0}},methods:{getErrMsg:function(){var t,e=Object(y["a"])(this.table.data);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(1!==a.id){if(!a.name)return"请填写奖品名称";if(!a.num)return"请填写奖品数量";if(!a.rate)return"请填写中间概率";if(!a.type)return"请填写设置奖品兑换方式"}if(Number(a.rate)>100||Number(a.rate)<0)return"中奖概率填写错误"}}catch(s){e.e(s)}finally{e.f()}return 2!==this.form.draw_set.type_total_num||this.form.draw_set.max_total_num?this.form.draw_set.max_every_day_num?this.form.win_set.max_total_num?2!==this.form.win_set.type_every_day_num||this.form.win_set.max_every_day_num?void 0:"请填写每人每天中奖次数":"请填写每人总中奖次数":"请填写每日抽奖机会":"请填写总抽奖机会"},getParams:function(){this.table.data.forEach((function(t,e){t.id=e+1}));var t=this.table.data.map((function(t){return{name:t.name,type:t.type,employee_qr:t.employee_qr,exchange_code:t.exchange_code,description:t.description}}));return t.splice(0,1),Object(h["a"])({prize_set:this.table.data,exchange_set:t},this.form)},exchangeChange:function(t){var e,a=Object(y["a"])(this.table.data);try{for(a.s();!(e=a.n()).done;){var s=e.value;if(s.id===t.id){s.type=t.type,s.employee_qr=t.qrCode,s.exchange_code=t.code,s.description=t.description,s.exchange_code_old=t.exchange_code_old,this.reset=!1,this.reset=!0;break}}}catch(i){a.e(i)}finally{a.f()}},delPrize:function(t){if(3===this.table.data.length)return this.$message.error("最少添加3个奖项"),!1;this.table.data.splice(t,1)},pushPrize:function(){if(7===this.table.data.length)return this.$message.error("最多添加7个奖项"),!1;this.table.data.push({name:"奖项".concat(this.table.data.length+1)})},delTag:function(t){if(1===this.pirzeList.length)return this.$message.error("不能删除最后一个"),!1;this.tagList.splice(t,1)}},components:{exchange:k}},$=S,T=(a("946d"),Object(m["a"])($,_,v,!1,null,"576ffa9c",null)),A=T.exports,I=a("1184"),O={data:function(){return{step:0,loading:!1}},methods:{next:function(){var t=this.$refs.step1.getErrMsg();if(t)return this.$message.error(t),!1;this.step++},addClick:function(){var t=this,e=this.$refs.step2.getErrMsg();if(e)return this.$message.error(e),!1;this.loading=!0,Object(I["a"])({lottery:this.$refs.step1.getParams(),prize:this.$refs.step2.getParams()}).then((function(e){t.$message.success("添加成功"),t.loading=!1,t.$router.push("/lottery/index")}))}},components:{step1:f,step2:A}},j=O,z=Object(m["a"])(j,s,i,!1,null,"328b9794",null);e["default"]=z.exports},da7d:function(t,e,a){},f6c5:function(t,e,a){"use strict";a("5bb1")}}]);