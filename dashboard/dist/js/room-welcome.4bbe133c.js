(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room-welcome"],{"003b":function(t,e,s){},"06c5":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("fb6a"),s("d3b7"),s("b0c0"),s("a630"),s("3ca3"),s("ac1f");var i=s("6b75");function a(t,e){if(t){if("string"===typeof t)return Object(i["a"])(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Object(i["a"])(t,e):void 0}}},"0d6d":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-applets"},[s("a-modal",{attrs:{"on-ok":"handleOk",width:637},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[s("template",{slot:"title"},[t._v(" 添加小程序 ")]),s("div",{staticClass:"form"},[s("div",{staticClass:"item"},[s("span",{staticClass:"title"},[s("span",{staticClass:"required"},[t._v("*")]),t._v(" 小程序标题： ")]),s("div",{staticClass:"input"},[s("a-input",{attrs:{placeholder:"请输入小程序标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)]),s("div",{staticClass:"item"},[s("span",{staticClass:"title"},[s("span",{staticClass:"required"},[t._v("*")]),t._v(" 小程序APPID： ")]),s("div",{staticClass:"input"},[s("a-input",{attrs:{placeholder:"请输入小程序APPID"},model:{value:t.form.appid,callback:function(e){t.$set(t.form,"appid",e)},expression:"form.appid"}}),s("div",{staticClass:"tips"},[s("a",{attrs:{href:"#"}},[t._v("如何获取小程序APPID？")])])],1)]),s("div",{staticClass:"item"},[s("span",{staticClass:"title"},[s("span",{staticClass:"required"},[t._v("*")]),t._v(" 小程序路径： ")]),s("div",{staticClass:"input"},[s("a-input",{attrs:{placeholder:"请输入小程序路径"},model:{value:t.form.path,callback:function(e){t.$set(t.form,"path",e)},expression:"form.path"}}),s("div",{staticClass:"tips"},[s("a",{attrs:{href:"#"}},[t._v("如何获取小程序路径？")])])],1)]),s("div",{staticClass:"item"},[s("span",{staticClass:"title"},[s("span",{staticClass:"required"},[t._v("*")]),t._v(" 小程序封面： ")]),s("div",{staticClass:"input"},[s("m-upload",{ref:"upload"})],1)])]),s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:t.hide}},[t._v(" 取消 ")]),s("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.addClick}},[t._v(" 添加 ")])],1)],2)],1)},a=[],n=s("5530"),o={data:function(){return{modalShow:!1,loading:!1,form:{title:"",appid:"",path:""}}},methods:{show:function(){this.modalShow=!0},hide:function(){this.modalShow=!1},addClick:function(){var t=this;return this.form.title?this.form.appid?this.form.path?this.$refs.upload.url?(this.loading=!0,void setTimeout((function(){t.loading=!1,t.hide(),t.$message.success("添加成功"),t.$emit("change",Object(n["a"])(Object(n["a"])({},t.form),{},{image:t.$refs.upload.url}))}),2e3)):(this.$message.warning("图片未上传"),!1):(this.$message.warning("路径未填写"),!1):(this.$message.warning("APPID未填写"),!1):(this.$message.warning("标题未填写"),!1)}}},l=o,r=(s("7fab"),s("2877")),c=Object(r["a"])(l,i,a,!1,null,"437d892a",null);e["a"]=c.exports},"1f90":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"room-welcome"},[i("a-alert",{attrs:{message:"因企业微信接口限制，在【企业微信后台】群欢迎语素材库进行编辑或删除操作，MoChat不会同步更新，建议在MoChat入群欢迎语处进行管理",type:"info"}}),i("div",{staticClass:"add-row"},[i("div",{staticClass:"btn"},[i("router-link",{attrs:{to:{path:"/roomWelcome/create"}}},[i("a-button",{attrs:{type:"primary"}},[t._v("新增入群欢迎语")])],1),i("span",{on:{click:t.goHelp}},[t._v("什么是入群欢迎语？")])],1),i("div",{staticClass:"search"},[i("a-input-search",{attrs:{placeholder:"请输入要搜索的欢迎语"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),i("a-card",{attrs:{title:"共"+t.count+"条素材",bordered:!1}},[i("a-table",{attrs:{columns:t.table.columns,"data-source":t.table.data},scopedSlots:t._u([{key:"operating",fn:function(e){return i("div",{staticClass:"btn-group"},[i("a",{on:{click:function(s){return t.detailsShow(e)}}},[t._v("详情")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{on:{click:function(s){return t.$router.push({path:"/roomWelcome/create?update=true&id="+e.id})}}},[t._v("修改")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{on:{click:function(s){return t.del(e)}}},[t._v("删除")])],1)}},{key:"create_user",fn:function(e){return i("div",{},[i("a-tag",[i("a-icon",{style:{color:"#7da3d1"},attrs:{type:"user","two-tone-color":"#7da3d1"}}),t._v(" "+t._s(e.create_user)+" ")],1)],1)}},{key:"msg",fn:function(e){return i("div",{},["link"===e.complex_type?i("div",[e.msg_text?i("div",[t._v(" 消息1："+t._s(e.msg_text)+" ")]):t._e(),i("div",[i("span",{staticClass:"type-text"},[t._v("[链接]")]),t._v(" 消息2："+t._s(e.msg_complex.title)+" ")])]):t._e(),"image"===e.complex_type?i("div",[e.msg_text?i("div",[t._v(" 消息1："+t._s(e.msg_text)+" ")]):t._e(),i("div",[t._v(" 消息2： "),i("img",{staticClass:"table-pic",attrs:{src:e.msg_complex.pic}})])]):t._e(),"miniprogram"===e.complex_type?i("div",[e.msg_text?i("div",[t._v(" 消息1："+t._s(e.msg_text)+" ")]):t._e(),i("div",{staticClass:"flex"},[t._v(" 消息2： "),i("div",{staticClass:"applets"},[i("div",{staticClass:"title"},[t._v(" "+t._s(e.msg_complex.title)+" ")]),i("div",{staticClass:"image"},[i("img",{attrs:{src:e.msg_complex.pic}})]),i("div",{staticClass:"applets-logo"},[i("img",{attrs:{src:s("2792")}}),t._v(" 小程序 ")])])])]):t._e(),e.complex_type?t._e():i("div",[t._v(" 消息1："+t._s(e.msg_text)+" ")])])}}])})],1),i("Details",{ref:"details"})],1)},a=[],n=s("b85c"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"details"},[i("a-modal",{attrs:{"on-ok":"handleOk",width:535,footer:!1,centered:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[i("template",{slot:"title"},[t._v(" 入群欢迎语素材详情 ")]),i("div",{staticClass:"block"},[i("div",{staticClass:"title"},[i("span",{staticClass:"bar"}),t._v(" 基本设置 ")]),i("div",{staticClass:"block-content"},[i("div",{staticClass:"item"},[i("span",[t._v("类型：")]),i("div",{staticClass:"item-content"},[t._v(" "+t._s(t.data.type)+" ")])]),i("div",{staticClass:"item"},[i("span",[t._v("创建人：")]),i("div",{staticClass:"item-content"},[i("a-tag",[i("a-icon",{style:{color:"#7da3d1"},attrs:{type:"user","two-tone-color":"#7da3d1"}}),t._v(" "+t._s(t.data.create_user)+" ")],1)],1)]),i("div",{staticClass:"item"},[i("span",[t._v("创建时间：")]),i("div",{staticClass:"item-content"},[t._v(" "+t._s(t.data.create_time)+" ")])])])]),i("div",{staticClass:"block"},[i("div",{staticClass:"title"},[i("span",{staticClass:"bar"}),t._v(" 欢迎语设置 ")]),i("div",{staticClass:"msg-content"},[t.data.msg_text?i("div",{staticClass:"msg"},[i("span",[t._v("消息1：")]),t._v(" "+t._s(t.data.msg_text)+" ")]):t._e(),t.data.complex_type?i("div",{staticClass:"msg"},[i("span",[t._v("消息2：")]),"image"===t.data.complex_type?i("img",{staticClass:"image",attrs:{src:t.data.msg_complex.pic}}):t._e(),"link"===t.data.complex_type?i("div",{staticClass:"news"},[i("p",{staticClass:"title"},[t._v(" "+t._s(t.data.msg_complex.title)+" ")]),i("div",[i("span",{staticClass:"desc"},[t._v(t._s(t.data.msg_complex.desc))]),i("img",{attrs:{src:t.data.msg_complex.pic}})])]):t._e(),"miniprogram"===t.data.complex_type?i("div",{staticClass:"applets"},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.data.msg_complex.title)+" ")]),i("div",{staticClass:"image"},[i("img",{attrs:{src:t.data.msg_complex.pic}})]),i("div",{staticClass:"applets-logo"},[i("img",{attrs:{src:s("2792")}}),t._v(" 小程序 ")])]):t._e()]):t._e()])])],2)],1)},l=[],r={data:function(){return{modalShow:!1,loading:!1,data:{}}},methods:{show:function(t){this.data=t,this.modalShow=!0},hide:function(){this.modalShow=!1}}},c=r,p=(s("85929"),s("2877")),m=Object(p["a"])(c,o,l,!1,null,"fc06825a",null),d=m.exports,u=s("7e01"),f={data:function(){return{count:"",table:{columns:[{title:"入群欢迎语",scopedSlots:{customRender:"msg"}},{title:"类型",dataIndex:"type"},{title:"创建人",scopedSlots:{customRender:"create_user"}},{title:"创建时间",dataIndex:"create_time"},{title:"操作",scopedSlots:{customRender:"operating"}}],data:[]},search:""}},watch:{search:function(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){}),500)}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;Object(u["d"])().then((function(e){var s,i={image:"图片",link:"链接",miniprogram:"小程序"},a=Object(n["a"])(e.data.list);try{for(a.s();!(s=a.n()).done;){var o=s.value;o.msg_complex&&(o.msg_complex=JSON.parse(o.msg_complex)),o.msg_text?(o.complex_type&&(o.type="文字+".concat(i[o.complex_type])),o.complex_type||(o.type="文字")):o.type=i[o.complex_type]}}catch(l){a.e(l)}finally{a.f()}t.count=e.data.page.total,t.table.data=e.data.list}))},detailsShow:function(t){this.$refs.details.show(t)},del:function(t){var e=this;this.$confirm({title:"提示?",content:"删除后不会影响已使用该入群欢迎语的群聊，确认删除该入群欢迎语吗？",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){Object(u["b"])({id:t.id}).then((function(t){200===t.code&&(e.$message.success("删除成功"),e.getData())}))}})},goHelp:function(){window.open("/")}},components:{Details:d}},v=f,h=(s("500c"),Object(p["a"])(v,i,a,!1,null,"61d8ee7c",null));e["default"]=h.exports},"394c":function(t,e,s){"use strict";s("fc8a")},"500c":function(t,e,s){"use strict";s("003b")},6479:function(t,e,s){},"6b75":function(t,e,s){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}s.d(e,"a",(function(){return i}))},"777d":function(t,e,s){},"7e01":function(t,e,s){"use strict";s.d(e,"d",(function(){return a})),s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return o})),s.d(e,"e",(function(){return l})),s.d(e,"a",(function(){return r}));var i=s("b775");function a(t){return Object(i["b"])({url:"/roomWelcome/index",method:"GET",data:t})}function n(t){return Object(i["b"])({url:"/roomWelcome/destroy",method:"DELETE",data:t})}function o(t){return Object(i["b"])({url:"/roomWelcome/show",method:"GET",params:t})}function l(t){return Object(i["b"])({url:"/roomWelcome/update",method:"PUT",data:t})}function r(t){return Object(i["b"])({url:"/roomWelcome/store",method:"POST",data:t})}},"7fab":function(t,e,s){"use strict";s("6479")},85929:function(t,e,s){"use strict";s("777d")},"9feb":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"room-welcome-create"},[s("a-card",{attrs:{title:"设置入群欢迎语"}},[s("div",{staticClass:"content-wrap"},[s("div",{staticClass:"content-box"},[s("div",{staticClass:"form"},[s("a-alert",{attrs:{message:"因企业微信限制，入群欢迎语创建上限为100条，在企业微信后台创建的也将计入其中",type:"warning","show-icon":""}}),s("div",{staticClass:"input-msg"},[s("div",{staticClass:"title"},[t._v(" 欢迎语1： ")]),s("div",{staticClass:"content"},[s("div",{staticClass:"input"},[s("div",{staticClass:"insert-btn-group"},[s("span",{on:{click:function(e){return t.$refs.enterText.addUserName("[用户昵称]")}}},[t._v("[插入客户名称]")])]),s("m-enter-text",{ref:"enterText",model:{value:t.form.text,callback:function(e){t.$set(t.form,"text",e)},expression:"form.text"}})],1)])]),s("div",{staticClass:"input-msg input-type"},[s("div",{staticClass:"title"},[t._v(" 欢迎语2： ")]),s("div",{staticClass:"content"},[s("div",{staticClass:"select-type"},[t._v(" 选择消息类型： "),s("a-radio-group",{attrs:{options:t.typeRadio},on:{change:t.switchRadio},model:{value:t.form.type.select,callback:function(e){t.$set(t.form.type,"select",e)},expression:"form.type.select"}})],1),s("div",{staticClass:"operating"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"image"===t.form.type.select,expression:"form.type.select === 'image'"}],staticClass:"image"},[s("m-upload",{ref:"uploadImg",attrs:{def:!1,text:"请上传图片"},on:{change:t.uploadImageChange}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"link"===t.form.type.select,expression:"form.type.select === 'link'"}],staticClass:"link"},[s("div",{staticClass:"url"},[s("a-input",{attrs:{placeholder:"链接地址请以http 或https开头"},model:{value:t.form.type.link.input.url,callback:function(e){t.$set(t.form.type.link.input,"url",e)},expression:"form.type.link.input.url"}})],1),s("div",{staticClass:"customize"},[s("div",{staticClass:"link-form"},[s("div",{staticClass:"item"},[s("span",[t._v("链接标题：")]),s("div",{staticClass:"input"},[s("a-input",{model:{value:t.form.type.link.input.title,callback:function(e){t.$set(t.form.type.link.input,"title",e)},expression:"form.type.link.input.title"}})],1)]),s("div",{staticClass:"item"},[s("span",[t._v("链接摘要：")]),s("div",{staticClass:"input"},[s("a-input",{model:{value:t.form.type.link.input.desc,callback:function(e){t.$set(t.form.type.link.input,"desc",e)},expression:"form.type.link.input.desc"}})],1)]),s("div",{staticClass:"item"},[s("span",[t._v("链接封面：")]),s("div",{staticClass:"input"},[s("m-upload",{ref:"linkOverImg",attrs:{def:!1,text:"请上传图片"},on:{change:t.uploadLinkImageChange}})],1)])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"miniprogram"===t.form.type.select,expression:"form.type.select === 'miniprogram'"}],staticClass:"applets"},[s("a-alert",{attrs:{type:"info","show-icon":""}},[s("span",{attrs:{slot:"message"},slot:"message"},[t._v(" 只有在企业微信后台绑定的小程序才可在此添加哦 查看如何绑定 ")])]),t.form.type.applets.appid?s("div",[t._v(" 小程序："+t._s(t.form.type.applets.title)+" "),s("a-button",{on:{click:t.resetApplets}},[t._v("重新添加")])],1):s("a-button",{on:{click:function(e){return t.$refs.addApplets.show()}}},[t._v("添加小程序")])],1)])])]),s("div",{staticClass:"input-msg"},[s("div",{staticClass:"title"},[t._v(" 消息提醒： ")]),s("div",{staticClass:"tips-content"},[s("a-switch",{attrs:{size:"small"},on:{change:t.linkCustomizeSwitchChange}}),s("span",[t._v(" 开启后，新建该条欢迎语会通过「客户群」群发通知企业全部员工：“管理员创建了新的入群欢迎语” ")])],1)]),s("div",{staticClass:"add"},[s("a-button",{attrs:{type:"primary",size:"large"},on:{click:t.addClick}},[t._v(t._s(t.update.flag?"修改":"添加"))])],1)],1),s("div",{staticClass:"phone"},[s("m-preview",{ref:"preview"})],1)])])]),s("AddApplets",{ref:"addApplets",on:{change:t.addAppletsChange}})],1)},a=[],n=(s("ac1f"),s("9911"),s("0d6d")),o=s("7e01"),l={data:function(){return{form:{text:"",type:{select:"image",image:"",link:{customizeFlag:!0,input:{url:"",title:"",desc:"",image:""}},applets:{title:"",appid:"",path:"",image:""}}},typeRadio:[{label:"图片",value:"image"},{label:"链接",value:"link"},{label:"小程序",value:"miniprogram"}],update:{flag:!1,id:""}}},watch:{"form.text":function(){this.$refs.preview.setText(this.form.text),this.form.text.length>1500&&(this.$message.warning("最多输入1500个字"),this.form.text=this.form.text.substring(0,1500))},"form.type.link.input.url":function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){var e=/^(((ht|f)tps?):\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/,s=e.test(t.form.type.link.input.url);if(!s)return t.$message.error("输入的不是一个链接"),!1}),500)},"form.type.link.input":{deep:!0,handler:function(){var t=this,e=this.form.type.link.input;this.$nextTick((function(){t.$refs.preview.setLink(e.title,e.desc,e.image)}))}}},created:function(){var t=this;"true"===this.$route.query.update&&(this.update.flag=!0,this.update.id=this.$route.query.id,Object(o["c"])({id:this.update.id}).then((function(e){var s=e.data;if(s.msgComplex=JSON.parse(s.msgComplex),t.$nextTick((function(){t.$refs.enterText.addUserName(s.msgText)})),s.complexType)if(t.form.type.select=s.complexType,"image"==s.complexType)s.msgComplex.pic_url&&t.$nextTick((function(){t.$refs.uploadImg.setUrl(s.msgComplex.pic)}));else if("link"==s.complexType){var i={title:s.msgComplex.title,desc:s.msgComplex.desc,url:s.msgComplex.url};t.form.type.link.input=i,t.$nextTick((function(){t.$refs.linkOverImg.setUrl(s.msgComplex.pic)}))}else if("miniprogram"==s.complexType){var a={title:s.msgComplex.title,appid:s.msgComplex.appid,path:s.msgComplex.page,image:s.msgComplex.pic};t.$nextTick((function(){t.$refs.preview.setApplets(a.title,a.image)})),t.form.type.applets=a}})))},methods:{switchRadio:function(){if("image"==this.form.type.select)this.$refs.preview.setImage(this.form.type.image),this.$refs.preview.setLink(),this.$refs.preview.setApplets();else if("link"==this.form.type.select){this.$refs.preview.setImage();var t=this.form.type.link.input;this.$refs.preview.setLink(t.title,t.desc,t.image),this.$refs.preview.setApplets()}else if("miniprogram"==this.form.type.select){this.$refs.preview.setImage(),this.$refs.preview.setLink();var e=this.form.type.applets;this.$refs.preview.setApplets(e.title,e.image)}},addClick:function(){var t=this,e=this.form,s=this.$message.loading(this.update.flag?"修改中":"添加中",1.5),i={msg_text:e.text,msg_complex:{type:e.type.select,image:{pic:e.type.image},link:{title:e.type.link.input.title,pic:e.type.link.input.image,desc:e.type.link.input.desc,url:e.type.link.input.url},miniprogram:{title:e.type.applets.title,pic:e.type.applets.image,appid:e.type.applets.appid,page:e.type.applets.path}},notice:this.form.type.link.customizeFlag};if(this.update.flag)return i.id=this.update.id,Object(o["e"])(i).then((function(e){200===e.code&&s.then((function(){t.$message.success("修改成功",2.5)})).then((function(){t.$router.push("/roomWelcome/index")}))})),!1;Object(o["a"])(i).then((function(e){200===e.code&&s.then((function(){t.$message.success("添加成功",2.5)})).then((function(){t.$router.push("/roomWelcome/index")}))}))},addAppletsChange:function(t){this.form.type.applets=t,this.$refs.preview.setApplets(t.title,t.image)},resetApplets:function(){this.form.type.applets.title="",this.form.type.applets.appid="",this.form.type.applets.path="",this.form.type.applets.image=""},linkCustomizeSwitchChange:function(t){this.form.type.link.customizeFlag=t},uploadLinkImageChange:function(t){this.form.type.link.input.image=t;var e=this.form.type.link.input;this.$refs.preview.setLink(e.title,e.desc,e.image)},uploadImageChange:function(t){this.form.type.image=t,this.$refs.preview.setImage(t)}},components:{AddApplets:n["a"]}},r=l,c=(s("394c"),s("2877")),p=Object(c["a"])(r,i,a,!1,null,"010b0ed6",null);e["default"]=p.exports},b85c:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0");var i=s("06c5");function a(t,e){var s="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=Object(i["a"])(t))||e&&t&&"number"===typeof t.length){s&&(t=s);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,r=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return l=t.done,t},e:function(t){r=!0,o=t},f:function(){try{l||null==s["return"]||s["return"]()}finally{if(r)throw o}}}}},fc8a:function(t,e,s){}}]);